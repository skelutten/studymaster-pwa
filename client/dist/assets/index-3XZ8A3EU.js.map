{"version":3,"file":"index-3XZ8A3EU.js","sources":["../../src/components/layout/Navbar.tsx","../../src/components/layout/Sidebar.tsx","../../src/components/layout/AuthModal.tsx","../../src/components/layout/Layout.tsx","../../src/pages/HomePage.tsx","../../src/components/SvgMapCard.tsx","../../src/components/study/CardRenderer.tsx","../../src/hooks/useKeyboardShortcuts.ts","../../src/components/study/KeyboardShortcutsHelp.tsx","../../src/components/study/CardStateIndicator.tsx","../../src/utils/cardStateUtils.ts","../../src/utils/testStatsLogic.ts","../../src/pages/StudyPage.tsx","../../src/components/deck/CardManager.tsx","../../src/components/ui/ProgressBar.tsx","../../src/utils/svgMapGenerator.ts","../../src/pages/DecksPage.tsx","../../src/components/ui/ConfirmationDialog.tsx","../../src/pages/ProfilePage.tsx","../../src/pages/ChallengesPage.tsx","../../src/pages/LeaderboardPage.tsx","../../src/pages/GlobalStatsPage.tsx","../../src/pages/AnalyticsDashboard.tsx","../../src/pages/EnhancedReviewPage.tsx","../../src/pages/ResetPasswordPage.tsx","../../src/App.tsx","../../src/main.tsx"],"sourcesContent":["import { useThemeStore } from '../../stores/themeStore'\r\nimport { useAuthStore } from '../../stores/authStore'\r\n\r\ninterface NavbarProps {\r\n  onMenuClick: () => void\r\n}\r\n\r\nconst Navbar = ({ onMenuClick }: NavbarProps) => {\r\n  const { theme, toggleTheme } = useThemeStore()\r\n  const { user, logout } = useAuthStore()\r\n\r\n  return (\r\n    <nav className=\"bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700\">\r\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\r\n        <div className=\"flex justify-between h-16\">\r\n          <div className=\"flex items-center\">\r\n            {/* Mobile menu button */}\r\n            <button\r\n              onClick={onMenuClick}\r\n              className=\"lg:hidden p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500\"\r\n            >\r\n              <svg className=\"h-6 w-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 6h16M4 12h16M4 18h16\" />\r\n              </svg>\r\n            </button>\r\n            \r\n            {/* Logo */}\r\n            <div className=\"flex-shrink-0 flex items-center ml-4 lg:ml-0\">\r\n              <h1 className=\"text-xl font-bold text-gradient\">StudyMaster</h1>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"flex items-center space-x-4\">\r\n            {/* Theme toggle */}\r\n            <button\r\n              onClick={toggleTheme}\r\n              className=\"p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500\"\r\n            >\r\n              {theme === 'dark' ? (\r\n                <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z\" />\r\n                </svg>\r\n              ) : (\r\n                <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z\" />\r\n                </svg>\r\n              )}\r\n            </button>\r\n\r\n            {/* User menu */}\r\n            <div className=\"relative\">\r\n              <div className=\"flex items-center space-x-3\">\r\n                <div className=\"text-sm\">\r\n                  <div className=\"font-medium text-gray-700 dark:text-gray-200\">\r\n                    {user?.username}\r\n                  </div>\r\n                  <div className=\"text-gray-500 dark:text-gray-400\">\r\n                    Level {user?.level}\r\n                  </div>\r\n                </div>\r\n                <button\r\n                  onClick={logout}\r\n                  className=\"p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500\"\r\n                  title=\"Logout\"\r\n                >\r\n                  <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1\" />\r\n                  </svg>\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </nav>\r\n  )\r\n}\r\n\r\nexport default Navbar","import { NavLink } from 'react-router-dom'\r\nimport { useGamificationStore } from '../../stores/gamificationStore'\r\n\r\ninterface SidebarProps {\r\n  isOpen: boolean\r\n  onClose: () => void\r\n}\r\n\r\nconst Sidebar = ({ isOpen, onClose }: SidebarProps) => {\r\n  const { userStats } = useGamificationStore()\r\n  \r\n  const navigation = [\r\n    { name: 'Home', href: '/', icon: '🏠' },\r\n    { name: 'Study', href: '/study', icon: '📚' },\r\n    { name: 'Decks', href: '/decks', icon: '📋' },\r\n    { name: 'Global Stats', href: '/global-stats', icon: '🌍' },\r\n    { name: 'Profile', href: '/profile', icon: '👤' },\r\n    { name: 'Leaderboard', href: '/leaderboard', icon: '🏆' },\r\n    { name: 'Challenges', href: '/challenges', icon: '🎯' },\r\n  ]\r\n\r\n  // Format numbers for display\r\n  const formatNumber = (num: number): string => {\r\n    if (num >= 1000000) return `${(num / 1000000).toFixed(1)}M`\r\n    if (num >= 1000) return `${(num / 1000).toFixed(1)}K`\r\n    return num.toString()\r\n  }\r\n\r\n  // Calculate level progress\r\n  const xpForCurrentLevel = userStats.level * 1000\r\n  const xpForNextLevel = (userStats.level + 1) * 1000\r\n  const progressPercentage = ((userStats.xp - xpForCurrentLevel) / (xpForNextLevel - xpForCurrentLevel)) * 100\r\n\r\n  return (\r\n    <div className={`fixed inset-y-0 left-0 z-50 w-64 bg-white dark:bg-gray-800 shadow-lg transform ${\r\n      isOpen ? 'translate-x-0' : '-translate-x-full'\r\n    } transition-transform duration-300 ease-in-out lg:translate-x-0`}>\r\n      <div className=\"flex items-center justify-between h-16 px-4 border-b border-gray-200 dark:border-gray-700\">\r\n        <h1 className=\"text-xl font-bold text-gradient\">StudyMaster</h1>\r\n        <button\r\n          onClick={onClose}\r\n          className=\"lg:hidden p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700\"\r\n        >\r\n          <svg className=\"h-6 w-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n          </svg>\r\n        </button>\r\n      </div>\r\n\r\n      <div className=\"flex flex-col h-full\">\r\n        <nav className=\"flex-1 mt-8 overflow-y-auto\">\r\n          <div className=\"px-4 space-y-2\">\r\n            {navigation.map((item) => (\r\n              <NavLink\r\n                key={item.name}\r\n                to={item.href}\r\n                onClick={onClose}\r\n                className={({ isActive }) =>\r\n                  `flex items-center px-4 py-2 text-sm font-medium rounded-md transition-colors duration-200 ${\r\n                    isActive\r\n                      ? 'bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-200'\r\n                      : 'text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-white'\r\n                  }`\r\n                }\r\n              >\r\n                <span className=\"mr-3 text-lg\">{item.icon}</span>\r\n                {item.name}\r\n              </NavLink>\r\n            ))}\r\n          </div>\r\n        </nav>\r\n\r\n        {/* Quick Stats */}\r\n        <div className=\"flex-shrink-0 p-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-750\">\r\n          <div className=\"space-y-3\">\r\n            <div className=\"flex justify-between items-center text-sm\">\r\n              <span className=\"text-gray-500 dark:text-gray-400\">XP</span>\r\n              <span className=\"font-medium text-gray-900 dark:text-white\">\r\n                {formatNumber(userStats.xp)}\r\n              </span>\r\n            </div>\r\n            <div className=\"flex justify-between items-center text-sm\">\r\n              <span className=\"text-gray-500 dark:text-gray-400\">Streak</span>\r\n              <span className=\"font-medium text-gray-900 dark:text-white\">\r\n                {userStats.currentStreak} {userStats.currentStreak === 1 ? 'day' : 'days'}\r\n              </span>\r\n            </div>\r\n            <div className=\"w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2\">\r\n              <div\r\n                className=\"bg-gradient-to-r from-blue-500 to-purple-600 h-2 rounded-full transition-all duration-300\"\r\n                style={{ width: `${Math.min(100, Math.max(0, progressPercentage))}%` }}\r\n              ></div>\r\n            </div>\r\n            <div className=\"text-xs text-gray-500 dark:text-gray-400 text-center\">\r\n              Level {userStats.level} → Level {userStats.level + 1}\r\n            </div>\r\n            <div className=\"text-xs text-gray-400 dark:text-gray-500 text-center\">\r\n              {formatNumber(userStats.xp - xpForCurrentLevel)} / {formatNumber(xpForNextLevel - xpForCurrentLevel)} XP\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Sidebar","import { useState, useEffect } from 'react'\r\nimport { useAuthStore } from '../../stores/authStore'\r\n\r\ninterface AuthModalProps {\r\n  isOpen: boolean\r\n  onClose: () => void\r\n  mode: 'login' | 'register' | 'forgot-password'\r\n  onModeChange: (mode: 'login' | 'register' | 'forgot-password') => void\r\n}\r\n\r\nconst AuthModal = ({ isOpen, onClose, mode, onModeChange }: AuthModalProps) => {\r\n  const [email, setEmail] = useState('')\r\n  const [username, setUsername] = useState('')\r\n  const [password, setPassword] = useState('')\r\n  const { login, register, isLoading, error, clearError, isAuthenticated } = useAuthStore()\r\n  const [resetEmailSent, setResetEmailSent] = useState(false)\r\n\r\n  // Clear errors when modal opens or mode changes\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      clearError()\r\n    }\r\n  }, [isOpen, clearError])\r\n\r\n  useEffect(() => {\r\n    clearError()\r\n  }, [mode, clearError])\r\n\r\n  const handleModeChange = (newMode: 'login' | 'register' | 'forgot-password') => {\r\n    clearError()\r\n    setResetEmailSent(false)\r\n    onModeChange(newMode)\r\n  }\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault()\r\n    \r\n    if (mode === 'login') {\r\n      await login(email, password)\r\n    } else if (mode === 'register') {\r\n      await register(email, username, password)\r\n    } else if (mode === 'forgot-password') {\r\n      // For now, show a message that password reset is not implemented\r\n      alert('Password reset functionality will be implemented soon. Please use demo login or register a new account.')\r\n      setResetEmailSent(true)\r\n    }\r\n  }\r\n\r\n  // Close modal when successfully authenticated\r\n  useEffect(() => {\r\n    console.log('[AUTH_MODAL]', 'Auth state changed:', {\r\n      isAuthenticated,\r\n      isOpen,\r\n      timestamp: new Date().toISOString()\r\n    })\r\n    \r\n    if (isAuthenticated && isOpen) {\r\n      console.log('[AUTH_MODAL]', 'Closing modal due to successful authentication')\r\n      onClose()\r\n      // Reset form\r\n      setEmail('')\r\n      setUsername('')\r\n      setPassword('')\r\n    }\r\n  }, [isAuthenticated, isOpen, onClose])\r\n\r\n  const handleDemoLogin = async () => {\r\n    try {\r\n      // Use demo credentials that trigger the bypass logic\r\n      await signIn('demo', '')\r\n      onClose()\r\n    } catch (error) {\r\n      // Error is handled by the store\r\n    }\r\n  }\r\n\r\n  if (!isOpen) return null\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-50 overflow-y-auto\">\r\n      <div className=\"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0\">\r\n        <div className=\"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity\" onClick={onClose}></div>\r\n\r\n        <div className=\"inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full\">\r\n          <div className=\"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4\">\r\n            <div className=\"text-center\">\r\n              <h3 className=\"text-lg leading-6 font-medium text-gray-900 dark:text-white mb-4\">\r\n                {mode === 'login' ? 'Sign In' : mode === 'register' ? 'Create Account' : 'Reset Password'}\r\n              </h3>\r\n              \r\n              {error && (\r\n                <div className=\"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded\">\r\n                  {error}\r\n                </div>\r\n              )}\r\n\r\n              {resetEmailSent && mode === 'forgot-password' && (\r\n                <div className=\"mb-4 p-3 bg-green-100 border border-green-400 text-green-700 rounded\">\r\n                  Password reset email sent! Check your inbox and follow the instructions to reset your password.\r\n                </div>\r\n              )}\r\n\r\n              <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n                <div>\r\n                  <input\r\n                    type=\"email\"\r\n                    placeholder=\"Email\"\r\n                    value={email}\r\n                    onChange={(e) => setEmail(e.target.value)}\r\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\r\n                    required\r\n                  />\r\n                </div>\r\n                \r\n                {mode === 'register' && (\r\n                  <div>\r\n                    <input\r\n                      type=\"text\"\r\n                      placeholder=\"Username\"\r\n                      value={username}\r\n                      onChange={(e) => setUsername(e.target.value)}\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\r\n                      required\r\n                    />\r\n                  </div>\r\n                )}\r\n                \r\n                {mode !== 'forgot-password' && (\r\n                  <div>\r\n                    <input\r\n                      type=\"password\"\r\n                      placeholder=\"Password\"\r\n                      value={password}\r\n                      onChange={(e) => setPassword(e.target.value)}\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\r\n                      required\r\n                    />\r\n                  </div>\r\n                )}\r\n\r\n                <button\r\n                  type=\"submit\"\r\n                  disabled={isLoading}\r\n                  className=\"w-full btn btn-primary\"\r\n                >\r\n                  {isLoading ? 'Loading...' : \r\n                   mode === 'login' ? 'Sign In' : \r\n                   mode === 'register' ? 'Create Account' : \r\n                   'Send Reset Email'}\r\n                </button>\r\n              </form>\r\n\r\n              <div className=\"mt-4\">\r\n                <button\r\n                  onClick={handleDemoLogin}\r\n                  className=\"w-full btn btn-secondary\"\r\n                  disabled={isLoading}\r\n                >\r\n                  Demo Login\r\n                </button>\r\n              </div>\r\n\r\n              <div className=\"mt-4 text-sm space-y-2\">\r\n                {mode === 'login' ? (\r\n                  <>\r\n                    <div>\r\n                      Don't have an account?{' '}\r\n                      <button\r\n                        onClick={() => handleModeChange('register')}\r\n                        className=\"text-blue-600 hover:text-blue-500\"\r\n                      >\r\n                        Create one\r\n                      </button>\r\n                    </div>\r\n                    <div>\r\n                      Forgot your password?{' '}\r\n                      <button\r\n                        onClick={() => handleModeChange('forgot-password')}\r\n                        className=\"text-blue-600 hover:text-blue-500\"\r\n                      >\r\n                        Reset it\r\n                      </button>\r\n                    </div>\r\n                  </>\r\n                ) : mode === 'register' ? (\r\n                  <div>\r\n                    Already have an account?{' '}\r\n                    <button\r\n                      onClick={() => handleModeChange('login')}\r\n                      className=\"text-blue-600 hover:text-blue-500\"\r\n                    >\r\n                      Sign in\r\n                    </button>\r\n                  </div>\r\n                ) : (\r\n                  <div>\r\n                    Remember your password?{' '}\r\n                    <button\r\n                      onClick={() => handleModeChange('login')}\r\n                      className=\"text-blue-600 hover:text-blue-500\"\r\n                    >\r\n                      Back to login\r\n                    </button>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default AuthModal","import { Outlet } from 'react-router-dom'\r\nimport { useState } from 'react'\r\nimport Navbar from './Navbar'\r\nimport Sidebar from './Sidebar'\r\nimport { useAuthStore } from '../../stores/authStore'\r\nimport AuthModal from './AuthModal'\r\n\r\nconst Layout = () => {\r\n  const [sidebarOpen, setSidebarOpen] = useState(false)\r\n  const [authModalOpen, setAuthModalOpen] = useState(false)\r\n  const [authMode, setAuthMode] = useState<'login' | 'register' | 'forgot-password'>('login')\r\n  const { isAuthenticated, user } = useAuthStore()\r\n  \r\n  // Debug authentication state\r\n  console.log('[LAYOUT]', 'Layout render - Auth state:', {\r\n    isAuthenticated,\r\n    hasUser: !!user,\r\n    userId: user?.id,\r\n    timestamp: new Date().toISOString()\r\n  })\r\n\r\n  const handleSignIn = () => {\r\n    setAuthMode('login')\r\n    setAuthModalOpen(true)\r\n  }\r\n\r\n  const handleCreateAccount = () => {\r\n    setAuthMode('register')\r\n    setAuthModalOpen(true)\r\n  }\r\n\r\n  if (!isAuthenticated) {\r\n    return (\r\n      <>\r\n        <div className=\"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900\">\r\n          <div className=\"max-w-md w-full space-y-8 p-8\">\r\n            <div className=\"text-center\">\r\n              <h1 className=\"text-4xl font-bold text-gradient mb-4\">StudyMaster</h1>\r\n              <p className=\"text-gray-600 dark:text-gray-400 mb-8\">\r\n                Master your learning with spaced repetition and gamification\r\n              </p>\r\n              <div className=\"space-y-4\">\r\n                <button\r\n                  onClick={handleSignIn}\r\n                  className=\"btn btn-primary btn-lg w-full\"\r\n                >\r\n                  Sign In\r\n                </button>\r\n                <button\r\n                  onClick={handleCreateAccount}\r\n                  className=\"btn btn-secondary btn-lg w-full\"\r\n                >\r\n                  Create Account\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <AuthModal\r\n          isOpen={authModalOpen}\r\n          onClose={() => setAuthModalOpen(false)}\r\n          mode={authMode}\r\n          onModeChange={setAuthMode}\r\n        />\r\n      </>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900\">\r\n      {/* Mobile sidebar backdrop */}\r\n      {sidebarOpen && (\r\n        <div \r\n          className=\"fixed inset-0 z-40 bg-black bg-opacity-50 lg:hidden\"\r\n          onClick={() => setSidebarOpen(false)}\r\n        />\r\n      )}\r\n\r\n      {/* Sidebar */}\r\n      <Sidebar \r\n        isOpen={sidebarOpen} \r\n        onClose={() => setSidebarOpen(false)} \r\n      />\r\n\r\n      {/* Main content */}\r\n      <div className=\"lg:pl-64\">\r\n        {/* Top navbar */}\r\n        <Navbar onMenuClick={() => setSidebarOpen(true)} />\r\n        \r\n        {/* Page content */}\r\n        <main className=\"py-6\">\r\n          <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\r\n            <Outlet />\r\n          </div>\r\n        </main>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Layout","import { Link, useNavigate } from 'react-router-dom'\r\nimport { useDeckStore } from '../stores/deckStore'\r\nimport { useGamificationStore } from '../stores/gamificationStore'\r\nimport { useAuthStore } from '../stores/authStore'\r\n\r\nconst HomePage = () => {\r\n  const navigate = useNavigate()\r\n  const { decks, getCards } = useDeckStore()\r\n  const { userStats, userAchievements, achievements } = useGamificationStore()\r\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n  const { user } = useAuthStore()\r\n\r\n  // Get due cards for today (capped per-deck to avoid overwhelming counts)\r\n  const getDueDecks = () => {\r\n    const DAILY_STUDY_LIMIT_PER_DECK = 20 // default cap; can be made configurable later\r\n    return decks\r\n      .map(deck => {\r\n        const deckCards = getCards(deck.id)\r\n        const dueCards = deckCards.filter(card => {\r\n          if (card.reviewCount === 0) return true // New cards\r\n          return new Date(card.nextReview) <= new Date() // Due cards\r\n        })\r\n        const dueCountRaw = dueCards.length\r\n        const dueCount = Math.min(dueCountRaw, DAILY_STUDY_LIMIT_PER_DECK)\r\n        return { ...deck, dueCount, dueCountRaw }\r\n      })\r\n      .filter(deck => deck.dueCount > 0)\r\n  }\r\n\r\n  // Get recent achievements\r\n  const getRecentAchievements = () => {\r\n    return userAchievements\r\n      .map(ua => {\r\n        const achievement = achievements.find(a => a.id === ua.achievementId)\r\n        return achievement ? { ...achievement, earnedAt: ua.earnedAt } : null\r\n      })\r\n      .filter(Boolean)\r\n      .sort((a, b) => new Date(b!.earnedAt).getTime() - new Date(a!.earnedAt).getTime())\r\n      .slice(0, 3)\r\n  }\r\n\r\n  const formatNumber = (num: number): string => {\r\n    if (num >= 1000000) return `${(num / 1000000).toFixed(1)}M`\r\n    if (num >= 1000) return `${(num / 1000).toFixed(1)}K`\r\n    return num.toString()\r\n  }\r\n\r\n  const dueDecks = getDueDecks()\r\n  const recentAchievements = getRecentAchievements()\r\n\r\n  return (\r\n    <div className=\"space-y-8\">\r\n      {/* Welcome Header */}\r\n      <div className=\"text-center\">\r\n        <h1 className=\"text-4xl font-bold text-gradient mb-4\">\r\n          Welcome to StudyMaster\r\n        </h1>\r\n        <p className=\"text-xl text-gray-600 dark:text-gray-400 mb-4\">\r\n          Master your learning with spaced repetition and gamification\r\n        </p>\r\n        \r\n        {/* Live Status Indicator */}\r\n        <div className=\"flex items-center justify-center gap-2 text-sm text-gray-500 dark:text-gray-400\">\r\n          <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\"></div>\r\n          <span>Live data • Real-time insights</span>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Personal Stats */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\r\n        <div className=\"card p-6 text-center\">\r\n          <div className=\"text-3xl font-bold text-primary-600 mb-2\">{formatNumber(userStats.xp)}</div>\r\n          <div className=\"text-sm text-gray-600 dark:text-gray-400\">Total XP</div>\r\n        </div>\r\n        <div className=\"card p-6 text-center\">\r\n          <div className=\"text-3xl font-bold text-success-600 mb-2\">{userStats.currentStreak}</div>\r\n          <div className=\"text-sm text-gray-600 dark:text-gray-400\">Day Streak</div>\r\n        </div>\r\n        <div className=\"card p-6 text-center\">\r\n          <div className=\"text-3xl font-bold text-warning-600 mb-2\">{userStats.gold}</div>\r\n          <div className=\"text-sm text-gray-600 dark:text-gray-400\">Coins</div>\r\n        </div>\r\n        <div className=\"card p-6 text-center\">\r\n          <div className=\"text-3xl font-bold text-purple-600 mb-2\">{userStats.level}</div>\r\n          <div className=\"text-sm text-gray-600 dark:text-gray-400\">Level</div>\r\n        </div>\r\n      </div>\r\n\r\n\r\n      {/* Study Today */}\r\n      <div className=\"card p-6\">\r\n        <h2 className=\"text-2xl font-bold mb-4\">📚 Study Today</h2>\r\n        {dueDecks.length > 0 ? (\r\n          <div className=\"space-y-4\">\r\n            {dueDecks.slice(0, 3).map(deck => (\r\n              <div key={deck.id} className=\"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg\">\r\n                <div>\r\n                  <h3 className=\"font-semibold\">{deck.title}</h3>\r\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400\">{deck.dueCount} cards due</p>\r\n                </div>\r\n                <button\r\n                  onClick={() => navigate(`/study/${deck.id}`)}\r\n                  className=\"btn btn-primary btn-sm\"\r\n                >\r\n                  Study Now\r\n                </button>\r\n              </div>\r\n            ))}\r\n            {dueDecks.length > 3 && (\r\n              <div className=\"text-center\">\r\n                <button\r\n                  onClick={() => navigate('/decks')}\r\n                  className=\"btn btn-secondary btn-sm\"\r\n                >\r\n                  View All Decks ({dueDecks.length - 3} more)\r\n                </button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        ) : (\r\n          <div className=\"text-center py-8\">\r\n            <div className=\"text-6xl mb-4\">🎉</div>\r\n            <h3 className=\"text-xl font-semibold mb-2\">All caught up!</h3>\r\n            <p className=\"text-gray-600 dark:text-gray-400 mb-4\">\r\n              No cards are due for review right now. Great job!\r\n            </p>\r\n            <button\r\n              onClick={() => navigate('/decks')}\r\n              className=\"btn btn-primary\"\r\n            >\r\n              Browse Your Decks\r\n            </button>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n\r\n      {/* Recent Achievements */}\r\n      {recentAchievements.length > 0 && (\r\n        <div className=\"card p-6\">\r\n          <h2 className=\"text-2xl font-bold mb-4\">🏆 Recent Achievements</h2>\r\n          <div className=\"space-y-3\">\r\n            {recentAchievements.map(achievement => (\r\n              <div key={achievement!.id} className=\"flex items-center space-x-3\">\r\n                <div className=\"w-10 h-10 bg-success-100 dark:bg-success-900 rounded-full flex items-center justify-center\">\r\n                  {achievement!.icon}\r\n                </div>\r\n                <div>\r\n                  <h3 className=\"font-semibold\">{achievement!.name}</h3>\r\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400\">{achievement!.description}</p>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Quick Actions */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n        <Link to=\"/decks\" className=\"card p-6 text-center hover:shadow-lg transition-shadow\">\r\n          <div className=\"text-4xl mb-2\">📚</div>\r\n          <h3 className=\"font-semibold\">My Decks</h3>\r\n          <p className=\"text-sm text-gray-600 dark:text-gray-400\">Manage your study materials</p>\r\n        </Link>\r\n        \r\n        <Link to=\"/global-stats\" className=\"card p-6 text-center hover:shadow-lg transition-shadow bg-gradient-to-br from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 border-blue-200 dark:border-blue-800\">\r\n          <div className=\"text-4xl mb-2\">🌍</div>\r\n          <h3 className=\"font-semibold\">Global Stats</h3>\r\n          <p className=\"text-sm text-gray-600 dark:text-gray-400\">Real-time learning insights</p>\r\n        </Link>\r\n        \r\n        <Link to=\"/challenges\" className=\"card p-6 text-center hover:shadow-lg transition-shadow\">\r\n          <div className=\"text-4xl mb-2\">🎯</div>\r\n          <h3 className=\"font-semibold\">Challenges</h3>\r\n          <p className=\"text-sm text-gray-600 dark:text-gray-400\">Join learning challenges</p>\r\n        </Link>\r\n        \r\n        <Link to=\"/leaderboard\" className=\"card p-6 text-center hover:shadow-lg transition-shadow\">\r\n          <div className=\"text-4xl mb-2\">🏆</div>\r\n          <h3 className=\"font-semibold\">Leaderboard</h3>\r\n          <p className=\"text-sm text-gray-600 dark:text-gray-400\">See how you rank</p>\r\n        </Link>\r\n      </div>\r\n\r\n      {/* Educational Insights Footer */}\r\n      <div className=\"card p-6 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 border border-blue-200 dark:border-blue-800\">\r\n        <h3 className=\"text-lg font-semibold mb-3 text-blue-800 dark:text-blue-200 flex items-center gap-2\">\r\n          💡 Learning Insights\r\n        </h3>\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-sm\">\r\n          <div className=\"text-center\">\r\n            <div className=\"text-2xl font-bold text-blue-600 dark:text-blue-400\">87%</div>\r\n            <div className=\"text-blue-700 dark:text-blue-300\">Spaced repetition effectiveness</div>\r\n          </div>\r\n          <div className=\"text-center\">\r\n            <div className=\"text-2xl font-bold text-green-600 dark:text-green-400\">25min</div>\r\n            <div className=\"text-green-700 dark:text-green-300\">Optimal study session</div>\r\n          </div>\r\n          <div className=\"text-center\">\r\n            <div className=\"text-2xl font-bold text-purple-600 dark:text-purple-400\">7-9PM</div>\r\n            <div className=\"text-purple-700 dark:text-purple-300\">Peak learning hours</div>\r\n          </div>\r\n          <div className=\"text-center\">\r\n            <div className=\"text-2xl font-bold text-orange-600 dark:text-orange-400\">3x</div>\r\n            <div className=\"text-orange-700 dark:text-orange-300\">Retention improvement</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default HomePage","import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport { ZoomIn, ZoomOut, RotateCcw } from 'lucide-react';\r\nimport { SvgMapCardOptions } from '../../../shared/types';\r\n\r\ninterface SvgMapCardProps {\r\n  options: SvgMapCardOptions;\r\n  showAnswer?: boolean;\r\n  onAnswer?: (correct: boolean) => void;\r\n  isStudyMode?: boolean;\r\n}\r\n\r\n// Define small countries/regions that need visual indicators by map type\r\nconst SMALL_REGIONS_BY_MAP: { [mapType: string]: string[] } = {\r\n  'europe': [\r\n    'AD', // Andorra\r\n    'LI', // Liechtenstein\r\n    'LU', // Luxembourg\r\n    'MT', // Malta\r\n    'MC', // Monaco\r\n    'SM', // San Marino\r\n    'VA', // Vatican City\r\n    'CY', // Cyprus\r\n    'ME', // Montenegro\r\n    'MK', // Macedonia\r\n    'XK', // Kosovo\r\n    'SI', // Slovenia\r\n    'MD'  // Moldova\r\n  ],\r\n  'world': [\r\n    'AD', 'LI', 'LU', 'MT', 'MC', 'SM', 'VA', // Europe small countries\r\n    'SG', 'BH', 'BN', 'QA', 'KW', // Small Asian countries\r\n    'BB', 'GD', 'LC', 'VC', 'AG', 'KN', 'DM', // Caribbean islands\r\n    'MV', 'NR', 'TV', 'PW', 'MH', 'FM', 'KI', 'TO', 'WS', 'VU', 'FJ' // Pacific islands\r\n  ],\r\n  'africa': [\r\n    'DJ', 'GM', 'GW', 'GQ', 'CV', 'KM', 'MU', 'SC', 'ST' // Small African countries\r\n  ],\r\n  'north-america': [\r\n    'BB', 'GD', 'LC', 'VC', 'AG', 'KN', 'DM', 'TT', 'JM' // Caribbean islands\r\n  ],\r\n  'us': [\r\n    'DE', 'RI', 'CT', 'NJ', 'NH', 'VT', 'MA', 'MD', 'HI' // Small US states\r\n  ]\r\n};\r\n\r\nexport const SvgMapCard: React.FC<SvgMapCardProps> = ({\r\n  options,\r\n  showAnswer = false,\r\n  onAnswer,\r\n  isStudyMode = false\r\n}) => {\r\n  const [svgContent, setSvgContent] = useState<string>('');\r\n  const [userAnswer, setUserAnswer] = useState<string>('');\r\n  const [showResult, setShowResult] = useState(false);\r\n  \r\n  // Zoom and pan state\r\n  const [zoom, setZoom] = useState(1);\r\n  const [panX, setPanX] = useState(0);\r\n  const [panY, setPanY] = useState(0);\r\n  const [isDragging, setIsDragging] = useState(false);\r\n  const [dragStart, setDragStart] = useState({ x: 0, y: 0 });\r\n  const [initialZoomCalculated, setInitialZoomCalculated] = useState(false);\r\n  const mapContainerRef = useRef<HTMLDivElement>(null);\r\n\r\n  const loadSvgContent = useCallback(async () => {\r\n    try {\r\n      const response = await fetch(options.svgPath);\r\n      const svgText = await response.text();\r\n      setSvgContent(svgText);\r\n    } catch (error) {\r\n      console.error('Failed to load SVG:', error);\r\n    }\r\n  }, [options.svgPath]);\r\n\r\n  useEffect(() => {\r\n    loadSvgContent();\r\n  }, [loadSvgContent]);\r\n\r\n  // Reset input and result state when country changes\r\n  useEffect(() => {\r\n    setUserAnswer('');\r\n    setShowResult(false);\r\n    // Reset zoom and pan when country changes, but don't reset to 1 - let calculateInitialZoom handle it\r\n    setInitialZoomCalculated(false);\r\n    setPanX(0);\r\n    setPanY(0);\r\n  }, [options.countryId, options.countryName]);\r\n\r\n  // Calculate optimal initial zoom level based on country size and map fitting\r\n  const calculateInitialZoom = useCallback((svgElement: SVGSVGElement, countryElement?: Element) => {\r\n    try {\r\n      const containerRect = mapContainerRef.current?.getBoundingClientRect();\r\n      if (!containerRect) return 1;\r\n\r\n      // Get the SVG viewBox to understand the coordinate system\r\n      const viewBox = svgElement.getAttribute('viewBox');\r\n      let svgWidth = 1000, svgHeight = 600; // defaults\r\n      \r\n      if (viewBox) {\r\n        const [, , width, height] = viewBox.split(' ').map(Number);\r\n        svgWidth = width;\r\n        svgHeight = height;\r\n      }\r\n\r\n      const containerWidth = containerRect.width;\r\n      const containerHeight = containerRect.height;\r\n\r\n      // Calculate base zoom to fit the entire map in the container\r\n      const baseZoomX = containerWidth / svgWidth;\r\n      const baseZoomY = containerHeight / svgHeight;\r\n      const baseZoom = Math.min(baseZoomX, baseZoomY) * 0.98; // 98% to leave very minimal padding\r\n\r\n      // If no specific country element, return a much higher base zoom to fill the container\r\n      if (!countryElement) {\r\n        // For world maps, ensure they fill the container completely with aggressive zoom\r\n        const enhancedBaseZoom = Math.max(baseZoom, 4.0); // Minimum 400% zoom as requested\r\n        return Math.max(4.0, Math.min(enhancedBaseZoom, 6));\r\n      }\r\n\r\n      // Get the bounding box of the country in SVG coordinates\r\n      const bbox = (countryElement as SVGGraphicsElement).getBBox();\r\n      \r\n      if (!bbox || bbox.width === 0 || bbox.height === 0) {\r\n        console.warn('Invalid bounding box for country element');\r\n        return Math.max(0.5, Math.min(baseZoom, 3));\r\n      }\r\n      \r\n      // Minimum size requirement: 25x25 pixels on screen (increased from 15x15)\r\n      const minPixelSize = 25;\r\n      \r\n      // Calculate how many SVG units correspond to the minimum pixel size\r\n      const minSvgWidth = minPixelSize / baseZoom;\r\n      const minSvgHeight = minPixelSize / baseZoom;\r\n      \r\n      // Calculate zoom needed to make the country at least minPixelSize\r\n      const zoomForWidth = bbox.width < minSvgWidth ? minSvgWidth / bbox.width : 1;\r\n      const zoomForHeight = bbox.height < minSvgHeight ? minSvgHeight / bbox.height : 1;\r\n      \r\n      // Use the larger zoom factor to ensure both dimensions meet the minimum\r\n      let countryZoom = Math.max(zoomForWidth, zoomForHeight);\r\n      \r\n      // For very small countries (less than 10 SVG units in any dimension), apply much more aggressive zoom\r\n      if (bbox.width < 10 || bbox.height < 10) {\r\n        countryZoom = Math.max(countryZoom, 12); // Increased from 8x to 12x zoom for tiny countries\r\n      }\r\n      \r\n      // For extremely small countries (less than 3 SVG units), apply extreme zoom\r\n      if (bbox.width < 3 || bbox.height < 3) {\r\n        countryZoom = Math.max(countryZoom, 25); // Increased from 15x to 25x zoom for microscopic countries\r\n      }\r\n      \r\n      // For ultra-micro countries (less than 1 SVG unit), apply ultra-extreme zoom\r\n      if (bbox.width < 1 || bbox.height < 1) {\r\n        countryZoom = Math.max(countryZoom, 40); // 40x zoom for ultra-microscopic countries like Andorra\r\n      }\r\n      \r\n      // Combine base zoom with country-specific zoom\r\n      const finalZoom = baseZoom * countryZoom;\r\n      \r\n      // Ensure minimum zoom is at least 400% (4x) for map deck cards as requested\r\n      const minZoom = Math.max(4.0, baseZoom); // At least 400% or the base zoom, whichever is higher\r\n      \r\n      // Clamp between reasonable bounds (increased max to 50 for ultra-small countries)\r\n      const clampedZoom = Math.max(minZoom, Math.min(finalZoom, 50));\r\n      \r\n      console.log('Zoom calculation details:', {\r\n        containerSize: `${containerWidth}x${containerHeight}`,\r\n        svgSize: `${svgWidth}x${svgHeight}`,\r\n        baseZoom: baseZoom.toFixed(3),\r\n        countryBBox: `${bbox.width.toFixed(1)}x${bbox.height.toFixed(1)} at (${bbox.x.toFixed(1)},${bbox.y.toFixed(1)})`,\r\n        countryZoom: countryZoom.toFixed(3),\r\n        finalZoom: clampedZoom.toFixed(3)\r\n      });\r\n      \r\n      return clampedZoom;\r\n    } catch (error) {\r\n      console.warn('Error calculating initial zoom:', error);\r\n      // Fallback: calculate base zoom to fit map in container\r\n      const containerRect = mapContainerRef.current?.getBoundingClientRect();\r\n      if (containerRect) {\r\n        const baseZoom = Math.min(containerRect.width / 1000, containerRect.height / 600) * 0.98;\r\n        return Math.max(4.0, Math.min(baseZoom, 6));\r\n      }\r\n      return 4.0; // Minimum 400% zoom as requested for map deck cards\r\n    }\r\n  }, []);\r\n\r\n  // Zoom and pan functions\r\n  const handleZoomIn = useCallback(() => {\r\n    setZoom(prev => Math.min(prev * 1.5, 50)); // Increased max zoom to 50x (5000%)\r\n  }, []);\r\n\r\n  const handleZoomOut = useCallback(() => {\r\n    setZoom(prev => Math.max(prev / 1.5, 0.5));\r\n  }, []);\r\n\r\n  const handleResetView = useCallback(() => {\r\n    setInitialZoomCalculated(false);\r\n    setPanX(0);\r\n    setPanY(0);\r\n    // Let the effect recalculate the initial zoom\r\n  }, []);\r\n\r\n  const handleMouseDown = useCallback((e: React.MouseEvent) => {\r\n    if (zoom > 1) {\r\n      setIsDragging(true);\r\n      setDragStart({ x: e.clientX - panX, y: e.clientY - panY });\r\n    }\r\n  }, [zoom, panX, panY]);\r\n\r\n  const handleMouseMove = useCallback((e: React.MouseEvent) => {\r\n    if (isDragging && zoom > 1) {\r\n      setPanX(e.clientX - dragStart.x);\r\n      setPanY(e.clientY - dragStart.y);\r\n    }\r\n  }, [isDragging, dragStart, zoom]);\r\n\r\n  const handleMouseUp = useCallback(() => {\r\n    setIsDragging(false);\r\n  }, []);\r\n\r\n  const handleWheel = useCallback((e: React.WheelEvent) => {\r\n    e.preventDefault();\r\n    const delta = e.deltaY > 0 ? 0.9 : 1.1;\r\n    setZoom(prev => Math.max(0.5, Math.min(50, prev * delta))); // Increased max zoom to 50x\r\n  }, []);\r\n\r\n  // Touch events for mobile\r\n  const handleTouchStart = useCallback((e: React.TouchEvent) => {\r\n    if (e.touches.length === 1 && zoom > 1) {\r\n      const touch = e.touches[0];\r\n      setIsDragging(true);\r\n      setDragStart({ x: touch.clientX - panX, y: touch.clientY - panY });\r\n    }\r\n  }, [zoom, panX, panY]);\r\n\r\n  const handleTouchMove = useCallback((e: React.TouchEvent) => {\r\n    if (isDragging && e.touches.length === 1 && zoom > 1) {\r\n      e.preventDefault();\r\n      const touch = e.touches[0];\r\n      setPanX(touch.clientX - dragStart.x);\r\n      setPanY(touch.clientY - dragStart.y);\r\n    }\r\n  }, [isDragging, dragStart, zoom]);\r\n\r\n  const handleTouchEnd = useCallback(() => {\r\n    setIsDragging(false);\r\n  }, []);\r\n\r\n  // Get map type from SVG path\r\n  const getMapType = (svgPath: string): string => {\r\n    const filename = svgPath.split('/').pop()?.replace('.svg', '') || '';\r\n    return filename;\r\n  };\r\n\r\n  // Improved positioning coordinates for small countries/regions based on actual SVG coordinates\r\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n  const getSmallRegionIndicatorPosition = (countryId: string, mapType: string) => {\r\n    // Position data organized by map type\r\n    const positionsByMap: { [mapType: string]: { [regionId: string]: { x: number; y: number; offsetX: number; offsetY: number } } } = {\r\n      'europe': {\r\n        'AD': { x: 420, y: 380, offsetX: 50, offsetY: -40 }, // Andorra\r\n        'LI': { x: 480, y: 320, offsetX: 40, offsetY: -50 }, // Liechtenstein\r\n        'LU': { x: 440, y: 280, offsetX: -60, offsetY: -30 }, // Luxembourg\r\n        'MT': { x: 520, y: 480, offsetX: 0, offsetY: 60 }, // Malta\r\n        'MC': { x: 460, y: 380, offsetX: 60, offsetY: -20 }, // Monaco\r\n        'SM': { x: 500, y: 400, offsetX: 50, offsetY: -30 }, // San Marino\r\n        'VA': { x: 490, y: 420, offsetX: 40, offsetY: -40 }, // Vatican City\r\n        'CY': { x: 680, y: 460, offsetX: 0, offsetY: 70 }, // Cyprus\r\n        'ME': { x: 580, y: 400, offsetX: 60, offsetY: -30 }, // Montenegro\r\n        'MK': { x: 600, y: 420, offsetX: 0, offsetY: 60 }, // North Macedonia\r\n        'XK': { x: 580, y: 410, offsetX: -60, offsetY: 0 }, // Kosovo\r\n        'SI': { x: 520, y: 350, offsetX: 0, offsetY: -60 }, // Slovenia\r\n        'MD': { x: 660, y: 340, offsetX: 80, offsetY: 0 } // Moldova\r\n      },\r\n      'world': {\r\n        // Europe small countries (scaled for world map) - corrected coordinates based on actual geography\r\n        'AD': { x: 460, y: 210, offsetX: 30, offsetY: -25 }, // Andorra - in Pyrenees between France and Spain\r\n        'LI': { x: 490, y: 175, offsetX: 25, offsetY: -30 }, // Liechtenstein - between Switzerland and Austria\r\n        'LU': { x: 475, y: 165, offsetX: -35, offsetY: -20 }, // Luxembourg - between France, Belgium, Germany\r\n        'MT': { x: 510, y: 240, offsetX: 0, offsetY: 35 }, // Malta - south of Sicily\r\n        'MC': { x: 465, y: 215, offsetX: 35, offsetY: -15 }, // Monaco - French Riviera\r\n        'SM': { x: 500, y: 200, offsetX: 30, offsetY: -20 }, // San Marino - within Italy\r\n        'VA': { x: 498, y: 205, offsetX: 25, offsetY: -25 }, // Vatican City - within Rome\r\n        // Small Asian countries\r\n        'SG': { x: 710, y: 285, offsetX: 0, offsetY: 40 }, // Singapore - Southeast Asia, south of Malaysia\r\n        'BH': { x: 580, y: 235, offsetX: 30, offsetY: -20 }, // Bahrain - Persian Gulf, near Saudi Arabia\r\n        'BN': { x: 720, y: 290, offsetX: 40, offsetY: 0 }, // Brunei - Southeast Asia, on Borneo island\r\n        'QA': { x: 585, y: 240, offsetX: 35, offsetY: -25 }, // Qatar - Persian Gulf peninsula\r\n        'KW': { x: 575, y: 225, offsetX: 30, offsetY: -30 }, // Kuwait - Persian Gulf, north of Saudi Arabia\r\n        // Caribbean islands\r\n        'BB': { x: 180, y: 250, offsetX: 40, offsetY: 0 }, // Barbados\r\n        'GD': { x: 175, y: 245, offsetX: -40, offsetY: 0 }, // Grenada\r\n        // Pacific islands\r\n        'MV': { x: 450, y: 280, offsetX: 0, offsetY: 50 }, // Maldives\r\n        'NR': { x: 680, y: 290, offsetX: 40, offsetY: 0 }, // Nauru\r\n        'TV': { x: 720, y: 310, offsetX: 0, offsetY: 40 } // Tuvalu\r\n      },\r\n      'us': {\r\n        'DE': { x: 750, y: 200, offsetX: 40, offsetY: -20 }, // Delaware\r\n        'RI': { x: 820, y: 150, offsetX: 30, offsetY: -25 }, // Rhode Island\r\n        'CT': { x: 810, y: 160, offsetX: 35, offsetY: -20 }, // Connecticut\r\n        'NJ': { x: 780, y: 180, offsetX: 40, offsetY: -15 }, // New Jersey\r\n        'NH': { x: 820, y: 130, offsetX: 30, offsetY: -30 }, // New Hampshire\r\n        'VT': { x: 800, y: 125, offsetX: -35, offsetY: -25 }, // Vermont\r\n        'MA': { x: 825, y: 145, offsetX: 40, offsetY: -20 }, // Massachusetts\r\n        'MD': { x: 770, y: 190, offsetX: -40, offsetY: -20 }, // Maryland\r\n        'HI': { x: 200, y: 400, offsetX: 0, offsetY: 50 } // Hawaii\r\n      }\r\n    };\r\n\r\n    const mapPositions = positionsByMap[mapType];\r\n    if (mapPositions && mapPositions[countryId]) {\r\n      return mapPositions[countryId];\r\n    }\r\n\r\n    // Default fallback position\r\n    return { x: 500, y: 350, offsetX: 50, offsetY: -50 };\r\n  };\r\n\r\n\r\n  const processedSvgContent = React.useMemo(() => {\r\n    if (!svgContent) return '';\r\n\r\n    // Parse the SVG and highlight the target country/region\r\n    const parser = new DOMParser();\r\n    const svgDoc = parser.parseFromString(svgContent, 'image/svg+xml');\r\n    \r\n    // Get the SVG element and make it responsive\r\n    const svgElement = svgDoc.querySelector('svg');\r\n    if (svgElement) {\r\n      svgElement.setAttribute('width', '100%');\r\n      svgElement.setAttribute('height', '100%');\r\n      svgElement.setAttribute('viewBox', svgElement.getAttribute('viewBox') || '0 0 1000 600');\r\n      svgElement.setAttribute('preserveAspectRatio', 'xMidYMid meet');\r\n      svgElement.style.maxWidth = '100%';\r\n      svgElement.style.maxHeight = '100%';\r\n    }\r\n    \r\n    // Determine map type from SVG path\r\n    const mapType = getMapType(options.svgPath);\r\n    \r\n    // Find the target country/region element\r\n    const targetCountry = svgDoc.querySelector(`[id=\"${options.countryId}\"]`);\r\n    \r\n    // Determine if this is a small region that needs an indicator\r\n    const smallRegions = SMALL_REGIONS_BY_MAP[mapType] || [];\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    const isSmallRegion = smallRegions.includes(options.countryId);\r\n    \r\n    if (targetCountry) {\r\n      // Set highlight style for the target country/region\r\n      targetCountry.setAttribute('fill', '#ef4444'); // Red highlight\r\n      targetCountry.setAttribute('stroke', '#dc2626');\r\n      targetCountry.setAttribute('stroke-width', '2');\r\n    }\r\n    \r\n\r\n    // Reset all other countries/regions to default style\r\n    const allRegions = svgDoc.querySelectorAll('path[id], polygon[id], circle[id]');\r\n    allRegions.forEach(region => {\r\n      if (region.getAttribute('id') !== options.countryId) {\r\n        region.setAttribute('fill', '#e5e7eb'); // Light gray\r\n        region.setAttribute('stroke', '#9ca3af');\r\n        region.setAttribute('stroke-width', '1');\r\n      }\r\n    });\r\n\r\n    return new XMLSerializer().serializeToString(svgDoc);\r\n  }, [svgContent, options.countryId, options.svgPath]);\r\n\r\n  // Effect to calculate and set initial zoom level\r\n  useEffect(() => {\r\n    if (!processedSvgContent || initialZoomCalculated) return;\r\n\r\n    // Wait for the DOM to update with the new SVG content\r\n    const timer = setTimeout(() => {\r\n      const mapContainer = mapContainerRef.current;\r\n      if (!mapContainer) return;\r\n\r\n      const svgElement = mapContainer.querySelector('svg');\r\n      if (!svgElement) return;\r\n\r\n      // Try multiple selectors to find the target country element\r\n      let targetCountry = svgElement.querySelector(`[id=\"${options.countryId}\"]`);\r\n      \r\n      // If not found, try alternative selectors\r\n      if (!targetCountry) {\r\n        // Try with different case variations\r\n        targetCountry = svgElement.querySelector(`[id=\"${options.countryId.toLowerCase()}\"]`) ||\r\n                       svgElement.querySelector(`[id=\"${options.countryId.toUpperCase()}\"]`) ||\r\n                       // Try with class selector\r\n                       svgElement.querySelector(`[class*=\"${options.countryId}\"]`) ||\r\n                       // Try data attributes\r\n                       svgElement.querySelector(`[data-id=\"${options.countryId}\"]`) ||\r\n                       svgElement.querySelector(`[data-country=\"${options.countryId}\"]`) ||\r\n                       // Try name attribute\r\n                       svgElement.querySelector(`[name=\"${options.countryId}\"]`);\r\n      }\r\n      \r\n      // Calculate zoom - pass targetCountry if found, otherwise calculate base zoom for map fitting\r\n      const optimalZoom = calculateInitialZoom(svgElement, targetCountry || undefined);\r\n      setZoom(optimalZoom);\r\n      setInitialZoomCalculated(true);\r\n      \r\n      console.log('Setting initial zoom:', optimalZoom, 'for country:', options.countryId, 'found element:', !!targetCountry);\r\n    }, 100); // Small delay to ensure DOM is updated\r\n\r\n    return () => clearTimeout(timer);\r\n  }, [processedSvgContent, options.countryId, initialZoomCalculated, calculateInitialZoom]);\r\n\r\n  const handleSubmitAnswer = () => {\r\n    const isCorrect = userAnswer.toLowerCase().trim() === options.countryName.toLowerCase().trim();\r\n    setShowResult(true);\r\n    if (onAnswer) {\r\n      onAnswer(isCorrect);\r\n    }\r\n  };\r\n\r\n  const handleKeyPress = (e: React.KeyboardEvent) => {\r\n    if (e.key === 'Enter' && userAnswer.trim() && !showResult) {\r\n      handleSubmitAnswer();\r\n    }\r\n  };\r\n\r\n  if (!svgContent) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-64 bg-gray-100 rounded-lg\">\r\n        <div className=\"text-gray-500\">Loading map...</div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"w-full mx-auto\">\r\n      {/* Map Display */}\r\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg p-4 mb-4 relative\">\r\n        {/* Zoom Controls */}\r\n        <div className=\"absolute top-2 right-2 z-10 flex flex-col gap-1 bg-white dark:bg-gray-700 rounded-lg shadow-lg p-1\">\r\n          <button\r\n            onClick={handleZoomIn}\r\n            className=\"p-2 hover:bg-gray-100 dark:hover:bg-gray-600 rounded transition-colors\"\r\n            title=\"Zoom In\"\r\n          >\r\n            <ZoomIn size={16} className=\"text-gray-700 dark:text-gray-300\" />\r\n          </button>\r\n          <button\r\n            onClick={handleZoomOut}\r\n            className=\"p-2 hover:bg-gray-100 dark:hover:bg-gray-600 rounded transition-colors\"\r\n            title=\"Zoom Out\"\r\n          >\r\n            <ZoomOut size={16} className=\"text-gray-700 dark:text-gray-300\" />\r\n          </button>\r\n          <button\r\n            onClick={handleResetView}\r\n            className=\"p-2 hover:bg-gray-100 dark:hover:bg-gray-600 rounded transition-colors\"\r\n            title=\"Reset View\"\r\n          >\r\n            <RotateCcw size={16} className=\"text-gray-700 dark:text-gray-300\" />\r\n          </button>\r\n        </div>\r\n\r\n        {/* Zoom Level Indicator */}\r\n        {zoom !== 1 && (\r\n          <div className=\"absolute top-2 left-2 z-10 bg-black bg-opacity-75 text-white px-2 py-1 rounded text-sm\">\r\n            {Math.round(zoom * 100)}%\r\n          </div>\r\n        )}\r\n\r\n        {/* Map Container */}\r\n        <div\r\n          ref={mapContainerRef}\r\n          className=\"w-full h-64 md:h-80 flex items-center justify-center overflow-hidden cursor-grab active:cursor-grabbing\"\r\n          style={{\r\n            cursor: zoom > 1 ? (isDragging ? 'grabbing' : 'grab') : 'default'\r\n          }}\r\n          onMouseDown={handleMouseDown}\r\n          onMouseMove={handleMouseMove}\r\n          onMouseUp={handleMouseUp}\r\n          onMouseLeave={handleMouseUp}\r\n          onWheel={handleWheel}\r\n          onTouchStart={handleTouchStart}\r\n          onTouchMove={handleTouchMove}\r\n          onTouchEnd={handleTouchEnd}\r\n        >\r\n          <div\r\n            className=\"transition-transform duration-200 ease-out\"\r\n            style={{\r\n              transform: `scale(${zoom}) translate(${panX / zoom}px, ${panY / zoom}px)`,\r\n              transformOrigin: 'center center'\r\n            }}\r\n            dangerouslySetInnerHTML={{ __html: processedSvgContent }}\r\n          />\r\n        </div>\r\n\r\n        {/* Instructions for zoom */}\r\n        {zoom === 1 && (\r\n          <div className=\"absolute bottom-2 left-2 z-10 bg-black bg-opacity-75 text-white px-2 py-1 rounded text-xs\">\r\n            Use controls or scroll to zoom • Drag to pan when zoomed\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Question/Answer Section */}\r\n      {isStudyMode && !showAnswer && (\r\n        <div className=\"bg-white rounded-lg shadow-lg p-6\">\r\n          <h3 className=\"text-lg font-semibold mb-4 text-center\">\r\n            What {getMapType(options.svgPath).includes('us') ? 'state' :\r\n                  getMapType(options.svgPath).includes('gb') || getMapType(options.svgPath).includes('fi') ||\r\n                  getMapType(options.svgPath).includes('fr') || getMapType(options.svgPath).includes('no') ||\r\n                  getMapType(options.svgPath).includes('se') || getMapType(options.svgPath).includes('vn') ? 'region' : 'country'} is highlighted in red?\r\n          </h3>\r\n          \r\n          {!showResult ? (\r\n            <div className=\"space-y-4\">\r\n              <input\r\n                type=\"text\"\r\n                value={userAnswer}\r\n                onChange={(e) => setUserAnswer(e.target.value)}\r\n                onKeyPress={handleKeyPress}\r\n                placeholder=\"Enter country name...\"\r\n                className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                autoFocus\r\n              />\r\n              <button\r\n                onClick={handleSubmitAnswer}\r\n                disabled={!userAnswer.trim()}\r\n                className=\"w-full bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors\"\r\n              >\r\n                Submit Answer\r\n              </button>\r\n            </div>\r\n          ) : (\r\n            <div className=\"text-center\">\r\n              <div className={`text-lg font-semibold mb-2 ${\r\n                userAnswer.toLowerCase().trim() === options.countryName.toLowerCase().trim()\r\n                  ? 'text-green-600' \r\n                  : 'text-red-600'\r\n              }`}>\r\n                {userAnswer.toLowerCase().trim() === options.countryName.toLowerCase().trim()\r\n                  ? '✓ Correct!' \r\n                  : '✗ Incorrect'}\r\n              </div>\r\n              <div className=\"text-gray-700\">\r\n                Your answer: <span className=\"font-medium\">{userAnswer}</span>\r\n              </div>\r\n              <div className=\"text-gray-700\">\r\n                Correct answer: <span className=\"font-medium\">{options.countryName}</span>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* Answer Display (for review mode) */}\r\n      {showAnswer && (\r\n        <div className=\"bg-white rounded-lg shadow-lg p-6 text-center\">\r\n          <h3 className=\"text-lg font-semibold text-gray-800\">\r\n            {options.countryName}\r\n          </h3>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};","import React from 'react'\r\nimport { Card, SvgMapCardOptions } from '../../../../shared/types'\r\nimport { SvgMapCard } from '../SvgMapCard'\r\n\r\ninterface CardRendererProps {\r\n  card: Card\r\n  showAnswer: boolean\r\n  onAnswerSubmit?: (answer: string) => void\r\n}\r\n\r\nconst CardRenderer: React.FC<CardRendererProps> = ({ card, showAnswer, onAnswerSubmit }) => {\r\n  if (!card) {\r\n    return null // or a loading indicator\r\n  }\r\n  // Handle SVG map cards\r\n  if (card.cardType.type === 'svg_map') {\r\n    const options = card.cardType.options as SvgMapCardOptions\r\n    return (\r\n      <SvgMapCard\r\n        options={options}\r\n        showAnswer={showAnswer}\r\n        isStudyMode={!showAnswer}\r\n        onAnswer={(correct) => {\r\n          if (onAnswerSubmit) {\r\n            onAnswerSubmit(correct ? 'correct' : 'incorrect')\r\n          }\r\n        }}\r\n      />\r\n    )\r\n  }\r\n\r\n  // Handle basic cards (default behavior)\r\n  return (\r\n    <div className=\"text-center\">\r\n      <div className=\"mb-6\">\r\n        <h2 className=\"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2\">\r\n          {showAnswer ? 'Answer' : 'Question'}\r\n        </h2>\r\n        <div className=\"text-2xl font-medium text-gray-900 dark:text-white\">\r\n          {showAnswer ? card.backContent : card.frontContent}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default CardRenderer","import { useEffect, useCallback, useRef } from 'react'\r\n\r\nexport interface KeyboardShortcut {\r\n  key: string\r\n  description: string\r\n  action: () => void\r\n  disabled?: boolean\r\n  ctrlKey?: boolean\r\n  altKey?: boolean\r\n  shiftKey?: boolean\r\n}\r\n\r\nexport interface UseKeyboardShortcutsOptions {\r\n  shortcuts: KeyboardShortcut[]\r\n  enabled?: boolean\r\n  preventDefault?: boolean\r\n  stopPropagation?: boolean\r\n  debugMode?: boolean\r\n}\r\n\r\n/**\r\n * Custom hook for managing keyboard shortcuts\r\n * \r\n * Provides comprehensive keyboard shortcut management with:\r\n * - Multiple modifier key support (Ctrl, Alt, Shift)\r\n * - Conditional enabling/disabling\r\n * - Debug logging\r\n * - Event handling options\r\n */\r\nexport const useKeyboardShortcuts = ({\r\n  shortcuts,\r\n  enabled = true,\r\n  preventDefault = true,\r\n  stopPropagation = true,\r\n  debugMode = false\r\n}: UseKeyboardShortcutsOptions) => {\r\n  const shortcutsRef = useRef(shortcuts)\r\n  const enabledRef = useRef(enabled)\r\n\r\n  // Update refs when props change\r\n  useEffect(() => {\r\n    shortcutsRef.current = shortcuts\r\n    enabledRef.current = enabled\r\n  }, [shortcuts, enabled])\r\n\r\n  const handleKeyDown = useCallback((event: KeyboardEvent) => {\r\n    if (!enabledRef.current) return\r\n\r\n    // Don't trigger shortcuts when user is typing in input fields\r\n    const target = event.target as HTMLElement\r\n    if (target.tagName === 'INPUT' || target.tagName === 'TEXTAREA' || target.isContentEditable) {\r\n      return\r\n    }\r\n\r\n    const key = event.key.toLowerCase()\r\n    const ctrlKey = event.ctrlKey || event.metaKey // Support both Ctrl and Cmd\r\n    const altKey = event.altKey\r\n    const shiftKey = event.shiftKey\r\n\r\n    if (debugMode) {\r\n      console.log('[KeyboardShortcuts] Key pressed:', {\r\n        key,\r\n        ctrlKey,\r\n        altKey,\r\n        shiftKey,\r\n        code: event.code\r\n      })\r\n    }\r\n\r\n    // Find matching shortcut\r\n    const matchingShortcut = shortcutsRef.current.find(shortcut => {\r\n      if (shortcut.disabled) return false\r\n      \r\n      const keyMatches = shortcut.key.toLowerCase() === key\r\n      const ctrlMatches = (shortcut.ctrlKey || false) === ctrlKey\r\n      const altMatches = (shortcut.altKey || false) === altKey\r\n      const shiftMatches = (shortcut.shiftKey || false) === shiftKey\r\n\r\n      return keyMatches && ctrlMatches && altMatches && shiftMatches\r\n    })\r\n\r\n    if (matchingShortcut) {\r\n      if (debugMode) {\r\n        console.log('[KeyboardShortcuts] Executing shortcut:', {\r\n          key: matchingShortcut.key,\r\n          description: matchingShortcut.description\r\n        })\r\n      }\r\n\r\n      if (preventDefault) {\r\n        event.preventDefault()\r\n      }\r\n      \r\n      if (stopPropagation) {\r\n        event.stopPropagation()\r\n      }\r\n\r\n      try {\r\n        matchingShortcut.action()\r\n      } catch (error) {\r\n        console.error('[KeyboardShortcuts] Error executing shortcut:', error)\r\n      }\r\n    }\r\n  }, [preventDefault, stopPropagation, debugMode])\r\n\r\n  useEffect(() => {\r\n    if (enabled) {\r\n      document.addEventListener('keydown', handleKeyDown)\r\n      \r\n      if (debugMode) {\r\n        console.log('[KeyboardShortcuts] Registered shortcuts:', shortcuts.map(s => ({\r\n          key: s.key,\r\n          description: s.description,\r\n          modifiers: {\r\n            ctrl: s.ctrlKey,\r\n            alt: s.altKey,\r\n            shift: s.shiftKey\r\n          }\r\n        })))\r\n      }\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener('keydown', handleKeyDown)\r\n      \r\n      if (debugMode) {\r\n        console.log('[KeyboardShortcuts] Unregistered shortcuts')\r\n      }\r\n    }\r\n  }, [handleKeyDown, enabled, debugMode, shortcuts])\r\n\r\n  return {\r\n    shortcuts: shortcutsRef.current,\r\n    enabled: enabledRef.current\r\n  }\r\n}\r\n\r\n/**\r\n * Hook specifically for study session shortcuts\r\n */\r\nexport const useStudyKeyboardShortcuts = ({\r\n  onFlipCard,\r\n  onAnswerAgain,\r\n  onAnswerHard,\r\n  onAnswerGood,\r\n  onAnswerEasy,\r\n  onExitStudy,\r\n  showAnswer,\r\n  enabled = true,\r\n  debugMode = false\r\n}: {\r\n  onFlipCard: () => void\r\n  onAnswerAgain: () => void\r\n  onAnswerHard: () => void\r\n  onAnswerGood: () => void\r\n  onAnswerEasy: () => void\r\n  onExitStudy: () => void\r\n  showAnswer: boolean\r\n  enabled?: boolean\r\n  debugMode?: boolean\r\n}) => {\r\n  const shortcuts: KeyboardShortcut[] = [\r\n    // Card flipping\r\n    {\r\n      key: ' ', // Space\r\n      description: 'Flip card / Show answer',\r\n      action: onFlipCard,\r\n      disabled: showAnswer\r\n    },\r\n    {\r\n      key: 'enter',\r\n      description: 'Flip card / Show answer',\r\n      action: onFlipCard,\r\n      disabled: showAnswer\r\n    },\r\n    \r\n    // Answer shortcuts (only when answer is shown)\r\n    {\r\n      key: '1',\r\n      description: 'Answer: Again',\r\n      action: onAnswerAgain,\r\n      disabled: !showAnswer\r\n    },\r\n    {\r\n      key: '2',\r\n      description: 'Answer: Hard',\r\n      action: onAnswerHard,\r\n      disabled: !showAnswer\r\n    },\r\n    {\r\n      key: '3',\r\n      description: 'Answer: Good',\r\n      action: onAnswerGood,\r\n      disabled: !showAnswer\r\n    },\r\n    {\r\n      key: '4',\r\n      description: 'Answer: Easy',\r\n      action: onAnswerEasy,\r\n      disabled: !showAnswer\r\n    },\r\n    \r\n    // Alternative answer shortcuts\r\n    {\r\n      key: 'a',\r\n      description: 'Answer: Again',\r\n      action: onAnswerAgain,\r\n      disabled: !showAnswer\r\n    },\r\n    {\r\n      key: 'h',\r\n      description: 'Answer: Hard',\r\n      action: onAnswerHard,\r\n      disabled: !showAnswer\r\n    },\r\n    {\r\n      key: 'g',\r\n      description: 'Answer: Good',\r\n      action: onAnswerGood,\r\n      disabled: !showAnswer\r\n    },\r\n    {\r\n      key: 'e',\r\n      description: 'Answer: Easy',\r\n      action: onAnswerEasy,\r\n      disabled: !showAnswer\r\n    },\r\n    \r\n    // Navigation shortcuts\r\n    {\r\n      key: 'escape',\r\n      description: 'Exit study session',\r\n      action: onExitStudy\r\n    },\r\n    {\r\n      key: 'q',\r\n      description: 'Exit study session',\r\n      action: onExitStudy\r\n    }\r\n  ]\r\n\r\n  return useKeyboardShortcuts({\r\n    shortcuts,\r\n    enabled,\r\n    debugMode\r\n  })\r\n}","import React from 'react'\r\nimport { KeyboardShortcut } from '../../hooks/useKeyboardShortcuts'\r\n\r\ninterface KeyboardShortcutsHelpProps {\r\n  shortcuts: KeyboardShortcut[]\r\n  className?: string\r\n  title?: string\r\n  compact?: boolean\r\n}\r\n\r\n/**\r\n * Component to display keyboard shortcuts help\r\n */\r\nexport const KeyboardShortcutsHelp: React.FC<KeyboardShortcutsHelpProps> = ({ \r\n  shortcuts, \r\n  className = '',\r\n  title = 'Keyboard Shortcuts',\r\n  compact = false\r\n}) => {\r\n  const formatKey = (shortcut: KeyboardShortcut) => {\r\n    const parts = []\r\n    \r\n    if (shortcut.ctrlKey) parts.push('Ctrl')\r\n    if (shortcut.altKey) parts.push('Alt')\r\n    if (shortcut.shiftKey) parts.push('Shift')\r\n    \r\n    let key = shortcut.key\r\n    if (key === ' ') key = 'Space'\r\n    if (key === 'enter') key = 'Enter'\r\n    if (key === 'escape') key = 'Esc'\r\n    \r\n    parts.push(key.toUpperCase())\r\n    \r\n    return parts.join(' + ')\r\n  }\r\n\r\n  const enabledShortcuts = shortcuts.filter(s => !s.disabled)\r\n\r\n  if (enabledShortcuts.length === 0) return null\r\n\r\n  if (compact) {\r\n    return (\r\n      <div className={`text-xs text-gray-500 dark:text-gray-400 ${className}`}>\r\n        {enabledShortcuts.slice(0, 4).map((shortcut, index) => (\r\n          <span key={index} className=\"mr-4\">\r\n            <kbd className=\"px-1 py-0.5 bg-gray-200 dark:bg-gray-700 rounded text-xs\">\r\n              {shortcut.key === ' ' ? 'Space' : shortcut.key.toUpperCase()}\r\n            </kbd>\r\n            {' '}\r\n            {shortcut.description}\r\n          </span>\r\n        ))}\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className={`bg-gray-50 dark:bg-gray-800 rounded-lg p-4 ${className}`}>\r\n      <h3 className=\"font-semibold text-sm text-gray-700 dark:text-gray-300 mb-3\">\r\n        {title}\r\n      </h3>\r\n      <div className=\"space-y-2\">\r\n        {enabledShortcuts.map((shortcut, index) => (\r\n          <div key={index} className=\"flex justify-between items-center text-xs\">\r\n            <span className=\"text-gray-600 dark:text-gray-400\">\r\n              {shortcut.description}\r\n            </span>\r\n            <kbd className=\"px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded text-gray-800 dark:text-gray-200 font-mono\">\r\n              {formatKey(shortcut)}\r\n            </kbd>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\n/**\r\n * Study-specific shortcuts help component\r\n */\r\nexport const StudyShortcutsHelp: React.FC<{ \r\n  showAnswer: boolean\r\n  className?: string\r\n  compact?: boolean\r\n}> = ({ \r\n  showAnswer, \r\n  className = '',\r\n  compact = false\r\n}) => {\r\n  const shortcuts: KeyboardShortcut[] = [\r\n    // Always available\r\n    {\r\n      key: 'escape',\r\n      description: 'Exit study',\r\n      action: () => {},\r\n      disabled: false\r\n    },\r\n    \r\n    // Card flipping (when answer hidden)\r\n    {\r\n      key: ' ',\r\n      description: 'Show answer',\r\n      action: () => {},\r\n      disabled: showAnswer\r\n    },\r\n    \r\n    // Answer shortcuts (when answer shown)\r\n    {\r\n      key: '1',\r\n      description: 'Again',\r\n      action: () => {},\r\n      disabled: !showAnswer\r\n    },\r\n    {\r\n      key: '2',\r\n      description: 'Hard',\r\n      action: () => {},\r\n      disabled: !showAnswer\r\n    },\r\n    {\r\n      key: '3',\r\n      description: 'Good',\r\n      action: () => {},\r\n      disabled: !showAnswer\r\n    },\r\n    {\r\n      key: '4',\r\n      description: 'Easy',\r\n      action: () => {},\r\n      disabled: !showAnswer\r\n    }\r\n  ]\r\n\r\n  return (\r\n    <KeyboardShortcutsHelp \r\n      shortcuts={shortcuts}\r\n      className={className}\r\n      title=\"Study Shortcuts\"\r\n      compact={compact}\r\n    />\r\n  )\r\n}\r\n\r\nexport default KeyboardShortcutsHelp","import React from 'react'\r\nimport { Card } from '../../../../shared/types'\r\nimport {\r\n  getCardStateDescription,\r\n  getCardStateColor,\r\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n  getReviewCardType,\r\n  getNextReviewDate,\r\n  getDaysOverdue\r\n} from '../../utils/cardStateUtils'\r\n\r\ninterface CardStateIndicatorProps {\r\n  card: Card\r\n  className?: string\r\n  showDescription?: boolean\r\n  compact?: boolean\r\n}\r\n\r\nexport const CardStateIndicator: React.FC<CardStateIndicatorProps> = ({\r\n  card,\r\n  className = '',\r\n  showDescription = false,\r\n  compact = false\r\n}) => {\r\n  const stateColor = getCardStateColor(card)\r\n  const description = getCardStateDescription(card)\r\n  const nextReview = getNextReviewDate(card)\r\n  const daysOverdue = getDaysOverdue(card)\r\n\r\n  const getStateIcon = () => {\r\n    switch (card.state) {\r\n      case 'new':\r\n        return '✨'\r\n      case 'learning':\r\n        return '📚'\r\n      case 'review':\r\n        return card.ivl < 21 ? '🌱' : '🌳'\r\n      case 'relearning':\r\n        return '🔄'\r\n      case 'suspended':\r\n        return '⏸️'\r\n      case 'buried':\r\n        return '📦'\r\n      default:\r\n        return '❓'\r\n    }\r\n  }\r\n\r\n  const getStateLabel = () => {\r\n    switch (card.state) {\r\n      case 'new':\r\n        return 'New'\r\n      case 'learning':\r\n        return 'Learning'\r\n      case 'review':\r\n        return card.ivl < 21 ? 'Young' : 'Mature'\r\n      case 'relearning':\r\n        return 'Relearning'\r\n      case 'suspended':\r\n        return 'Suspended'\r\n      case 'buried':\r\n        return 'Buried'\r\n      default:\r\n        return 'Unknown'\r\n    }\r\n  }\r\n\r\n  const getAdditionalInfo = () => {\r\n    switch (card.state) {\r\n      case 'learning':\r\n      case 'relearning':\r\n        return `Step ${card.learningStep + 1}, ${card.left}min left`\r\n      case 'review':\r\n        if (daysOverdue > 0) {\r\n          return `${daysOverdue} days overdue`\r\n        }\r\n        return `Interval: ${card.ivl} days`\r\n      case 'new':\r\n        return 'Never studied'\r\n      default:\r\n        return ''\r\n    }\r\n  }\r\n\r\n  if (compact) {\r\n    return (\r\n      <div \r\n        className={`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${className}`}\r\n        style={{ \r\n          backgroundColor: `${stateColor}20`,\r\n          color: stateColor,\r\n          border: `1px solid ${stateColor}40`\r\n        }}\r\n      >\r\n        <span>{getStateIcon()}</span>\r\n        <span>{getStateLabel()}</span>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className={`bg-white rounded-lg border shadow-sm p-3 ${className}`}>\r\n      <div className=\"flex items-center gap-2 mb-2\">\r\n        <div \r\n          className=\"w-3 h-3 rounded-full\"\r\n          style={{ backgroundColor: stateColor }}\r\n        />\r\n        <div className=\"flex items-center gap-2\">\r\n          <span className=\"text-lg\">{getStateIcon()}</span>\r\n          <span className=\"font-medium text-gray-900\">{getStateLabel()}</span>\r\n        </div>\r\n      </div>\r\n\r\n      {showDescription && (\r\n        <p className=\"text-sm text-gray-600 mb-2\">{description}</p>\r\n      )}\r\n\r\n      <div className=\"space-y-1 text-xs text-gray-500\">\r\n        {getAdditionalInfo() && (\r\n          <div>{getAdditionalInfo()}</div>\r\n        )}\r\n        \r\n        {card.state === 'review' && (\r\n          <div className=\"flex justify-between\">\r\n            <span>Ease: {(card.factor / 10).toFixed(0)}%</span>\r\n            <span>Reviews: {card.reps}</span>\r\n          </div>\r\n        )}\r\n        \r\n        {card.lapses > 0 && (\r\n          <div className=\"text-red-500\">Lapses: {card.lapses}</div>\r\n        )}\r\n        \r\n        {nextReview && card.state !== 'learning' && card.state !== 'relearning' && (\r\n          <div>Next: {nextReview.toLocaleDateString()}</div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default CardStateIndicator","import { Card, ReviewCardType } from '../../../shared/types'\r\n\r\n/**\r\n * Local utility functions for card state management\r\n * This avoids build issues with importing CardStateUtils from shared types\r\n */\r\n\r\n/**\r\n * Determine if a review card is young (interval < 21 days) or mature (interval >= 21 days)\r\n */\r\nexport function getReviewCardType(card: Card): ReviewCardType {\r\n  if (card.state !== 'review') {\r\n    throw new Error('Card must be in review state to determine maturity')\r\n  }\r\n  return card.ivl < 21 ? 'young' : 'mature'\r\n}\r\n\r\n/**\r\n * Get human-readable card state description\r\n */\r\nexport function getCardStateDescription(card: Card): string {\r\n  switch (card.state) {\r\n    case 'new':\r\n      return 'New - Never studied before'\r\n    case 'learning':\r\n      return 'Learning - Recently seen, still being learned'\r\n    case 'review': {\r\n      const maturity = card.ivl < 21 ? 'Young' : 'Mature'\r\n      return `Review (${maturity}) - Finished learning, scheduled for review`\r\n    }\r\n    case 'relearning':\r\n      return 'Relearning - Failed in review, being relearned'\r\n    case 'suspended':\r\n      return 'Suspended - Manually suspended from study'\r\n    case 'buried':\r\n      return 'Buried - Hidden until next day'\r\n    default:\r\n      return 'Unknown state'\r\n  }\r\n}\r\n\r\n/**\r\n * Get card state color for UI display\r\n */\r\nexport function getCardStateColor(card: Card): string {\r\n  switch (card.state) {\r\n    case 'new':\r\n      return '#3b82f6' // Blue\r\n    case 'learning':\r\n      return '#f59e0b' // Amber\r\n    case 'review':\r\n      return card.ivl < 21 ? '#10b981' : '#059669' // Green (lighter for young, darker for mature)\r\n    case 'relearning':\r\n      return '#ef4444' // Red\r\n    case 'suspended':\r\n      return '#6b7280' // Gray\r\n    case 'buried':\r\n      return '#9ca3af' // Light gray\r\n    default:\r\n      return '#374151' // Dark gray\r\n  }\r\n}\r\n\r\n/**\r\n * Check if a card is due for study\r\n */\r\nexport function isCardDue(card: Card, currentDate: Date = new Date()): boolean {\r\n  const currentDay = Math.floor(currentDate.getTime() / (24 * 60 * 60 * 1000))\r\n  \r\n  switch (card.state) {\r\n    case 'new':\r\n      return true // New cards are always available (subject to daily limits)\r\n    case 'learning':\r\n    case 'relearning': {\r\n      // Learning cards use minutes, check if due time has passed\r\n      const dueTime = currentDate.getTime() + (card.left * 60 * 1000)\r\n      return dueTime <= currentDate.getTime()\r\n    }\r\n    case 'review':\r\n      return card.due <= currentDay\r\n    case 'suspended':\r\n    case 'buried':\r\n      return false // These cards are not available for study\r\n    default:\r\n      return false\r\n  }\r\n}\r\n\r\n/**\r\n * Get the next review date for a card\r\n */\r\nexport function getNextReviewDate(card: Card): Date | null {\r\n  switch (card.state) {\r\n    case 'new':\r\n      return null // New cards don't have a scheduled review\r\n    case 'learning':\r\n    case 'relearning':\r\n      // Learning cards are due in 'left' minutes\r\n      return new Date(Date.now() + card.left * 60 * 1000)\r\n    case 'review':\r\n      // Review cards use days since epoch\r\n      return new Date(card.due * 24 * 60 * 60 * 1000)\r\n    case 'suspended':\r\n    case 'buried':\r\n      return null // These cards have no scheduled review\r\n    default:\r\n      return null\r\n  }\r\n}\r\n\r\n/**\r\n * Calculate days overdue for a review card\r\n */\r\nexport function getDaysOverdue(card: Card, currentDate: Date = new Date()): number {\r\n  if (card.state !== 'review') {\r\n    return 0\r\n  }\r\n  \r\n  const currentDay = Math.floor(currentDate.getTime() / (24 * 60 * 60 * 1000))\r\n  return Math.max(0, currentDay - card.due)\r\n}\r\n\r\n/**\r\n * Get study priority for card ordering\r\n */\r\nexport function getStudyPriority(card: Card): number {\r\n  switch (card.state) {\r\n    case 'learning':\r\n    case 'relearning':\r\n      return 1 // Highest priority\r\n    case 'review':\r\n      return 2 // Medium priority\r\n    case 'new':\r\n      return 3 // Lower priority\r\n    case 'suspended':\r\n    case 'buried':\r\n      return 999 // Should not be studied\r\n    default:\r\n      return 999\r\n  }\r\n}","// Test function for systematic verification of stats logic\r\nexport const testStatsLogic = () => {\r\n  console.log('\\n🧪 TESTING STATS LOGIC - 10 CARD SIMULATION')\r\n  console.log('Pattern: Again, Hard, Again, Hard, etc.')\r\n  \r\n  let testStats = { total: 10, correct: 0, incorrect: 0 }\r\n  const pattern = ['again', 'hard']\r\n  \r\n  for (let i = 0; i < 10; i++) {\r\n    const difficulty = pattern[i % 2] as 'again' | 'hard'\r\n    const cardNum = i + 1\r\n    \r\n    console.log(`\\n--- Card ${cardNum} ---`)\r\n    console.log(`Answer: ${difficulty}`)\r\n    console.log(`Stats before:`, testStats)\r\n    \r\n    // Apply the same logic as in handleAnswer\r\n    const newStats = difficulty === 'again' \r\n      ? { ...testStats, incorrect: testStats.incorrect + 1 }\r\n      : { ...testStats, correct: testStats.correct + 1 }\r\n    \r\n    testStats = newStats\r\n    console.log(`Stats after:`, testStats)\r\n    \r\n    // Verify expected values - 'again' = incorrect, 'hard' = correct\r\n    const expectedIncorrect = Math.floor((cardNum + 1) / 2)\r\n    const expectedCorrect = Math.floor(cardNum / 2)\r\n    \r\n    const correctMatch = testStats.correct === expectedCorrect\r\n    const incorrectMatch = testStats.incorrect === expectedIncorrect\r\n    \r\n    console.log(`Expected: correct=${expectedCorrect}, incorrect=${expectedIncorrect}`)\r\n    console.log(`✅ Correct count: ${correctMatch ? 'PASS' : 'FAIL'}`)\r\n    console.log(`✅ Incorrect count: ${incorrectMatch ? 'PASS' : 'FAIL'}`)\r\n    \r\n    if (!correctMatch || !incorrectMatch) {\r\n      console.error(`❌ TEST FAILED at card ${cardNum}`)\r\n      return false\r\n    }\r\n  }\r\n  \r\n  console.log('\\n🎉 ALL TESTS PASSED!')\r\n  console.log(`Final stats: correct=${testStats.correct}, incorrect=${testStats.incorrect}`)\r\n  return true\r\n}\r\n\r\n// Run the test immediately when this module is loaded\r\nconsole.log('Running stats logic test...')\r\ntestStatsLogic()\r\n\r\n// Make test function available globally for console testing\r\nif (typeof window !== 'undefined') {\r\n  (window as Window & typeof globalThis & { testStatsLogic: typeof testStatsLogic }).testStatsLogic = testStatsLogic\r\n}","import { useState, useEffect, useMemo } from 'react'\nimport { flushSync } from 'react-dom'\nimport { useParams, useNavigate } from 'react-router-dom'\nimport { useDeckStore, useCurrentCard } from '../stores/deckStore'\nimport { useGamificationStore } from '../stores/gamificationStore'\nimport { EnhancedCard, ResponseLog } from '../types/enhancedTypes'\nimport { FSRS } from '../services/fsrsEngine'\nimport CardRenderer from '../components/study/CardRenderer'\nimport { useStudyKeyboardShortcuts } from '../hooks/useKeyboardShortcuts'\nimport { StudyShortcutsHelp } from '../components/study/KeyboardShortcutsHelp'\nimport { CardStateIndicator } from '../components/study/CardStateIndicator'\nimport '../utils/testStatsLogic'\n\nconst StudyPage = () => {\n  const { deckId } = useParams<{ deckId: string }>()\n  const navigate = useNavigate()\n  const {\n    getDeck,\n    getCards,\n    updateCard,\n    decks,\n    cards,\n    startStudySession,\n    updateStudySession,\n    clearStudySession,\n    currentStudySession,\n    getStudySession\n  } = useDeckStore()\n  \n  const { awardStudyXP } = useGamificationStore()\n  \n  // UI-specific state\n  const [showAnswer, setShowAnswer] = useState(false)\n  const [sessionComplete, setSessionComplete] = useState(false)\n  const [xpEarned, setXpEarned] = useState(0)\n  const [sessionInitialized, setSessionInitialized] = useState(false)\n  const [showShortcutsHelp, setShowShortcutsHelp] = useState(false)\n  const [currentCardIndex, setCurrentCardIndex] = useState(0)\n  const [stats, setStats] = useState({ total: 0, correct: 0, incorrect: 0 })\n\n  // Get the cards for the current study session\n  const studyCards = currentStudySession?.studyCards || []\n\n  const deck = deckId ? getDeck(deckId) : null\n\n  // Sync local stats with session stats from the store\n  useEffect(() => {\n    if (currentStudySession?.sessionStats) {\n      setStats(currentStudySession.sessionStats)\n    }\n  }, [currentStudySession?.sessionStats])\n\n  // Effect to initialize the study session\n  useEffect(() => {\n    if (deckId && !sessionInitialized) {\n      // If there is no active session for this deck, start a new one.\n      if (!currentStudySession || currentStudySession.deckId !== deckId) {\n        const allCards = getCards(deckId)\n        if (allCards.length > 0) {\n          console.log('Starting a new study session...');\n          const dueCards = allCards.filter(card => {\n            if (card.reviewCount === 0) return true // New cards\n            return new Date(card.nextReview) <= new Date() // Due cards\n          })\n          const MAX_CARDS_PER_SESSION = 20\n          const cardsToStudy = (dueCards.length > 0 ? dueCards : allCards).slice(0, MAX_CARDS_PER_SESSION)\n          startStudySession(deckId, cardsToStudy)\n        }\n      } else {\n        console.log('Restoring existing study session...');\n      }\n      setSessionInitialized(true)\n    }\n  }, [deckId, getCards, startStudySession, currentStudySession, sessionInitialized])\n\n  // Get the current card using the new on-demand selector\n  const currentCard = useCurrentCard()\n\n  // Memoize session stats to prevent re-renders\n  const sessionStats = useMemo(() => currentStudySession?.sessionStats, [currentStudySession])\n\n  // Keyboard shortcuts integration\n  useStudyKeyboardShortcuts({\n    onFlipCard: () => {\n      if (!showAnswer && currentCard) {\n        setShowAnswer(true)\n        console.log('[Keyboard] Flipped card to show answer')\n      }\n    },\n    onAnswerAgain: () => {\n      if (showAnswer && currentCard) {\n        console.log('[Keyboard] Answered: Again')\n        handleAnswer('again')\n      }\n    },\n    onAnswerHard: () => {\n      if (showAnswer && currentCard) {\n        console.log('[Keyboard] Answered: Hard')\n        handleAnswer('hard')\n      }\n    },\n    onAnswerGood: () => {\n      if (showAnswer && currentCard) {\n        console.log('[Keyboard] Answered: Good')\n        handleAnswer('good')\n      }\n    },\n    onAnswerEasy: () => {\n      if (showAnswer && currentCard) {\n        console.log('[Keyboard] Answered: Easy')\n        handleAnswer('easy')\n      }\n    },\n    onExitStudy: () => {\n      console.log('[Keyboard] Exiting study session')\n      goBackToDecks()\n    },\n    showAnswer,\n    enabled: !sessionComplete && currentCard !== undefined,\n    debugMode: true\n  })\n\n  const handleAnswer = async (difficulty: 'easy' | 'good' | 'hard' | 'again') => {\n    if (!currentCard) return\n\n    console.log(`\\n=== CARD ${currentCardIndex + 1} ANSWER ===`)\n    console.log(`Difficulty: ${difficulty}`)\n    console.log(`Current stats BEFORE update:`, stats)\n\n    // Calculate the new stats immediately\n    // In spaced repetition: \"again\" = incorrect, \"hard\"/\"good\"/\"easy\" = correct\n    const isIncorrect = difficulty === 'again'\n    const newStats = isIncorrect\n      ? { ...stats, incorrect: stats.incorrect + 1 }\n      : { ...stats, correct: stats.correct + 1 }\n\n    console.log(`Answer \"${difficulty}\" is ${isIncorrect ? 'INCORRECT' : 'CORRECT'}`)\n    console.log(`Calculated new stats:`, newStats)\n    console.log(`Expected: correct=${newStats.correct}, incorrect=${newStats.incorrect}`)\n\n    // Force immediate state updates using flushSync to prevent batching issues\n    flushSync(() => {\n      // Update stats first to ensure they're displayed correctly\n      setStats(newStats)\n      console.log(`Stats updated to:`, newStats)\n    })\n\n    // Then handle card navigation for fast transitions\n    const isLastCard = currentCardIndex >= studyCards.length - 1\n    const nextCardIndex = currentCardIndex + 1\n    \n    if (!isLastCard) {\n      flushSync(() => {\n        // Fast UI updates - no blocking operations\n        setCurrentCardIndex(nextCardIndex)\n        setShowAnswer(false)\n        console.log(`Card index: ${currentCardIndex} -> ${nextCardIndex}`)\n      })\n    }\n\n    // Async operations that don't block UI\n    const processCardUpdate = async () => {\n      // Update card based on spaced repetition algorithm\n      const now = new Date()\n      let newInterval = currentCard.intervalDays\n      let newEaseFactor = currentCard.easeFactor\n      const newReviewCount = currentCard.reviewCount + 1\n\n      // Simple SM-2 algorithm implementation\n      switch (difficulty) {\n        case 'again':\n          newInterval = 1\n          newEaseFactor = Math.max(1.3, currentCard.easeFactor - 0.2)\n          break\n        case 'hard':\n          // For new cards (intervalDays = 0), start with 1 day\n          if (currentCard.intervalDays === 0) {\n            newInterval = 1\n          } else {\n            newInterval = Math.max(1, Math.round(currentCard.intervalDays * 1.2))\n          }\n          newEaseFactor = Math.max(1.3, currentCard.easeFactor - 0.15)\n          break\n        case 'good':\n          // For new cards (intervalDays = 0), start with 1 day, then apply ease factor\n          if (currentCard.intervalDays === 0) {\n            newInterval = 1\n          } else {\n            newInterval = Math.round(currentCard.intervalDays * currentCard.easeFactor)\n          }\n          break\n        case 'easy':\n          // For new cards (intervalDays = 0), start with 4 days (easy boost)\n          if (currentCard.intervalDays === 0) {\n            newInterval = 4\n          } else {\n            newInterval = Math.round(currentCard.intervalDays * currentCard.easeFactor * 1.3)\n          }\n          newEaseFactor = currentCard.easeFactor + 0.15\n          break\n      }\n\n      // Calculate next review date\n      const nextReview = new Date(now.getTime() + newInterval * 24 * 60 * 60 * 1000)\n\n      // Update the card (async, non-blocking)\n      await updateCard(currentCard.id, {\n        intervalDays: newInterval,\n        easeFactor: newEaseFactor,\n        reviewCount: newReviewCount,\n        nextReview: nextReview.toISOString()\n      })\n\n      // Update session in store (async, non-blocking)\n      if (deckId && !isLastCard) {\n        console.log(`Store update - Stats being sent to store:`, newStats)\n        console.log(`Store update - Card index being sent:`, nextCardIndex)\n        updateStudySession(nextCardIndex, newStats)\n      }\n    }\n\n    // Handle session completion\n    if (isLastCard) {\n      setSessionComplete(true)\n      \n      // Award XP for completing the study session\n      const totalCardsStudied = stats.correct + stats.incorrect + 1 // +1 for current card\n      const correctAnswers = newStats.correct\n      \n      // Calculate XP earned (same formula as in gamificationStore)\n      const baseXP = totalCardsStudied // 1 XP per card studied\n      const bonusXP = correctAnswers // 1 XP per correct answer\n      const milestoneBonus = Math.floor(correctAnswers / 10) * 10 // 10 XP per 10 correct answers\n      const totalXPEarned = baseXP + bonusXP + milestoneBonus\n      \n      console.log(`🎓 Study session completed! Awarding XP for ${totalCardsStudied} cards studied, ${correctAnswers} correct answers`)\n      console.log(`🎉 XP Breakdown: ${baseXP} base + ${bonusXP} bonus + ${milestoneBonus} milestone = ${totalXPEarned} total`)\n      \n      setXpEarned(totalXPEarned)\n      awardStudyXP(totalCardsStudied, correctAnswers)\n    }\n\n    // Process card update asynchronously without blocking UI\n    processCardUpdate().catch(error => {\n      console.error('Error processing card update:', error)\n    })\n  }\n\n  const resetSession = () => {\n    setCurrentCardIndex(0)\n    setShowAnswer(false)\n    setSessionComplete(false)\n    setStats({ total: studyCards.length, correct: 0, incorrect: 0 })\n    setXpEarned(0)\n    \n    // Clear existing session and start fresh\n    if (deckId) {\n      clearStudySession()\n      if (studyCards.length > 0) {\n        startStudySession(deckId, studyCards)\n      }\n    }\n  }\n\n  const goBackToDecks = () => {\n    // Don't clear session when exiting study - preserve it for resuming later\n    navigate('/decks')\n  }\n\n  const clearSessionAndGoBack = () => {\n    // Clear session when user explicitly wants to start fresh next time\n    if (deckId) {\n      clearStudySession()\n    }\n    navigate('/decks')\n  }\n\n  // If no deckId is provided, find the deck with the earliest review date\n  useEffect(() => {\n    if (!deckId && decks.length > 0) {\n      // Find the deck with cards that have the earliest review date\n      let earliestDeck = null\n      let earliestDate = new Date('2099-12-31') // Far future date as default\n      \n      for (const deck of decks) {\n        const deckCards = cards[deck.id] || []\n        if (deckCards.length === 0) continue\n        \n        // Find cards that are due for review or new cards\n        const dueCards = deckCards.filter(card => {\n          if (card.reviewCount === 0) return true // New cards\n          return new Date(card.nextReview) <= new Date() // Due cards\n        })\n        \n        if (dueCards.length > 0) {\n          // Find the earliest review date in this deck\n          const deckEarliestDate = dueCards.reduce((earliest, card) => {\n            const cardDate = card.reviewCount === 0 ? new Date(card.createdAt) : new Date(card.nextReview)\n            return cardDate < earliest ? cardDate : earliest\n          }, new Date('2099-12-31'))\n          \n          if (deckEarliestDate < earliestDate) {\n            earliestDate = deckEarliestDate\n            earliestDeck = deck\n          }\n        }\n      }\n      \n      if (earliestDeck) {\n        // Redirect to the deck with the earliest review date\n        navigate(`/study/${earliestDeck.id}`, { replace: true })\n        return\n      }\n    }\n  }, [deckId, decks, cards, navigate])\n\n  // If no deckId is provided and we're still here, show loading or no decks message\n  if (!deckId) {\n    if (decks.length === 0) {\n      return (\n        <div className=\"max-w-4xl mx-auto text-center py-12\">\n          <div className=\"text-6xl mb-4\">📚</div>\n          <h1 className=\"text-2xl font-bold mb-4\">No Decks Available</h1>\n          <p className=\"text-gray-600 dark:text-gray-400 mb-6\">\n            You don't have any decks to study yet. Create your first deck to get started!\n          </p>\n          <button onClick={goBackToDecks} className=\"btn btn-primary\">\n            Go to My Decks\n          </button>\n        </div>\n      )\n    }\n    \n    // Show loading while finding the best deck\n    return (\n      <div className=\"max-w-4xl mx-auto text-center py-12\">\n        <div className=\"text-6xl mb-4\">🔍</div>\n        <h1 className=\"text-2xl font-bold mb-4\">Finding Your Next Study Session</h1>\n        <p className=\"text-gray-600 dark:text-gray-400 mb-6\">\n          Looking for the deck with the most urgent cards to review...\n        </p>\n      </div>\n    )\n  }\n\n  if (!deck || !studyCards) {\n    return (\n      <div className=\"max-w-4xl mx-auto text-center py-12\">\n        <div className=\"text-6xl mb-4\">❌</div>\n        <h1 className=\"text-2xl font-bold mb-4\">Deck Not Found</h1>\n        <p className=\"text-gray-600 dark:text-gray-400 mb-6\">\n          The deck you're trying to study doesn't exist.\n        </p>\n        <button onClick={goBackToDecks} className=\"btn btn-primary\">\n          Back to Decks\n        </button>\n      </div>\n    )\n  }\n\n  if (studyCards.length === 0) {\n    return (\n      <div className=\"max-w-4xl mx-auto text-center py-12\">\n        <div className=\"text-6xl mb-4\">📚</div>\n        <h1 className=\"text-2xl font-bold mb-4\">No Cards to Study</h1>\n        <p className=\"text-gray-600 dark:text-gray-400 mb-6\">\n          This deck doesn't have any cards to study right now.\n        </p>\n        <button onClick={goBackToDecks} className=\"btn btn-primary\">\n          Back to Decks\n        </button>\n      </div>\n    )\n  }\n\n  if (sessionComplete) {\n    const totalAnswered = stats.correct + stats.incorrect\n    const accuracy = totalAnswered > 0 ? Math.round((stats.correct / totalAnswered) * 100) : 0\n    \n    return (\n      <div className=\"max-w-4xl mx-auto text-center py-12\">\n        <div className=\"text-6xl mb-4\">🎉</div>\n        <h1 className=\"text-3xl font-bold mb-4\">Session Complete!</h1>\n        <p className=\"text-gray-600 dark:text-gray-400 mb-8\">\n          Great job studying <strong>{deck.title}</strong>\n        </p>\n        \n        <div className=\"card p-6 mb-8 max-w-md mx-auto\">\n          <h2 className=\"text-xl font-semibold mb-4\">Session Stats</h2>\n          <div className=\"space-y-2\">\n            <div className=\"flex justify-between\">\n              <span>Cards Studied:</span>\n              <span className=\"font-medium\">{totalAnswered}</span>\n            </div>\n            <div className=\"flex justify-between\">\n              <span>Correct:</span>\n              <span className=\"font-medium text-green-600\">{stats.correct}</span>\n            </div>\n            <div className=\"flex justify-between\">\n              <span>Incorrect:</span>\n              <span className=\"font-medium text-red-600\">{stats.incorrect}</span>\n            </div>\n            <div className=\"flex justify-between border-t pt-2\">\n              <span>Accuracy:</span>\n              <span className=\"font-medium\">{accuracy}%</span>\n            </div>\n            {xpEarned > 0 && (\n              <div className=\"flex justify-between border-t pt-2 bg-yellow-50 dark:bg-yellow-900/20 -mx-2 px-2 py-2 rounded\">\n                <span className=\"flex items-center gap-1\">\n                  <span>🎉</span>\n                  <span className=\"font-medium\">XP Earned:</span>\n                </span>\n                <span className=\"font-bold text-yellow-600 dark:text-yellow-400\">+{xpEarned} XP</span>\n              </div>\n            )}\n          </div>\n        </div>\n\n        <div className=\"flex flex-col gap-4 items-center\">\n          <div className=\"flex gap-4 justify-center\">\n            <button onClick={resetSession} className=\"btn btn-primary\">\n              Study Again\n            </button>\n            <button onClick={goBackToDecks} className=\"btn btn-secondary\">\n              Back to Decks\n            </button>\n          </div>\n          <button\n            onClick={clearSessionAndGoBack}\n            className=\"btn btn-outline btn-sm text-gray-500 hover:text-gray-700\"\n          >\n            Clear Progress & Start Fresh Next Time\n          </button>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"max-w-4xl mx-auto\">\n      {/* Header */}\n      <div className=\"text-center mb-8\">\n        <h1 className=\"text-3xl font-bold mb-2\">{deck.title}</h1>\n        <p className=\"text-gray-600 dark:text-gray-400 mb-2\">\n          Card {currentCardIndex + 1} of {studyCards.length}\n        </p>\n        \n        {/* Card State Indicator */}\n        {currentCard && (\n          <div className=\"flex justify-center mb-4\">\n            <CardStateIndicator\n              card={currentCard}\n              compact={true}\n              className=\"shadow-sm\"\n            />\n          </div>\n        )}\n        \n        {deckId && getStudySession(deckId) && currentCardIndex > 0 && (\n          <p className=\"text-sm text-blue-600 dark:text-blue-400 mb-4 flex items-center justify-center gap-2\">\n            <span>📍</span>\n            Resumed from where you left off\n          </p>\n        )}\n        <div className=\"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2\">\n          <div\n            className=\"bg-blue-600 h-2 rounded-full transition-all duration-300\"\n            style={{ width: `${((currentCardIndex + 1) / studyCards.length) * 100}%` }}\n          ></div>\n        </div>\n      </div>\n\n      {/* Flashcard */}\n      <div className=\"card p-8 mb-8 min-h-[300px] flex flex-col justify-center\">\n        {currentCard ? (\n          <>\n            <CardRenderer\n              card={currentCard}\n              showAnswer={showAnswer}\n            />\n\n            {!showAnswer ? (\n              <div className=\"text-center mt-6\">\n                <button\n                  onClick={() => setShowAnswer(true)}\n                  className=\"btn btn-primary btn-lg\"\n                >\n                  Show Answer\n                  <span className=\"ml-2 text-xs opacity-75\">(Space/Enter)</span>\n                </button>\n              </div>\n            ) : (\n              <div className=\"space-y-4 mt-6\">\n                <p className=\"text-gray-600 dark:text-gray-400 mb-6 text-center\">\n                  How well did you know this?\n                </p>\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\n                  <button\n                    onClick={() => handleAnswer('again')}\n                    className=\"btn bg-red-500 hover:bg-red-600 text-white py-3\"\n                  >\n                    <div className=\"text-sm font-medium\">Again</div>\n                    <div className=\"text-xs opacity-80\">&lt; 1 day</div>\n                    <div className=\"text-xs opacity-60 mt-1\">1 or A</div>\n                  </button>\n                  <button\n                    onClick={() => handleAnswer('hard')}\n                    className=\"btn bg-orange-500 hover:bg-orange-600 text-white py-3\"\n                  >\n                    <div className=\"text-sm font-medium\">Hard</div>\n                    <div className=\"text-xs opacity-80\">1-3 days</div>\n                    <div className=\"text-xs opacity-60 mt-1\">2 or H</div>\n                  </button>\n                  <button\n                    onClick={() => handleAnswer('good')}\n                    className=\"btn bg-green-500 hover:bg-green-600 text-white py-3\"\n                  >\n                    <div className=\"text-sm font-medium\">Good</div>\n                    <div className=\"text-xs opacity-80\">3-7 days</div>\n                    <div className=\"text-xs opacity-60 mt-1\">3 or G</div>\n                  </button>\n                  <button\n                    onClick={() => handleAnswer('easy')}\n                    className=\"btn bg-blue-500 hover:bg-blue-600 text-white py-3\"\n                  >\n                    <div className=\"text-sm font-medium\">Easy</div>\n                    <div className=\"text-xs opacity-80\">1+ weeks</div>\n                    <div className=\"text-xs opacity-60 mt-1\">4 or E</div>\n                  </button>\n                </div>\n              </div>\n            )}\n          </>\n        ) : (\n          <div className=\"text-center\">\n            <p className=\"text-gray-500\">Loading card...</p>\n          </div>\n        )}\n      </div>\n\n      {/* Keyboard Shortcuts Help */}\n      <StudyShortcutsHelp\n        showAnswer={showAnswer}\n        compact={true}\n        className=\"mb-4\"\n      />\n\n      {/* Session Stats */}\n      <div className=\"flex justify-between items-center text-sm text-gray-600 dark:text-gray-400\">\n        <div>\n          Correct: <span className=\"text-green-600 font-medium\">{stats.correct}</span> |\n          Incorrect: <span className=\"text-red-600 font-medium\">{stats.incorrect}</span>\n        </div>\n        <div className=\"flex gap-2\">\n          <button\n            onClick={() => setShowShortcutsHelp(!showShortcutsHelp)}\n            className=\"btn btn-outline btn-sm\"\n            title=\"Toggle keyboard shortcuts help\"\n          >\n            ⌨️\n          </button>\n          <button\n            onClick={goBackToDecks}\n            className=\"btn btn-secondary btn-sm\"\n          >\n            Exit Study\n          </button>\n        </div>\n      </div>\n\n      {/* Detailed Shortcuts Help Modal */}\n      {showShortcutsHelp && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4\">\n            <div className=\"flex justify-between items-center mb-4\">\n              <h3 className=\"text-lg font-semibold\">Keyboard Shortcuts</h3>\n              <button\n                onClick={() => setShowShortcutsHelp(false)}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200\"\n              >\n                ✕\n              </button>\n            </div>\n            <StudyShortcutsHelp\n              showAnswer={showAnswer}\n              compact={false}\n            />\n            <div className=\"mt-4 text-xs text-gray-500 dark:text-gray-400\">\n              <p>💡 <strong>Tip:</strong> Use Space or Enter to flip cards, then 1-4 or A/H/G/E to answer!</p>\n              <p>Press Esc or Q to exit the study session anytime.</p>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n\nexport default StudyPage","import { useState } from 'react'\r\nimport { useDeckStore } from '../../stores/deckStore'\r\nimport { Card } from '../../../../shared/types'\r\nimport { createNewCard } from '../../utils/cardDefaults'\r\n\r\ninterface CardManagerProps {\r\n  deckId: string\r\n  onClose: () => void\r\n}\r\n\r\nconst CardManager = ({ deckId, onClose }: CardManagerProps) => {\r\n  const { getCards, addCard, updateCard, deleteCard, getDeck } = useDeckStore()\r\n  const [showAddCard, setShowAddCard] = useState(false)\r\n  const [editingCard, setEditingCard] = useState<Card | null>(null)\r\n  const [frontContent, setFrontContent] = useState('')\r\n  const [backContent, setBackContent] = useState('')\r\n\r\n  const deck = getDeck(deckId)\r\n  const cards = getCards(deckId)\r\n\r\n  const handleAddCard = async (e: React.FormEvent) => {\r\n    e.preventDefault()\r\n    if (!frontContent.trim() || !backContent.trim()) return\r\n\r\n    try {\r\n      await addCard(deckId, createNewCard(\r\n        frontContent.trim(),\r\n        backContent.trim(),\r\n        { type: 'basic' },\r\n        []\r\n      ))\r\n      setFrontContent('')\r\n      setBackContent('')\r\n      setShowAddCard(false)\r\n    } catch (error) {\r\n      console.error('Failed to add card:', error)\r\n    }\r\n  }\r\n\r\n  const handleEditCard = async (e: React.FormEvent) => {\r\n    e.preventDefault()\r\n    if (!editingCard || !frontContent.trim() || !backContent.trim()) return\r\n\r\n    try {\r\n      await updateCard(editingCard.id, {\r\n        frontContent: frontContent.trim(),\r\n        backContent: backContent.trim()\r\n      })\r\n      setEditingCard(null)\r\n      setFrontContent('')\r\n      setBackContent('')\r\n    } catch (error) {\r\n      console.error('Failed to update card:', error)\r\n    }\r\n  }\r\n\r\n  const handleDeleteCard = async (cardId: string) => {\r\n    if (confirm('Are you sure you want to delete this card?')) {\r\n      try {\r\n        await deleteCard(cardId)\r\n      } catch (error) {\r\n        console.error('Failed to delete card:', error)\r\n      }\r\n    }\r\n  }\r\n\r\n  const startEdit = (card: Card) => {\r\n    setEditingCard(card)\r\n    setFrontContent(card.frontContent)\r\n    setBackContent(card.backContent)\r\n    setShowAddCard(false)\r\n  }\r\n\r\n  const cancelEdit = () => {\r\n    setEditingCard(null)\r\n    setFrontContent('')\r\n    setBackContent('')\r\n    setShowAddCard(false)\r\n  }\r\n\r\n  if (!deck) {\r\n    return (\r\n      <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\r\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg p-6\">\r\n          <p className=\"text-red-600\">Deck not found</p>\r\n          <button onClick={onClose} className=\"btn btn-secondary mt-4\">Close</button>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\r\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg w-full max-w-4xl max-h-[90vh] flex flex-col\">\r\n        {/* Header */}\r\n        <div className=\"flex justify-between items-center p-6 border-b border-gray-200 dark:border-gray-700\">\r\n          <div>\r\n            <h2 className=\"text-2xl font-semibold text-gray-900 dark:text-white\">{deck.title}</h2>\r\n            <p className=\"text-gray-600 dark:text-gray-400\">{cards.length} cards</p>\r\n          </div>\r\n          <div className=\"flex gap-2\">\r\n            <button\r\n              onClick={() => setShowAddCard(true)}\r\n              className=\"btn btn-primary\"\r\n            >\r\n              <svg className=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 4v16m8-8H4\" />\r\n              </svg>\r\n              Add Card\r\n            </button>\r\n            <button\r\n              onClick={onClose}\r\n              className=\"btn btn-secondary\"\r\n            >\r\n              Close\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Add/Edit Card Form */}\r\n        {(showAddCard || editingCard) && (\r\n          <div className=\"p-6 border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700\">\r\n            <h3 className=\"text-lg font-medium mb-4 text-gray-900 dark:text-white\">\r\n              {editingCard ? 'Edit Card' : 'Add New Card'}\r\n            </h3>\r\n            <form onSubmit={editingCard ? handleEditCard : handleAddCard} className=\"space-y-4\">\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                    Front\r\n                  </label>\r\n                  <textarea\r\n                    value={frontContent}\r\n                    onChange={(e) => setFrontContent(e.target.value)}\r\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-600 dark:border-gray-500 dark:text-white\"\r\n                    rows={3}\r\n                    placeholder=\"Enter the question or front side...\"\r\n                    required\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                    Back\r\n                  </label>\r\n                  <textarea\r\n                    value={backContent}\r\n                    onChange={(e) => setBackContent(e.target.value)}\r\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-600 dark:border-gray-500 dark:text-white\"\r\n                    rows={3}\r\n                    placeholder=\"Enter the answer or back side...\"\r\n                    required\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div className=\"flex gap-2\">\r\n                <button\r\n                  type=\"submit\"\r\n                  className=\"btn btn-primary\"\r\n                >\r\n                  {editingCard ? 'Update Card' : 'Add Card'}\r\n                </button>\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={cancelEdit}\r\n                  className=\"btn btn-secondary\"\r\n                >\r\n                  Cancel\r\n                </button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        )}\r\n\r\n        {/* Cards List */}\r\n        <div className=\"flex-1 overflow-y-auto p-6\">\r\n          {cards.length === 0 ? (\r\n            <div className=\"text-center py-12\">\r\n              <div className=\"text-4xl mb-4\">📝</div>\r\n              <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-2\">No cards yet</h3>\r\n              <p className=\"text-gray-600 dark:text-gray-400 mb-4\">\r\n                Add your first card to start studying\r\n              </p>\r\n              <button\r\n                onClick={() => setShowAddCard(true)}\r\n                className=\"btn btn-primary\"\r\n              >\r\n                Add First Card\r\n              </button>\r\n            </div>\r\n          ) : (\r\n            <div className=\"space-y-4\">\r\n              {cards.map((card, index) => (\r\n                <div\r\n                  key={card.id}\r\n                  className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:shadow-md transition-shadow\"\r\n                >\r\n                  <div className=\"flex justify-between items-start mb-3\">\r\n                    <span className=\"text-sm text-gray-500 dark:text-gray-400\">Card #{index + 1}</span>\r\n                    <div className=\"flex gap-1\">\r\n                      <button\r\n                        onClick={() => startEdit(card)}\r\n                        className=\"p-1 text-gray-400 hover:text-blue-500 transition-colors\"\r\n                        title=\"Edit card\"\r\n                      >\r\n                        <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\" />\r\n                        </svg>\r\n                      </button>\r\n                      <button\r\n                        onClick={() => handleDeleteCard(card.id)}\r\n                        className=\"p-1 text-gray-400 hover:text-red-500 transition-colors\"\r\n                        title=\"Delete card\"\r\n                      >\r\n                        <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\r\n                        </svg>\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                    <div>\r\n                      <div className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Front</div>\r\n                      <div className=\"p-3 bg-gray-50 dark:bg-gray-600 rounded border min-h-[60px] text-gray-900 dark:text-white\">\r\n                        {card.frontContent}\r\n                      </div>\r\n                    </div>\r\n                    <div>\r\n                      <div className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Back</div>\r\n                      <div className=\"p-3 bg-gray-50 dark:bg-gray-600 rounded border min-h-[60px] text-gray-900 dark:text-white\">\r\n                        {card.backContent}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Card Stats */}\r\n                  <div className=\"mt-3 pt-3 border-t border-gray-200 dark:border-gray-600\">\r\n                    <div className=\"flex justify-between text-xs text-gray-500 dark:text-gray-400\">\r\n                      <span>Reviews: {card.reviewCount}</span>\r\n                      <span>Ease: {card.easeFactor.toFixed(1)}</span>\r\n                      <span>Interval: {card.intervalDays} days</span>\r\n                      {card.reviewCount > 0 && (\r\n                        <span>Next: {new Date(card.nextReview).toLocaleDateString()}</span>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default CardManager","import React from 'react'\r\n\r\ninterface ProgressBarProps {\r\n  progress: number // 0-100\r\n  label?: string\r\n  showPercentage?: boolean\r\n  className?: string\r\n}\r\n\r\nconst ProgressBar: React.FC<ProgressBarProps> = ({\r\n  progress,\r\n  label,\r\n  showPercentage = true,\r\n  className = ''\r\n}) => {\r\n  const clampedProgress = Math.min(Math.max(progress, 0), 100)\r\n\r\n  return (\r\n    <div className={`w-full ${className}`}>\r\n      {label && (\r\n        <div className=\"flex justify-between items-center mb-2\">\r\n          <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n            {label}\r\n          </span>\r\n          {showPercentage && (\r\n            <span className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n              {Math.round(clampedProgress)}%\r\n            </span>\r\n          )}\r\n        </div>\r\n      )}\r\n      <div className=\"w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700\">\r\n        <div\r\n          className=\"bg-blue-600 h-2.5 rounded-full transition-all duration-300 ease-out\"\r\n          style={{ width: `${clampedProgress}%` }}\r\n        />\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default ProgressBar","import { Card, SvgMapCardOptions, CardType } from '../../../shared/types';\r\nimport { createSvgMapCard } from './cardDefaults';\r\n\r\n// Extract country data from Europe SVG\r\nexport const europeCountries = [\r\n  { id: 'AL', name: 'Albania' },\r\n  { id: 'AD', name: 'Andorra' },\r\n  { id: 'AM', name: 'Armenia' },\r\n  { id: 'AT', name: 'Austria' },\r\n  { id: 'BE', name: 'Belgium' },\r\n  { id: 'BG', name: 'Bulgaria' },\r\n  { id: 'BA', name: 'Bosnia and Herzegovina' },\r\n  { id: 'BY', name: 'Belarus' },\r\n  { id: 'CH', name: 'Switzerland' },\r\n  { id: 'CZ', name: 'Czech Republic' },\r\n  { id: 'DE', name: 'Germany' },\r\n  { id: 'DK', name: 'Denmark' },\r\n  { id: 'EE', name: 'Estonia' },\r\n  { id: 'FI', name: 'Finland' },\r\n  { id: 'GB', name: 'United Kingdom' },\r\n  { id: 'GE', name: 'Georgia' },\r\n  { id: 'GR', name: 'Greece' },\r\n  { id: 'HR', name: 'Croatia' },\r\n  { id: 'HU', name: 'Hungary' },\r\n  { id: 'IE', name: 'Ireland' },\r\n  { id: 'IS', name: 'Iceland' },\r\n  { id: 'IT', name: 'Italy' },\r\n  { id: 'LI', name: 'Liechtenstein' },\r\n  { id: 'LT', name: 'Lithuania' },\r\n  { id: 'LU', name: 'Luxembourg' },\r\n  { id: 'LV', name: 'Latvia' },\r\n  { id: 'MD', name: 'Moldova' },\r\n  { id: 'MK', name: 'Macedonia' },\r\n  { id: 'ME', name: 'Montenegro' },\r\n  { id: 'NO', name: 'Norway' },\r\n  { id: 'PL', name: 'Poland' },\r\n  { id: 'PT', name: 'Portugal' },\r\n  { id: 'RO', name: 'Romania' },\r\n  { id: 'RS', name: 'Serbia' },\r\n  { id: 'SK', name: 'Slovakia' },\r\n  { id: 'SI', name: 'Slovenia' },\r\n  { id: 'SE', name: 'Sweden' },\r\n  { id: 'TR', name: 'Turkey' },\r\n  { id: 'UA', name: 'Ukraine' },\r\n  { id: 'XK', name: 'Kosovo' },\r\n  { id: 'NL', name: 'Netherlands' },\r\n  { id: 'ES', name: 'Spain' },\r\n  { id: 'FR', name: 'France' },\r\n  { id: 'CY', name: 'Cyprus' }\r\n];\r\n\r\n// World countries data - only includes countries that actually exist in world.svg\r\nexport const worldCountries = [\r\n  { id: 'AL', name: 'Albania' },\r\n  { id: 'DZ', name: 'Algeria' },\r\n  { id: 'AM', name: 'Armenia' },\r\n  { id: 'AT', name: 'Austria' },\r\n  { id: 'AE', name: 'United Arab Emirates' },\r\n  { id: 'BD', name: 'Bangladesh' },\r\n  { id: 'BE', name: 'Belgium' },\r\n  { id: 'BJ', name: 'Benin' },\r\n  { id: 'BF', name: 'Burkina Faso' },\r\n  { id: 'BG', name: 'Bulgaria' },\r\n  { id: 'BI', name: 'Burundi' },\r\n  { id: 'BN', name: 'Brunei' },\r\n  { id: 'BT', name: 'Bhutan' },\r\n  { id: 'BY', name: 'Belarus' },\r\n  { id: 'BZ', name: 'Belize' },\r\n  { id: 'BO', name: 'Bolivia' },\r\n  { id: 'BR', name: 'Brazil' },\r\n  { id: 'BW', name: 'Botswana' },\r\n  { id: 'BA', name: 'Bosnia and Herzegovina' },\r\n  { id: 'BH', name: 'Bahrain' },\r\n  { id: 'CA', name: 'Canada' },\r\n  { id: 'CH', name: 'Switzerland' },\r\n  { id: 'CL', name: 'Chile' },\r\n  { id: 'CN', name: 'China' },\r\n  { id: 'CI', name: 'Côte d\\'Ivoire' },\r\n  { id: 'CM', name: 'Cameroon' },\r\n  { id: 'CG', name: 'Congo' },\r\n  { id: 'CO', name: 'Colombia' },\r\n  { id: 'CR', name: 'Costa Rica' },\r\n  { id: 'CU', name: 'Cuba' },\r\n  { id: 'CZ', name: 'Czech Republic' },\r\n  { id: 'DE', name: 'Germany' },\r\n  { id: 'DJ', name: 'Djibouti' },\r\n  { id: 'DK', name: 'Denmark' },\r\n  { id: 'DO', name: 'Dominican Republic' },\r\n  { id: 'EC', name: 'Ecuador' },\r\n  { id: 'EG', name: 'Egypt' },\r\n  { id: 'ER', name: 'Eritrea' },\r\n  { id: 'EE', name: 'Estonia' },\r\n  { id: 'ET', name: 'Ethiopia' },\r\n  { id: 'FI', name: 'Finland' },\r\n  { id: 'FR', name: 'France' },\r\n  { id: 'GA', name: 'Gabon' },\r\n  { id: 'GB', name: 'United Kingdom' },\r\n  { id: 'GE', name: 'Georgia' },\r\n  { id: 'GH', name: 'Ghana' },\r\n  { id: 'GL', name: 'Greenland' },\r\n  { id: 'GM', name: 'Gambia' },\r\n  { id: 'GN', name: 'Guinea' },\r\n  { id: 'GW', name: 'Guinea-Bissau' },\r\n  { id: 'GQ', name: 'Equatorial Guinea' },\r\n  { id: 'GR', name: 'Greece' },\r\n  { id: 'GT', name: 'Guatemala' },\r\n  { id: 'GY', name: 'Guyana' },\r\n  { id: 'HN', name: 'Honduras' },\r\n  { id: 'HR', name: 'Croatia' },\r\n  { id: 'HT', name: 'Haiti' },\r\n  { id: 'HU', name: 'Hungary' },\r\n  { id: 'ID', name: 'Indonesia' },\r\n  { id: 'IN', name: 'India' },\r\n  { id: 'IE', name: 'Ireland' },\r\n  { id: 'IR', name: 'Iran' },\r\n  { id: 'IQ', name: 'Iraq' },\r\n  { id: 'IS', name: 'Iceland' },\r\n  { id: 'IL', name: 'Israel' },\r\n  { id: 'IT', name: 'Italy' },\r\n  { id: 'JM', name: 'Jamaica' },\r\n  { id: 'JO', name: 'Jordan' },\r\n  { id: 'JP', name: 'Japan' },\r\n  { id: 'KZ', name: 'Kazakhstan' },\r\n  { id: 'KE', name: 'Kenya' },\r\n  { id: 'KG', name: 'Kyrgyzstan' },\r\n  { id: 'KH', name: 'Cambodia' },\r\n  { id: 'KP', name: 'North Korea' },\r\n  { id: 'KR', name: 'South Korea' },\r\n  { id: 'KW', name: 'Kuwait' },\r\n  { id: 'LA', name: 'Laos' },\r\n  { id: 'LB', name: 'Lebanon' },\r\n  { id: 'LR', name: 'Liberia' },\r\n  { id: 'LY', name: 'Libya' },\r\n  { id: 'LK', name: 'Sri Lanka' },\r\n  { id: 'LS', name: 'Lesotho' },\r\n  { id: 'LT', name: 'Lithuania' },\r\n  { id: 'LU', name: 'Luxembourg' },\r\n  { id: 'LV', name: 'Latvia' },\r\n  { id: 'MA', name: 'Morocco' },\r\n  { id: 'MD', name: 'Moldova' },\r\n  { id: 'MG', name: 'Madagascar' },\r\n  { id: 'MX', name: 'Mexico' },\r\n  { id: 'MK', name: 'North Macedonia' },\r\n  { id: 'ML', name: 'Mali' },\r\n  { id: 'MM', name: 'Myanmar' },\r\n  { id: 'ME', name: 'Montenegro' },\r\n  { id: 'MN', name: 'Mongolia' },\r\n  { id: 'MZ', name: 'Mozambique' },\r\n  { id: 'MR', name: 'Mauritania' },\r\n  { id: 'MW', name: 'Malawi' },\r\n  { id: 'MY', name: 'Malaysia' },\r\n  { id: 'NA', name: 'Namibia' },\r\n  { id: 'NE', name: 'Niger' },\r\n  { id: 'NG', name: 'Nigeria' },\r\n  { id: 'NI', name: 'Nicaragua' },\r\n  { id: 'NL', name: 'Netherlands' },\r\n  { id: 'NO', name: 'Norway' },\r\n  { id: 'NP', name: 'Nepal' },\r\n  { id: 'NZ', name: 'New Zealand' },\r\n  { id: 'OM', name: 'Oman' },\r\n  { id: 'PA', name: 'Panama' },\r\n  { id: 'PE', name: 'Peru' },\r\n  { id: 'PH', name: 'Philippines' },\r\n  { id: 'PK', name: 'Pakistan' },\r\n  { id: 'PL', name: 'Poland' },\r\n  { id: 'PT', name: 'Portugal' },\r\n  { id: 'PY', name: 'Paraguay' },\r\n  { id: 'PS', name: 'Palestine' },\r\n  { id: 'QA', name: 'Qatar' },\r\n  { id: 'RO', name: 'Romania' },\r\n  { id: 'RU', name: 'Russia' },\r\n  { id: 'RW', name: 'Rwanda' },\r\n  { id: 'EH', name: 'Western Sahara' },\r\n  { id: 'SA', name: 'Saudi Arabia' },\r\n  { id: 'SD', name: 'Sudan' },\r\n  { id: 'SS', name: 'South Sudan' },\r\n  { id: 'SN', name: 'Senegal' },\r\n  { id: 'SL', name: 'Sierra Leone' },\r\n  { id: 'SV', name: 'El Salvador' },\r\n  { id: 'RS', name: 'Serbia' },\r\n  { id: 'SR', name: 'Suriname' },\r\n  { id: 'SK', name: 'Slovakia' },\r\n  { id: 'SI', name: 'Slovenia' },\r\n  { id: 'SE', name: 'Sweden' },\r\n  { id: 'SZ', name: 'Eswatini' },\r\n  { id: 'SY', name: 'Syria' },\r\n  { id: 'TD', name: 'Chad' },\r\n  { id: 'TG', name: 'Togo' },\r\n  { id: 'TH', name: 'Thailand' },\r\n  { id: 'TJ', name: 'Tajikistan' },\r\n  { id: 'TM', name: 'Turkmenistan' },\r\n  { id: 'TL', name: 'Timor-Leste' },\r\n  { id: 'TN', name: 'Tunisia' },\r\n  { id: 'TR', name: 'Turkey' },\r\n  { id: 'TW', name: 'Taiwan' },\r\n  { id: 'TZ', name: 'Tanzania' },\r\n  { id: 'UG', name: 'Uganda' },\r\n  { id: 'UA', name: 'Ukraine' },\r\n  { id: 'UY', name: 'Uruguay' },\r\n  { id: 'US', name: 'United States' },\r\n  { id: 'UZ', name: 'Uzbekistan' },\r\n  { id: 'VE', name: 'Venezuela' },\r\n  { id: 'VN', name: 'Vietnam' },\r\n  { id: 'YE', name: 'Yemen' },\r\n  { id: 'ZA', name: 'South Africa' },\r\n  { id: 'ZM', name: 'Zambia' },\r\n  { id: 'ZW', name: 'Zimbabwe' },\r\n  { id: 'SO', name: 'Somalia' },\r\n  { id: 'XK', name: 'Kosovo' },\r\n  { id: 'ES', name: 'Spain' }\r\n];\r\n\r\n// Africa countries data\r\nexport const africaCountries = [\r\n  { id: 'DZ', name: 'Algeria' },\r\n  { id: 'AO', name: 'Angola' },\r\n  { id: 'BJ', name: 'Benin' },\r\n  { id: 'BW', name: 'Botswana' },\r\n  { id: 'BF', name: 'Burkina Faso' },\r\n  { id: 'BI', name: 'Burundi' },\r\n  { id: 'CV', name: 'Cape Verde' },\r\n  { id: 'CM', name: 'Cameroon' },\r\n  { id: 'CF', name: 'Central African Republic' },\r\n  { id: 'TD', name: 'Chad' },\r\n  { id: 'KM', name: 'Comoros' },\r\n  { id: 'CG', name: 'Congo' },\r\n  { id: 'CD', name: 'Democratic Republic of the Congo' },\r\n  { id: 'CI', name: 'Côte d\\'Ivoire' },\r\n  { id: 'DJ', name: 'Djibouti' },\r\n  { id: 'EG', name: 'Egypt' },\r\n  { id: 'GQ', name: 'Equatorial Guinea' },\r\n  { id: 'ER', name: 'Eritrea' },\r\n  { id: 'ET', name: 'Ethiopia' },\r\n  { id: 'GA', name: 'Gabon' },\r\n  { id: 'GM', name: 'Gambia' },\r\n  { id: 'GH', name: 'Ghana' },\r\n  { id: 'GN', name: 'Guinea' },\r\n  { id: 'GW', name: 'Guinea-Bissau' },\r\n  { id: 'KE', name: 'Kenya' },\r\n  { id: 'LS', name: 'Lesotho' },\r\n  { id: 'LR', name: 'Liberia' },\r\n  { id: 'LY', name: 'Libya' },\r\n  { id: 'MG', name: 'Madagascar' },\r\n  { id: 'MW', name: 'Malawi' },\r\n  { id: 'ML', name: 'Mali' },\r\n  { id: 'MR', name: 'Mauritania' },\r\n  { id: 'MU', name: 'Mauritius' },\r\n  { id: 'MA', name: 'Morocco' },\r\n  { id: 'MZ', name: 'Mozambique' },\r\n  { id: 'NA', name: 'Namibia' },\r\n  { id: 'NE', name: 'Niger' },\r\n  { id: 'NG', name: 'Nigeria' },\r\n  { id: 'RW', name: 'Rwanda' },\r\n  { id: 'ST', name: 'São Tomé and Príncipe' },\r\n  { id: 'SN', name: 'Senegal' },\r\n  { id: 'SC', name: 'Seychelles' },\r\n  { id: 'SL', name: 'Sierra Leone' },\r\n  { id: 'SO', name: 'Somalia' },\r\n  { id: 'ZA', name: 'South Africa' },\r\n  { id: 'SS', name: 'South Sudan' },\r\n  { id: 'SD', name: 'Sudan' },\r\n  { id: 'SZ', name: 'Eswatini' },\r\n  { id: 'TZ', name: 'Tanzania' },\r\n  { id: 'TG', name: 'Togo' },\r\n  { id: 'TN', name: 'Tunisia' },\r\n  { id: 'UG', name: 'Uganda' },\r\n  { id: 'ZM', name: 'Zambia' },\r\n  { id: 'ZW', name: 'Zimbabwe' }\r\n];\r\n\r\n// North America countries data\r\nexport const northAmericaCountries = [\r\n  { id: 'AG', name: 'Antigua and Barbuda' },\r\n  { id: 'BS', name: 'Bahamas' },\r\n  { id: 'BB', name: 'Barbados' },\r\n  { id: 'BZ', name: 'Belize' },\r\n  { id: 'CA', name: 'Canada' },\r\n  { id: 'CR', name: 'Costa Rica' },\r\n  { id: 'CU', name: 'Cuba' },\r\n  { id: 'DM', name: 'Dominica' },\r\n  { id: 'DO', name: 'Dominican Republic' },\r\n  { id: 'SV', name: 'El Salvador' },\r\n  { id: 'GD', name: 'Grenada' },\r\n  { id: 'GT', name: 'Guatemala' },\r\n  { id: 'HT', name: 'Haiti' },\r\n  { id: 'HN', name: 'Honduras' },\r\n  { id: 'JM', name: 'Jamaica' },\r\n  { id: 'MX', name: 'Mexico' },\r\n  { id: 'NI', name: 'Nicaragua' },\r\n  { id: 'PA', name: 'Panama' },\r\n  { id: 'KN', name: 'Saint Kitts and Nevis' },\r\n  { id: 'LC', name: 'Saint Lucia' },\r\n  { id: 'VC', name: 'Saint Vincent and the Grenadines' },\r\n  { id: 'TT', name: 'Trinidad and Tobago' },\r\n  { id: 'US', name: 'United States' }\r\n];\r\n\r\n// Individual country maps (these would be regions/states/provinces within the country)\r\nexport const finlandRegions = [\r\n  { id: 'FI-01', name: 'Åland' },\r\n  { id: 'FI-02', name: 'South Karelia' },\r\n  { id: 'FI-03', name: 'Southern Ostrobothnia' },\r\n  { id: 'FI-04', name: 'Southern Savonia' },\r\n  { id: 'FI-05', name: 'Kainuu' },\r\n  { id: 'FI-06', name: 'Tavastia Proper' },\r\n  { id: 'FI-07', name: 'Central Ostrobothnia' },\r\n  { id: 'FI-08', name: 'Central Finland' },\r\n  { id: 'FI-09', name: 'Kymenlaakso' },\r\n  { id: 'FI-10', name: 'Lapland' },\r\n  { id: 'FI-11', name: 'Pirkanmaa' },\r\n  { id: 'FI-12', name: 'Ostrobothnia' },\r\n  { id: 'FI-13', name: 'North Karelia' },\r\n  { id: 'FI-14', name: 'Northern Ostrobothnia' },\r\n  { id: 'FI-15', name: 'Northern Savonia' },\r\n  { id: 'FI-16', name: 'Päijät-Häme' },\r\n  { id: 'FI-17', name: 'Satakunta' },\r\n  { id: 'FI-18', name: 'Uusimaa' },\r\n  { id: 'FI-19', name: 'Southwest Finland' }\r\n];\r\n\r\nexport const franceRegions = [\r\n  { id: 'FR-ARA', name: 'Auvergne-Rhône-Alpes' },\r\n  { id: 'FR-BFC', name: 'Bourgogne-Franche-Comté' },\r\n  { id: 'FR-BRE', name: 'Brittany' },\r\n  { id: 'FR-CVL', name: 'Centre-Val de Loire' },\r\n  { id: 'FR-COR', name: 'Corsica' },\r\n  { id: 'FR-GES', name: 'Grand Est' },\r\n  { id: 'FR-HDF', name: 'Hauts-de-France' },\r\n  { id: 'FR-IDF', name: 'Île-de-France' },\r\n  { id: 'FR-NOR', name: 'Normandy' },\r\n  { id: 'FR-NAQ', name: 'Nouvelle-Aquitaine' },\r\n  { id: 'FR-OCC', name: 'Occitania' },\r\n  { id: 'FR-PDL', name: 'Pays de la Loire' },\r\n  { id: 'FR-PAC', name: 'Provence-Alpes-Côte d\\'Azur' }\r\n];\r\n\r\nexport const ukRegions = [\r\n  { id: 'GB-ENG', name: 'England' },\r\n  { id: 'GB-SCT', name: 'Scotland' },\r\n  { id: 'GB-WLS', name: 'Wales' },\r\n  { id: 'GB-NIR', name: 'Northern Ireland' }\r\n];\r\n\r\nexport const norwayRegions = [\r\n  { id: 'NO-03', name: 'Oslo' },\r\n  { id: 'NO-11', name: 'Rogaland' },\r\n  { id: 'NO-15', name: 'Møre og Romsdal' },\r\n  { id: 'NO-18', name: 'Nordland' },\r\n  { id: 'NO-30', name: 'Viken' },\r\n  { id: 'NO-34', name: 'Innlandet' },\r\n  { id: 'NO-38', name: 'Vestfold og Telemark' },\r\n  { id: 'NO-42', name: 'Agder' },\r\n  { id: 'NO-46', name: 'Vestland' },\r\n  { id: 'NO-50', name: 'Trøndelag' },\r\n  { id: 'NO-54', name: 'Troms og Finnmark' }\r\n];\r\n\r\nexport const swedenRegions = [\r\n  { id: 'SE-AB', name: 'Stockholm' },\r\n  { id: 'SE-C', name: 'Uppsala' },\r\n  { id: 'SE-D', name: 'Södermanland' },\r\n  { id: 'SE-E', name: 'Östergötland' },\r\n  { id: 'SE-F', name: 'Jönköping' },\r\n  { id: 'SE-G', name: 'Kronoberg' },\r\n  { id: 'SE-H', name: 'Kalmar' },\r\n  { id: 'SE-I', name: 'Gotland' },\r\n  { id: 'SE-K', name: 'Blekinge' },\r\n  { id: 'SE-M', name: 'Skåne' },\r\n  { id: 'SE-N', name: 'Halland' },\r\n  { id: 'SE-O', name: 'Västra Götaland' },\r\n  { id: 'SE-S', name: 'Värmland' },\r\n  { id: 'SE-T', name: 'Örebro' },\r\n  { id: 'SE-U', name: 'Västmanland' },\r\n  { id: 'SE-W', name: 'Dalarna' },\r\n  { id: 'SE-X', name: 'Gävleborg' },\r\n  { id: 'SE-Y', name: 'Västernorrland' },\r\n  { id: 'SE-Z', name: 'Jämtland' },\r\n  { id: 'SE-AC', name: 'Västerbotten' },\r\n  { id: 'SE-BD', name: 'Norrbotten' }\r\n];\r\n\r\nexport const usStates = [\r\n  { id: 'US-AL', name: 'Alabama' },\r\n  { id: 'US-AK', name: 'Alaska' },\r\n  { id: 'US-AZ', name: 'Arizona' },\r\n  { id: 'US-AR', name: 'Arkansas' },\r\n  { id: 'US-CA', name: 'California' },\r\n  { id: 'US-CO', name: 'Colorado' },\r\n  { id: 'US-CT', name: 'Connecticut' },\r\n  { id: 'US-DE', name: 'Delaware' },\r\n  { id: 'US-FL', name: 'Florida' },\r\n  { id: 'US-GA', name: 'Georgia' },\r\n  { id: 'US-HI', name: 'Hawaii' },\r\n  { id: 'US-ID', name: 'Idaho' },\r\n  { id: 'US-IL', name: 'Illinois' },\r\n  { id: 'US-IN', name: 'Indiana' },\r\n  { id: 'US-IA', name: 'Iowa' },\r\n  { id: 'US-KS', name: 'Kansas' },\r\n  { id: 'US-KY', name: 'Kentucky' },\r\n  { id: 'US-LA', name: 'Louisiana' },\r\n  { id: 'US-ME', name: 'Maine' },\r\n  { id: 'US-MD', name: 'Maryland' },\r\n  { id: 'US-MA', name: 'Massachusetts' },\r\n  { id: 'US-MI', name: 'Michigan' },\r\n  { id: 'US-MN', name: 'Minnesota' },\r\n  { id: 'US-MS', name: 'Mississippi' },\r\n  { id: 'US-MO', name: 'Missouri' },\r\n  { id: 'US-MT', name: 'Montana' },\r\n  { id: 'US-NE', name: 'Nebraska' },\r\n  { id: 'US-NV', name: 'Nevada' },\r\n  { id: 'US-NH', name: 'New Hampshire' },\r\n  { id: 'US-NJ', name: 'New Jersey' },\r\n  { id: 'US-NM', name: 'New Mexico' },\r\n  { id: 'US-NY', name: 'New York' },\r\n  { id: 'US-NC', name: 'North Carolina' },\r\n  { id: 'US-ND', name: 'North Dakota' },\r\n  { id: 'US-OH', name: 'Ohio' },\r\n  { id: 'US-OK', name: 'Oklahoma' },\r\n  { id: 'US-OR', name: 'Oregon' },\r\n  { id: 'US-PA', name: 'Pennsylvania' },\r\n  { id: 'US-RI', name: 'Rhode Island' },\r\n  { id: 'US-SC', name: 'South Carolina' },\r\n  { id: 'US-SD', name: 'South Dakota' },\r\n  { id: 'US-TN', name: 'Tennessee' },\r\n  { id: 'US-TX', name: 'Texas' },\r\n  { id: 'US-UT', name: 'Utah' },\r\n  { id: 'US-VT', name: 'Vermont' },\r\n  { id: 'US-VA', name: 'Virginia' },\r\n  { id: 'US-WA', name: 'Washington' },\r\n  { id: 'US-WV', name: 'West Virginia' },\r\n  { id: 'US-WI', name: 'Wisconsin' },\r\n  { id: 'US-WY', name: 'Wyoming' }\r\n];\r\n\r\nexport const vietnamProvinces = [\r\n  { id: 'VN-44', name: 'An Giang' },\r\n  { id: 'VN-43', name: 'Bà Rịa-Vũng Tàu' },\r\n  { id: 'VN-54', name: 'Bắc Giang' },\r\n  { id: 'VN-53', name: 'Bắc Kạn' },\r\n  { id: 'VN-55', name: 'Bắc Liêu' },\r\n  { id: 'VN-56', name: 'Bắc Ninh' },\r\n  { id: 'VN-50', name: 'Bến Tre' },\r\n  { id: 'VN-31', name: 'Bình Định' },\r\n  { id: 'VN-57', name: 'Bình Dương' },\r\n  { id: 'VN-58', name: 'Bình Phước' },\r\n  { id: 'VN-40', name: 'Bình Thuận' },\r\n  { id: 'VN-59', name: 'Cà Mau' },\r\n  { id: 'VN-CT', name: 'Cần Thơ' },\r\n  { id: 'VN-04', name: 'Cao Bằng' },\r\n  { id: 'VN-DN', name: 'Đà Nẵng' },\r\n  { id: 'VN-33', name: 'Đắk Lắk' },\r\n  { id: 'VN-72', name: 'Đắk Nông' },\r\n  { id: 'VN-71', name: 'Điện Biên' },\r\n  { id: 'VN-39', name: 'Đồng Nai' },\r\n  { id: 'VN-45', name: 'Đồng Tháp' },\r\n  { id: 'VN-30', name: 'Gia Lai' },\r\n  { id: 'VN-03', name: 'Hà Giang' },\r\n  { id: 'VN-63', name: 'Hà Nam' },\r\n  { id: 'HN', name: 'Hà Nội' },\r\n  { id: 'VN-23', name: 'Hà Tĩnh' },\r\n  { id: 'VN-61', name: 'Hải Dương' },\r\n  { id: 'VN-HP', name: 'Hải Phòng' },\r\n  { id: 'VN-73', name: 'Hậu Giang' },\r\n  { id: 'VN-SG', name: 'Hồ Chí Minh' },\r\n  { id: 'VN-14', name: 'Hòa Bình' },\r\n  { id: 'VN-66', name: 'Hưng Yên' },\r\n  { id: 'VN-34', name: 'Khánh Hòa' },\r\n  { id: 'VN-47', name: 'Kiên Giang' },\r\n  { id: 'VN-28', name: 'Kon Tum' },\r\n  { id: 'VN-01', name: 'Lai Châu' },\r\n  { id: 'VN-35', name: 'Lâm Đồng' },\r\n  { id: 'VN-09', name: 'Lạng Sơn' },\r\n  { id: 'VN-02', name: 'Lào Cai' },\r\n  { id: 'VN-41', name: 'Long An' },\r\n  { id: 'VN-67', name: 'Nam Định' },\r\n  { id: 'VN-22', name: 'Nghệ An' },\r\n  { id: 'VN-18', name: 'Ninh Bình' },\r\n  { id: 'VN-36', name: 'Ninh Thuận' },\r\n  { id: 'VN-68', name: 'Phú Thọ' },\r\n  { id: 'VN-32', name: 'Phú Yên' },\r\n  { id: 'VN-24', name: 'Quảng Bình' },\r\n  { id: 'VN-27', name: 'Quảng Nam' },\r\n  { id: 'VN-29', name: 'Quảng Ngãi' },\r\n  { id: 'VN-13', name: 'Quảng Ninh' },\r\n  { id: 'VN-25', name: 'Quảng Trị' },\r\n  { id: 'VN-52', name: 'Sóc Trăng' },\r\n  { id: 'VN-05', name: 'Sơn La' },\r\n  { id: 'VN-37', name: 'Tây Ninh' },\r\n  { id: 'VN-20', name: 'Thái Bình' },\r\n  { id: 'VN-69', name: 'Thái Nguyên' },\r\n  { id: 'VN-21', name: 'Thanh Hóa' },\r\n  { id: 'VN-26', name: 'Thừa Thiên Huế' },\r\n  { id: 'VN-46', name: 'Tiền Giang' },\r\n  { id: 'VN-51', name: 'Trà Vinh' },\r\n  { id: 'VN-07', name: 'Tuyên Quang' },\r\n  { id: 'VN-49', name: 'Vĩnh Long' },\r\n  { id: 'VN-70', name: 'Vĩnh Phúc' },\r\n  { id: 'VN-06', name: 'Yên Bái' }\r\n];\r\n\r\nexport interface SvgMapConfig {\r\n  id: string;\r\n  mapId: string;\r\n  name: string;\r\n  mapName: string;\r\n  description: string;\r\n  emoji: string;\r\n  svgPath: string;\r\n  regions: Array<{ id: string; name: string }>;\r\n  countries: Array<{ id: string; name: string }>;\r\n}\r\n\r\nexport const availableMaps: SvgMapConfig[] = [\r\n  {\r\n    id: 'europe',\r\n    mapId: 'europe',\r\n    name: 'Europe',\r\n    mapName: 'Europe',\r\n    description: 'Learn all 44 European countries with interactive maps',\r\n    emoji: '🇪🇺',\r\n    svgPath: '/europe.svg',\r\n    regions: europeCountries,\r\n    countries: europeCountries\r\n  },\r\n  {\r\n    id: 'world',\r\n    mapId: 'world',\r\n    name: 'World',\r\n    mapName: 'World',\r\n    description: 'Master geography of all 195+ countries worldwide',\r\n    emoji: '🌍',\r\n    svgPath: '/world.svg',\r\n    regions: worldCountries,\r\n    countries: worldCountries\r\n  },\r\n  {\r\n    id: 'africa',\r\n    mapId: 'africa',\r\n    name: 'Africa',\r\n    mapName: 'Africa',\r\n    description: 'Explore all 54 African countries and their locations',\r\n    emoji: '🌍',\r\n    svgPath: '/africa.svg',\r\n    regions: africaCountries,\r\n    countries: africaCountries\r\n  },\r\n  {\r\n    id: 'north-america',\r\n    mapId: 'north-america',\r\n    name: 'North America',\r\n    mapName: 'North America',\r\n    description: 'Learn 23 North American countries and territories',\r\n    emoji: '🌎',\r\n    svgPath: '/north-america.svg',\r\n    regions: northAmericaCountries,\r\n    countries: northAmericaCountries\r\n  },\r\n  {\r\n    id: 'finland',\r\n    mapId: 'finland',\r\n    name: 'Finland Regions',\r\n    mapName: 'Finland Regions',\r\n    description: 'Master all 19 Finnish regions and their locations',\r\n    emoji: '🇫🇮',\r\n    svgPath: '/fi.svg',\r\n    regions: finlandRegions,\r\n    countries: finlandRegions\r\n  },\r\n  {\r\n    id: 'france',\r\n    mapId: 'france',\r\n    name: 'France Regions',\r\n    mapName: 'France Regions',\r\n    description: 'Learn the 13 administrative regions of France',\r\n    emoji: '🇫🇷',\r\n    svgPath: '/fr.svg',\r\n    regions: franceRegions,\r\n    countries: franceRegions\r\n  },\r\n  {\r\n    id: 'united-kingdom',\r\n    mapId: 'united-kingdom',\r\n    name: 'United Kingdom',\r\n    mapName: 'United Kingdom',\r\n    description: 'Identify the 4 constituent countries of the UK',\r\n    emoji: '🇬🇧',\r\n    svgPath: '/gb.svg',\r\n    regions: ukRegions,\r\n    countries: ukRegions\r\n  },\r\n  {\r\n    id: 'norway',\r\n    mapId: 'norway',\r\n    name: 'Norway Regions',\r\n    mapName: 'Norway Regions',\r\n    description: 'Explore the 11 counties (fylker) of Norway',\r\n    emoji: '🇳🇴',\r\n    svgPath: '/no.svg',\r\n    regions: norwayRegions,\r\n    countries: norwayRegions\r\n  },\r\n  {\r\n    id: 'sweden',\r\n    mapId: 'sweden',\r\n    name: 'Sweden Regions',\r\n    mapName: 'Sweden Regions',\r\n    description: 'Learn all 21 Swedish counties (län)',\r\n    emoji: '🇸🇪',\r\n    svgPath: '/se.svg',\r\n    regions: swedenRegions,\r\n    countries: swedenRegions\r\n  },\r\n  {\r\n    id: 'united-states',\r\n    mapId: 'united-states',\r\n    name: 'United States',\r\n    mapName: 'United States',\r\n    description: 'Master all 50 US states and their locations',\r\n    emoji: '🇺🇸',\r\n    svgPath: '/us.svg',\r\n    regions: usStates,\r\n    countries: usStates\r\n  },\r\n  {\r\n    id: 'vietnam',\r\n    mapId: 'vietnam',\r\n    name: 'Vietnam Provinces',\r\n    mapName: 'Vietnam Provinces',\r\n    description: 'Learn all 63 provinces and cities of Vietnam',\r\n    emoji: '🇻🇳',\r\n    svgPath: '/vn.svg',\r\n    regions: vietnamProvinces,\r\n    countries: vietnamProvinces\r\n  }\r\n];\r\n\r\n/**\r\n * Generate SVG map cards for a specific map\r\n */\r\nexport function generateSvgMapCards(\r\n  deckId: string,\r\n  mapConfig: SvgMapConfig\r\n): Card[] {\r\n  const cards: Card[] = [];\r\n\r\n  mapConfig.countries.forEach((country) => {\r\n    const cardOptions: SvgMapCardOptions = {\r\n      mapId: mapConfig.mapId,\r\n      countryId: country.id,\r\n      countryName: country.name,\r\n      svgPath: mapConfig.svgPath\r\n    };\r\n\r\n    const card = createSvgMapCard(\r\n      `${deckId}_${mapConfig.mapId}_${country.id}`,\r\n      deckId,\r\n      `Identify the highlighted region in ${mapConfig.mapName}`,\r\n      country.name,\r\n      {\r\n        type: 'svg_map',\r\n        options: cardOptions\r\n      },\r\n      []\r\n    );\r\n\r\n    cards.push(card);\r\n  });\r\n\r\n  return cards;\r\n}\r\n\r\n/**\r\n * Generate cards for all available maps\r\n */\r\nexport function generateAllSvgMapCards(deckId: string): Card[] {\r\n  const allCards: Card[] = [];\r\n\r\n  availableMaps.forEach((mapConfig) => {\r\n    const mapCards = generateSvgMapCards(deckId, mapConfig);\r\n    allCards.push(...mapCards);\r\n  });\r\n\r\n  return allCards;\r\n}\r\n\r\n/**\r\n * Get map configuration by ID\r\n */\r\nexport function getMapConfig(mapId: string): SvgMapConfig | undefined {\r\n  return availableMaps.find(map => map.mapId === mapId);\r\n}\r\n\r\n/**\r\n * Get country information by map and country ID\r\n */\r\nexport function getCountryInfo(mapId: string, countryId: string): { id: string; name: string } | undefined {\r\n  const mapConfig = getMapConfig(mapId);\r\n  if (!mapConfig) return undefined;\r\n  \r\n  return mapConfig.countries.find(country => country.id === countryId);\r\n}\r\n\r\n/**\r\n * Generate a complete map deck for any available map\r\n */\r\ninterface DeckData {\r\n  id?: string;\r\n  userId: string;\r\n  title: string;\r\n  description: string;\r\n  cardCount: number;\r\n  isPublic: boolean;\r\n  category?: string;\r\n  settings: Record<string, unknown>;\r\n}\r\n\r\ninterface CardData {\r\n  frontContent: string;\r\n  backContent: string;\r\n  cardType: CardType;\r\n  options?: Record<string, unknown>;\r\n}\r\n\r\nexport async function generateMapDeck(mapId: string, createDeck: (deckData: DeckData) => Promise<DeckData>, addCard?: (cardData: CardData) => Promise<CardData>) {\r\n  const mapConfig = getMapConfig(mapId);\r\n  if (!mapConfig) {\r\n    throw new Error(`Map configuration for '${mapId}' not found`);\r\n  }\r\n\r\n  // Create the deck\r\n  const deck = await createDeck({\r\n    userId: 'current-user',\r\n    title: `${mapConfig.mapName} Geography`,\r\n    description: `Learn all regions in ${mapConfig.mapName} with interactive maps. Each card shows a highlighted region that you need to identify.`,\r\n    cardCount: mapConfig.countries.length,\r\n    isPublic: false,\r\n    settings: {\r\n      newCardsPerDay: 20,\r\n      maxReviewsPerDay: 100,\r\n      easyBonus: 1.3,\r\n      intervalModifier: 1.0,\r\n      maximumInterval: 36500,\r\n      minimumInterval: 1\r\n    },\r\n    category: 'geography'\r\n  });\r\n\r\n  // If addCard function is provided, add all the SVG map cards\r\n  if (addCard && deck.id) {\r\n    const cards = generateSvgMapCards(deck.id, mapConfig);\r\n    \r\n    // Add cards one by one if addCard function is provided\r\n    if (addCard) {\r\n      for (const card of cards) {\r\n        await addCard(card);\r\n      }\r\n    }\r\n  }\r\n\r\n  return deck;\r\n}\r\n\r\n/**\r\n * Generate a complete Europe map deck (backward compatibility)\r\n */\r\nexport async function generateEuropeMapDeck(createDeck: (deckData: DeckData) => Promise<DeckData>, addCard?: (cardData: CardData) => Promise<CardData>) {\r\n  return generateMapDeck('europe', createDeck, addCard);\r\n}","import { useState, useEffect, useRef } from 'react'\r\nimport { useNavigate } from 'react-router-dom'\r\nimport { useDeckStore } from '../stores/deckStore'\r\nimport { Deck, DeckSettings } from '../../../shared/types'\r\nimport CardManager from '../components/deck/CardManager'\r\nimport ProgressBar from '../components/ui/ProgressBar'\r\nimport { generateMapDeck, availableMaps } from '../utils/svgMapGenerator'\r\n\r\nconst DecksPage = () => {\r\n  const navigate = useNavigate()\r\n  const {\r\n    decks,\r\n    isLoading,\r\n    error,\r\n    importProgress,\r\n    importStatus,\r\n    createDeck,\r\n    deleteDeck,\r\n    loadExampleDecks,\r\n    importAnkiDeck,\r\n    importFromText,\r\n    clearError,\r\n    getCards,\r\n    resetImportProgress,\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    addCard\r\n  } = useDeckStore()\r\n\r\n  const [showCreateModal, setShowCreateModal] = useState(false)\r\n  const [showImportModal, setShowImportModal] = useState(false)\r\n  const [searchTerm, setSearchTerm] = useState('')\r\n  const [selectedCategory, setSelectedCategory] = useState('all')\r\n  const [managingDeckId, setManagingDeckId] = useState<string | null>(null)\r\n  const [showMapModal, setShowMapModal] = useState(false)\r\n  const [selectedMapType, setSelectedMapType] = useState<string>('')\r\n\r\n  // Form states\r\n  const [newDeckTitle, setNewDeckTitle] = useState('')\r\n  const [newDeckDescription, setNewDeckDescription] = useState('')\r\n  const [newDeckCategory, setNewDeckCategory] = useState('')\r\n  const [importText, setImportText] = useState('')\r\n  const [importSeparator, setImportSeparator] = useState('\\t')\r\n\r\n  const hasLoadedExampleDecks = useRef(false)\r\n\r\n  useEffect(() => {\r\n    // Load example decks if no decks exist and we haven't already loaded them\r\n    // Add a small delay to allow Zustand to hydrate from localStorage first\r\n    const timer = setTimeout(() => {\r\n      if (decks.length === 0 && !hasLoadedExampleDecks.current) {\r\n        hasLoadedExampleDecks.current = true\r\n        loadExampleDecks()\r\n      }\r\n    }, 100)\r\n\r\n    return () => clearTimeout(timer)\r\n  }, [decks.length, loadExampleDecks])\r\n\r\n  const filteredDecks = decks.filter(deck => {\r\n    const matchesSearch = deck.title.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n                         deck.description.toLowerCase().includes(searchTerm.toLowerCase())\r\n    const matchesCategory = selectedCategory === 'all' || deck.category === selectedCategory\r\n    return matchesSearch && matchesCategory\r\n  })\r\n\r\n  const categories = ['all', ...Array.from(new Set(decks.map(deck => deck.category).filter(Boolean)))]\r\n\r\n  const handleCreateDeck = async (e: React.FormEvent) => {\r\n    e.preventDefault()\r\n    try {\r\n      await createDeck({\r\n        userId: 'current-user',\r\n        title: newDeckTitle,\r\n        description: newDeckDescription,\r\n        cardCount: 0,\r\n        isPublic: false,\r\n        settings: {\r\n          newCardsPerDay: 20,\r\n          maxReviewsPerDay: 100,\r\n          easyBonus: 1.3,\r\n          intervalModifier: 1.0,\r\n          maximumInterval: 36500,\r\n          minimumInterval: 1\r\n        },\r\n        category: newDeckCategory || 'general'\r\n      })\r\n      setShowCreateModal(false)\r\n      setNewDeckTitle('')\r\n      setNewDeckDescription('')\r\n      setNewDeckCategory('')\r\n    } catch (error) {\r\n      console.error('Failed to create deck:', error)\r\n    }\r\n  }\r\n\r\n  const handleDeleteDeck = async (deckId: string) => {\r\n    if (confirm('Are you sure you want to delete this deck? This action cannot be undone.')) {\r\n      try {\r\n        await deleteDeck(deckId)\r\n      } catch (error) {\r\n        console.error('Failed to delete deck:', error)\r\n      }\r\n    }\r\n  }\r\n\r\n  const handleFileImport = async (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0]\r\n    if (!file) return\r\n\r\n    try {\r\n      if (file.name.endsWith('.apkg') || file.name.endsWith('.txt')) {\r\n        await importAnkiDeck(file)\r\n      } else {\r\n        // Try to import as text\r\n        const text = await file.text()\r\n        await importFromText(file.name.replace(/\\.[^/.]+$/, \"\"), text, importSeparator)\r\n      }\r\n      setShowImportModal(false)\r\n    } catch (error) {\r\n      console.error('Failed to import file:', error)\r\n      resetImportProgress()\r\n    }\r\n  }\r\n\r\n  const handleTextImport = async (e: React.FormEvent) => {\r\n    e.preventDefault()\r\n    try {\r\n      const deck = await importFromText('Imported Deck', importText, importSeparator)\r\n      console.log('Successfully imported deck:', deck)\r\n      setShowImportModal(false)\r\n      setImportText('')\r\n      // Clear any previous errors\r\n      clearError()\r\n    } catch (error) {\r\n      console.error('Failed to import text:', error)\r\n      // The error should already be set in the store by importFromText\r\n    }\r\n  }\r\n\r\n  const getDeckStats = (deck: Deck) => {\r\n    const cards = getCards(deck.id)\r\n    const newCards = cards.filter(card => card.reviewCount === 0).length\r\n    const reviewCards = cards.filter(card => card.reviewCount > 0 && new Date(card.nextReview) <= new Date()).length\r\n    return { total: cards.length, new: newCards, review: reviewCards }\r\n  }\r\n\r\n  const handleStudyDeck = (deckId: string) => {\r\n    navigate(`/study/${deckId}`)\r\n  }\r\n\r\n  const handleCreateMapDeck = async () => {\r\n    if (!selectedMapType) return\r\n    \r\n    try {\r\n      // Create wrapper function to match expected signature\r\n      const createDeckWrapper = async (deckData: { userId: string; title: string; description: string; settings: DeckSettings; category?: string; isPublic: boolean; cardCount?: number }) => {\r\n        // Convert DeckData to Deck format\r\n        const deckInput = {\r\n          userId: deckData.userId,\r\n          title: deckData.title,\r\n          description: deckData.description,\r\n          settings: deckData.settings,\r\n          category: deckData.category || 'geography',\r\n          isPublic: deckData.isPublic,\r\n          cardCount: deckData.cardCount || 0\r\n        }\r\n        const result = await createDeck(deckInput)\r\n        // Convert back to DeckData format\r\n        return {\r\n          ...deckData,\r\n          id: result.id\r\n        }\r\n      }\r\n      \r\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n      const deck = await generateMapDeck(selectedMapType, createDeckWrapper as any)\r\n      console.log(`Successfully created ${selectedMapType} map deck:`, deck)\r\n      setShowMapModal(false)\r\n      setSelectedMapType('')\r\n    } catch (error) {\r\n      console.error('Failed to create map deck:', error)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4\">\r\n        <div>\r\n          <h1 className=\"text-3xl font-bold text-gray-900 dark:text-white\">My Decks</h1>\r\n          <p className=\"text-gray-600 dark:text-gray-400\">Manage your flashcard decks</p>\r\n        </div>\r\n        <div className=\"flex gap-2\">\r\n          <button\r\n            onClick={() => setShowCreateModal(true)}\r\n            className=\"btn btn-primary\"\r\n          >\r\n            <svg className=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 4v16m8-8H4\" />\r\n            </svg>\r\n            Create Deck\r\n          </button>\r\n          <button\r\n            onClick={() => setShowMapModal(true)}\r\n            className=\"btn btn-success\"\r\n          >\r\n            <svg className=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7\" />\r\n            </svg>\r\n            Map Deck\r\n          </button>\r\n          <button\r\n            onClick={() => setShowImportModal(true)}\r\n            className=\"btn btn-secondary\"\r\n          >\r\n            <svg className=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10\" />\r\n            </svg>\r\n            Import\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Error Display */}\r\n      {error && (\r\n        <div className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative\">\r\n          <span className=\"block sm:inline\">{error}</span>\r\n          <button\r\n            onClick={clearError}\r\n            className=\"absolute top-0 bottom-0 right-0 px-4 py-3\"\r\n          >\r\n            <svg className=\"fill-current h-6 w-6 text-red-500\" role=\"button\" viewBox=\"0 0 20 20\">\r\n              <path d=\"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z\"/>\r\n            </svg>\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {/* Search and Filter */}\r\n      <div className=\"flex flex-col sm:flex-row gap-4\">\r\n        <div className=\"flex-1\">\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Search decks...\"\r\n            value={searchTerm}\r\n            onChange={(e) => setSearchTerm(e.target.value)}\r\n            className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\r\n          />\r\n        </div>\r\n        <select\r\n          value={selectedCategory}\r\n          onChange={(e) => setSelectedCategory(e.target.value)}\r\n          className=\"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\r\n        >\r\n          {categories.map(category => (\r\n            <option key={category} value={category}>\r\n              {category === 'all' ? 'All Categories' : (category || '').charAt(0).toUpperCase() + (category || '').slice(1)}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      {/* Loading State */}\r\n      {isLoading && (\r\n        <div className=\"flex justify-center items-center py-12\">\r\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Decks Grid */}\r\n      {!isLoading && (\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n          {filteredDecks.map(deck => {\r\n            const stats = getDeckStats(deck)\r\n            return (\r\n              <div key={deck.id} className=\"card p-6 hover:shadow-lg transition-shadow\">\r\n                <div className=\"flex justify-between items-start mb-4\">\r\n                  <div className=\"flex-1\">\r\n                    <h3 className=\"text-xl font-semibold text-gray-900 dark:text-white mb-2\">\r\n                      {deck.title}\r\n                    </h3>\r\n                    <p className=\"text-gray-600 dark:text-gray-400 text-sm mb-3\">\r\n                      {deck.description}\r\n                    </p>\r\n                    {deck.category && (\r\n                      <span className=\"inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full\">\r\n                        {deck.category}\r\n                      </span>\r\n                    )}\r\n                  </div>\r\n                  <div className=\"flex gap-1 ml-4\">\r\n                    <button\r\n                      onClick={() => handleDeleteDeck(deck.id)}\r\n                      className=\"p-2 text-gray-400 hover:text-red-500 transition-colors\"\r\n                      title=\"Delete deck\"\r\n                    >\r\n                      <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\r\n                      </svg>\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <div className=\"flex justify-between text-sm\">\r\n                    <span className=\"text-gray-600 dark:text-gray-400\">Total Cards</span>\r\n                    <span className=\"font-medium text-gray-900 dark:text-white\">{stats.total}</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between text-sm\">\r\n                    <span className=\"text-gray-600 dark:text-gray-400\">New</span>\r\n                    <span className=\"font-medium text-blue-600\">{stats.new}</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between text-sm\">\r\n                    <span className=\"text-gray-600 dark:text-gray-400\">Due for Review</span>\r\n                    <span className=\"font-medium text-orange-600\">{stats.review}</span>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700\">\r\n                  <div className=\"flex gap-2\">\r\n                    <button\r\n                      onClick={() => handleStudyDeck(deck.id)}\r\n                      className=\"btn btn-primary btn-sm flex-1\"\r\n                    >\r\n                      Study Now\r\n                    </button>\r\n                    <button\r\n                      onClick={() => setManagingDeckId(deck.id)}\r\n                      className=\"btn btn-secondary btn-sm flex-1\"\r\n                    >\r\n                      Manage Cards\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )\r\n          })}\r\n        </div>\r\n      )}\r\n\r\n      {/* Empty State */}\r\n      {!isLoading && filteredDecks.length === 0 && (\r\n        <div className=\"text-center py-12\">\r\n          <div className=\"text-6xl mb-4\">📚</div>\r\n          <h3 className=\"text-xl font-semibold text-gray-900 dark:text-white mb-2\">\r\n            {searchTerm || selectedCategory !== 'all' ? 'No decks found' : 'No decks yet'}\r\n          </h3>\r\n          <p className=\"text-gray-600 dark:text-gray-400 mb-6\">\r\n            {searchTerm || selectedCategory !== 'all' \r\n              ? 'Try adjusting your search or filter criteria'\r\n              : 'Create your first deck or import existing flashcards to get started'\r\n            }\r\n          </p>\r\n          {!searchTerm && selectedCategory === 'all' && (\r\n            <div className=\"flex justify-center gap-4\">\r\n              <button\r\n                onClick={() => setShowCreateModal(true)}\r\n                className=\"btn btn-primary\"\r\n              >\r\n                Create Your First Deck\r\n              </button>\r\n              <button\r\n                onClick={() => setShowImportModal(true)}\r\n                className=\"btn btn-secondary\"\r\n              >\r\n                Import Existing Deck\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* Create Deck Modal */}\r\n      {showCreateModal && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\r\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-md\">\r\n            <h2 className=\"text-xl font-semibold mb-4 text-gray-900 dark:text-white\">Create New Deck</h2>\r\n            <form onSubmit={handleCreateDeck} className=\"space-y-4\">\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                  Title *\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={newDeckTitle}\r\n                  onChange={(e) => setNewDeckTitle(e.target.value)}\r\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\r\n                  required\r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                  Description\r\n                </label>\r\n                <textarea\r\n                  value={newDeckDescription}\r\n                  onChange={(e) => setNewDeckDescription(e.target.value)}\r\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\r\n                  rows={3}\r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                  Category\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={newDeckCategory}\r\n                  onChange={(e) => setNewDeckCategory(e.target.value)}\r\n                  placeholder=\"e.g., language, science, history\"\r\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\r\n                />\r\n              </div>\r\n              <div className=\"flex gap-3 pt-4\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setShowCreateModal(false)}\r\n                  className=\"flex-1 btn btn-secondary\"\r\n                >\r\n                  Cancel\r\n                </button>\r\n                <button\r\n                  type=\"submit\"\r\n                  className=\"flex-1 btn btn-primary\"\r\n                >\r\n                  Create Deck\r\n                </button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Import Modal */}\r\n      {showImportModal && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\r\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-lg\">\r\n            <h2 className=\"text-xl font-semibold mb-4 text-gray-900 dark:text-white\">Import Deck</h2>\r\n            \r\n            <div className=\"space-y-6\">\r\n              {/* File Import */}\r\n              <div>\r\n                <h3 className=\"text-lg font-medium mb-2 text-gray-900 dark:text-white\">Import from File</h3>\r\n                <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-3\">\r\n                  Upload an Anki deck (.apkg) or text file (.txt)\r\n                </p>\r\n                <input\r\n                  type=\"file\"\r\n                  accept=\".apkg,.txt,.csv\"\r\n                  onChange={handleFileImport}\r\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\r\n                  disabled={isLoading}\r\n                />\r\n                \r\n                {/* Progress Bar */}\r\n                {(isLoading && importProgress > 0) && (\r\n                  <div className=\"mt-4\">\r\n                    <ProgressBar\r\n                      progress={importProgress}\r\n                      label={importStatus || 'Importing...'}\r\n                      className=\"mb-2\"\r\n                    />\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              <div className=\"border-t border-gray-200 dark:border-gray-700 pt-6\">\r\n                <h3 className=\"text-lg font-medium mb-2 text-gray-900 dark:text-white\">Import from Text</h3>\r\n                <form onSubmit={handleTextImport} className=\"space-y-4\">\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                      Separator\r\n                    </label>\r\n                    <select\r\n                      value={importSeparator}\r\n                      onChange={(e) => setImportSeparator(e.target.value)}\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\r\n                    >\r\n                      <option value=\"\\t\">Tab</option>\r\n                      <option value=\",\">Comma</option>\r\n                      <option value=\";\">Semicolon</option>\r\n                      <option value=\"|\">Pipe</option>\r\n                    </select>\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                      Text (Front{importSeparator}Back format)\r\n                    </label>\r\n                    <textarea\r\n                      value={importText}\r\n                      onChange={(e) => setImportText(e.target.value)}\r\n                      placeholder={`Example:\\nHello${importSeparator}Hola\\nGoodbye${importSeparator}Adiós`}\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\r\n                      rows={6}\r\n                    />\r\n                  </div>\r\n                  <button\r\n                    type=\"submit\"\r\n                    disabled={!importText.trim() || isLoading}\r\n                    className=\"w-full btn btn-primary disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                  >\r\n                    {isLoading ? 'Importing...' : 'Import Text'}\r\n                  </button>\r\n                  \r\n                  {/* Progress Bar for Text Import */}\r\n                  {(isLoading && importProgress > 0) && (\r\n                    <div className=\"mt-4\">\r\n                      <ProgressBar\r\n                        progress={importProgress}\r\n                        label={importStatus || 'Importing...'}\r\n                        className=\"mb-2\"\r\n                      />\r\n                    </div>\r\n                  )}\r\n                </form>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex justify-end pt-6 border-t border-gray-200 dark:border-gray-700 mt-6\">\r\n              <button\r\n                onClick={() => {\r\n                  setShowImportModal(false)\r\n                  resetImportProgress()\r\n                }}\r\n                disabled={isLoading}\r\n                className=\"btn btn-secondary disabled:opacity-50 disabled:cursor-not-allowed\"\r\n              >\r\n                {isLoading ? 'Importing...' : 'Close'}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* SVG Map Modal */}\r\n      {showMapModal && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\r\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-lg\">\r\n            <h2 className=\"text-xl font-semibold mb-4 text-gray-900 dark:text-white\">Create Geography Deck</h2>\r\n            <div className=\"space-y-6\">\r\n              <div className=\"text-center\">\r\n                <div className=\"text-6xl mb-4\">🗺️</div>\r\n                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-2\">\r\n                  Interactive Geography Learning\r\n                </h3>\r\n                <p className=\"text-gray-600 dark:text-gray-400 mb-6\">\r\n                  Choose a map type to create an interactive geography deck. Each card will show a highlighted region,\r\n                  and you'll need to identify its name.\r\n                </p>\r\n              </div>\r\n\r\n              {/* Map Type Selection */}\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3\">\r\n                  Select Map Type\r\n                </label>\r\n                <div className=\"grid grid-cols-1 gap-3 max-h-64 overflow-y-auto\">\r\n                  {availableMaps.map((map) => (\r\n                    <button\r\n                      key={map.id}\r\n                      onClick={() => setSelectedMapType(map.id)}\r\n                      className={`p-4 text-left border rounded-lg transition-colors ${\r\n                        selectedMapType === map.id\r\n                          ? 'border-blue-500 bg-blue-50 dark:bg-blue-900/20'\r\n                          : 'border-gray-300 dark:border-gray-600 hover:border-gray-400'\r\n                      }`}\r\n                    >\r\n                      <div className=\"flex items-center justify-between\">\r\n                        <div>\r\n                          <h4 className=\"font-medium text-gray-900 dark:text-white\">\r\n                            {map.name}\r\n                          </h4>\r\n                          <p className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n                            {map.description}\r\n                          </p>\r\n                          <p className=\"text-xs text-gray-500 dark:text-gray-500 mt-1\">\r\n                            {map.regions.length} {map.regions.length === 1 ? 'region' : 'regions'}\r\n                          </p>\r\n                        </div>\r\n                        <div className=\"text-2xl ml-4\">\r\n                          {map.emoji}\r\n                        </div>\r\n                      </div>\r\n                    </button>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n              \r\n              {selectedMapType && (\r\n                <div className=\"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg\">\r\n                  <h4 className=\"font-medium text-blue-900 dark:text-blue-100 mb-2\">What you'll get:</h4>\r\n                  <ul className=\"text-sm text-blue-800 dark:text-blue-200 space-y-1\">\r\n                    <li>• {availableMaps.find(m => m.id === selectedMapType)?.regions.length} interactive map cards</li>\r\n                    <li>• Visual region highlighting</li>\r\n                    <li>• Enhanced indicators for small regions</li>\r\n                    <li>• Immediate feedback</li>\r\n                    <li>• Spaced repetition learning</li>\r\n                  </ul>\r\n                </div>\r\n              )}\r\n\r\n              <div className=\"flex gap-3 pt-4\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => {\r\n                    setShowMapModal(false)\r\n                    setSelectedMapType('')\r\n                  }}\r\n                  className=\"flex-1 btn btn-secondary\"\r\n                >\r\n                  Cancel\r\n                </button>\r\n                <button\r\n                  onClick={handleCreateMapDeck}\r\n                  disabled={isLoading || !selectedMapType}\r\n                  className=\"flex-1 btn btn-success disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                >\r\n                  {isLoading ? 'Creating...' : `Create ${selectedMapType ? availableMaps.find(m => m.id === selectedMapType)?.name : ''} Deck`}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Card Manager Modal */}\r\n      {managingDeckId && (\r\n        <CardManager\r\n          deckId={managingDeckId}\r\n          onClose={() => setManagingDeckId(null)}\r\n        />\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default DecksPage","interface ConfirmationDialogProps {\r\n  isOpen: boolean\r\n  onClose: () => void\r\n  onConfirm: () => void\r\n  title: string\r\n  message: string\r\n  confirmText?: string\r\n  cancelText?: string\r\n  isDestructive?: boolean\r\n  isLoading?: boolean\r\n}\r\n\r\nconst ConfirmationDialog = ({\r\n  isOpen,\r\n  onClose,\r\n  onConfirm,\r\n  title,\r\n  message,\r\n  confirmText = 'Confirm',\r\n  cancelText = 'Cancel',\r\n  isDestructive = false,\r\n  isLoading = false\r\n}: ConfirmationDialogProps) => {\r\n  if (!isOpen) return null\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\r\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full\">\r\n        <div className=\"p-6\">\r\n          {/* Header */}\r\n          <div className=\"flex items-center mb-4\">\r\n            <div className={`w-12 h-12 rounded-full flex items-center justify-center mr-4 ${\r\n              isDestructive \r\n                ? 'bg-red-100 dark:bg-red-900' \r\n                : 'bg-blue-100 dark:bg-blue-900'\r\n            }`}>\r\n              <span className=\"text-2xl\">\r\n                {isDestructive ? '⚠️' : 'ℹ️'}\r\n              </span>\r\n            </div>\r\n            <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\r\n              {title}\r\n            </h3>\r\n          </div>\r\n\r\n          {/* Message */}\r\n          <div className=\"mb-6\">\r\n            <p className=\"text-gray-600 dark:text-gray-400 leading-relaxed\">\r\n              {message}\r\n            </p>\r\n          </div>\r\n\r\n          {/* Actions */}\r\n          <div className=\"flex justify-end space-x-3\">\r\n            <button\r\n              onClick={onClose}\r\n              disabled={isLoading}\r\n              className=\"px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\r\n            >\r\n              {cancelText}\r\n            </button>\r\n            <button\r\n              onClick={onConfirm}\r\n              disabled={isLoading}\r\n              className={`px-4 py-2 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2 ${\r\n                isDestructive\r\n                  ? 'bg-red-600 hover:bg-red-700'\r\n                  : 'bg-blue-600 hover:bg-blue-700'\r\n              }`}\r\n            >\r\n              {isLoading && (\r\n                <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white\"></div>\r\n              )}\r\n              <span>{confirmText}</span>\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default ConfirmationDialog","import { useState, useEffect, useCallback } from 'react'\r\nimport { useAuthStore } from '../stores/authStore'\r\nimport { useDeckStore } from '../stores/deckStore'\r\nimport { useGamificationStore } from '../stores/gamificationStore'\r\nimport { userDataService, type AuthenticatedUser, type UserStats as DynamicUserStats, type UserActivity, type UserAchievement, type UserChallenge } from '../services/userDataService'\r\nimport XPBar from '../components/gamification/XPBar'\r\nimport StreakCounter from '../components/gamification/StreakCounter'\r\nimport ConfirmationDialog from '../components/ui/ConfirmationDialog'\r\n\r\nconst ProfilePage = () => {\r\n  const { user, updateUser, isLoading, initializeAuth } = useAuthStore()\r\n  \r\n  // Dynamic data state\r\n  const [, setUserStats] = useState<DynamicUserStats | null>(null)\r\n  const [userActivity, setUserActivity] = useState<UserActivity[]>([])\r\n  const [userAchievements, setUserAchievements] = useState<UserAchievement[]>([])\r\n  const [userChallenges, setUserChallenges] = useState<UserChallenge[]>([])\r\n  const [dataLoading, setDataLoading] = useState(false)\r\n  const [dataError, setDataError] = useState<string | null>(null)\r\n  \r\n  const [isEditing, setIsEditing] = useState(false)\r\n  const [showResetDialog, setShowResetDialog] = useState(false)\r\n  const [isResetting, setIsResetting] = useState(false)\r\n  const [resetSuccess, setResetSuccess] = useState(false)\r\n  const [resetError, setResetError] = useState<string | null>(null)\r\n  \r\n  // Store actions and data\r\n  const { resetAllStudyData } = useDeckStore()\r\n  const { resetAllUserData, userStats: gamificationStats, isInitialized, userStreak, initializeUserData } = useGamificationStore()\r\n  \r\n  // Ensure auth is initialized when component mounts\r\n  useEffect(() => {\r\n    if (!user && !isLoading) {\r\n      initializeAuth()\r\n    }\r\n  }, [user, isLoading, initializeAuth])\r\n\r\n  // Load dynamic user data function\r\n  const loadUserData = useCallback(async () => {\r\n    if (!user) return\r\n    \r\n    setDataLoading(true)\r\n    setDataError(null)\r\n    \r\n    try {\r\n      // Check if user is demo user\r\n      const isDemo = user.email === 'demo@studymaster.com' || (user as AuthenticatedUser).tokenType === 'demo'\r\n      \r\n      // Initialize gamification data based on user type\r\n      initializeUserData(isDemo)\r\n      \r\n      if (isDemo) {\r\n        // For demo users, use mock data or empty data\r\n        setUserStats(null)\r\n        setUserActivity([])\r\n        setUserAchievements([])\r\n        setUserChallenges([])\r\n      } else {\r\n        // For authenticated users, try to load from API\r\n        const authenticatedUser: AuthenticatedUser = {\r\n          ...user,\r\n          token: (user as AuthenticatedUser).token,\r\n          tokenType: (user as AuthenticatedUser).tokenType\r\n        }\r\n        \r\n        try {\r\n          const [stats, activity, achievements, challenges] = await Promise.all([\r\n            userDataService.getUserStats(authenticatedUser),\r\n            userDataService.getUserActivity(authenticatedUser, 30),\r\n            userDataService.getUserAchievements(authenticatedUser),\r\n            userDataService.getUserChallenges(authenticatedUser)\r\n          ])\r\n          \r\n          setUserStats(stats)\r\n          setUserActivity(activity)\r\n          setUserAchievements(achievements)\r\n          setUserChallenges(challenges)\r\n          \r\n        } catch (apiError) {\r\n          console.warn('API data loading failed, using fallback:', apiError)\r\n          // Fallback to empty state for authenticated users when API fails\r\n          setUserStats(null)\r\n          setUserActivity([])\r\n          setUserAchievements([])\r\n          setUserChallenges([])\r\n        }\r\n      }\r\n      \r\n    } catch (error) {\r\n      console.error('Failed to load user data:', error)\r\n      setDataError('Unable to load user statistics. Please try again later.')\r\n    } finally {\r\n      setDataLoading(false)\r\n    }\r\n  }, [user, initializeUserData])\r\n\r\n  // Load dynamic user data when user is available\r\n  useEffect(() => {\r\n    loadUserData()\r\n  }, [loadUserData])\r\n  \r\n  const [editForm, setEditForm] = useState({\r\n    username: user?.username || '',\r\n    email: user?.email || '',\r\n    dailyGoal: user?.preferences.dailyGoal || 50\r\n  })\r\n\r\n  const handleSaveProfile = () => {\r\n    if (user) {\r\n      updateUser({\r\n        username: editForm.username,\r\n        email: editForm.email,\r\n        preferences: {\r\n          ...user.preferences,\r\n          dailyGoal: editForm.dailyGoal\r\n        }\r\n      })\r\n    }\r\n    setIsEditing(false)\r\n  }\r\n\r\n  const handleResetAllData = async () => {\r\n    if (!user) return\r\n    \r\n    setIsResetting(true)\r\n    setResetError(null)\r\n    \r\n    try {\r\n      // Check if user is demo user\r\n      const isDemo = user.email === 'demo@studymaster.com' || (user as AuthenticatedUser).tokenType === 'demo'\r\n      \r\n      if (!isDemo) {\r\n        // For authenticated users, call API\r\n        const authenticatedUser: AuthenticatedUser = {\r\n          ...user,\r\n          token: (user as AuthenticatedUser).token,\r\n          tokenType: (user as AuthenticatedUser).tokenType\r\n        }\r\n        \r\n        try {\r\n          await userDataService.resetAllUserData(authenticatedUser)\r\n        } catch (apiError) {\r\n          console.warn('API reset failed, proceeding with local reset:', apiError)\r\n          // Continue with local reset even if API fails\r\n        }\r\n      }\r\n      \r\n      // Reset local store data\r\n      resetAllUserData()\r\n      resetAllStudyData()\r\n      \r\n      // Clear local user data state and reinitialize\r\n      setUserStats(null)\r\n      setUserActivity([])\r\n      setUserAchievements([])\r\n      setUserChallenges([])\r\n      setDataError(null)\r\n      \r\n      setResetSuccess(true)\r\n      setShowResetDialog(false)\r\n      \r\n      // Reload user data after reset\r\n      setTimeout(async () => {\r\n        setResetSuccess(false)\r\n        // Reinitialize gamification data and reload user data\r\n        const isDemo = user.email === 'demo@studymaster.com' || (user as AuthenticatedUser).tokenType === 'demo'\r\n        initializeUserData(isDemo)\r\n        await loadUserData()\r\n      }, 1500)\r\n      \r\n    } catch (error) {\r\n      console.error('Failed to reset user data:', error)\r\n      setResetError('Failed to reset data. Please try again.')\r\n    } finally {\r\n      setIsResetting(false)\r\n    }\r\n  }\r\n\r\n  // Show loading state while auth is being initialized\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-screen\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"></div>\r\n          <h2 className=\"text-xl text-gray-900 dark:text-white\">\r\n            Loading profile...\r\n          </h2>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (!user) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-screen\">\r\n        <div className=\"text-center\">\r\n          <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-4\">\r\n            Please log in to view your profile\r\n          </h2>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"max-w-6xl mx-auto p-6 space-y-8\">\r\n      {/* Header */}\r\n      <div className=\"text-center mb-8\">\r\n        <h1 className=\"text-4xl font-bold text-gray-900 dark:text-white mb-2\">\r\n          Profile\r\n        </h1>\r\n        <p className=\"text-gray-600 dark:text-gray-400\">\r\n          Track your progress and achievements\r\n        </p>\r\n      </div>\r\n\r\n      {/* User Info Card */}\r\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 border border-gray-200 dark:border-gray-700\">\r\n        <div className=\"flex items-center justify-between mb-6\">\r\n          <div className=\"flex items-center space-x-4\">\r\n            <div className=\"w-20 h-20 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white text-2xl font-bold\">\r\n              {user.username.charAt(0).toUpperCase()}\r\n            </div>\r\n            <div>\r\n              {isEditing ? (\r\n                <div className=\"space-y-2\">\r\n                  <input\r\n                    type=\"text\"\r\n                    value={editForm.username}\r\n                    onChange={(e) => setEditForm({ ...editForm, username: e.target.value })}\r\n                    className=\"text-2xl font-bold bg-transparent border-b border-gray-300 dark:border-gray-600 focus:outline-none focus:border-blue-500 text-gray-900 dark:text-white\"\r\n                  />\r\n                  <input\r\n                    type=\"email\"\r\n                    value={editForm.email}\r\n                    onChange={(e) => setEditForm({ ...editForm, email: e.target.value })}\r\n                    className=\"text-gray-600 dark:text-gray-400 bg-transparent border-b border-gray-300 dark:border-gray-600 focus:outline-none focus:border-blue-500\"\r\n                  />\r\n                </div>\r\n              ) : (\r\n                <div>\r\n                  <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white\">\r\n                    {user.username}\r\n                  </h2>\r\n                  <p className=\"text-gray-600 dark:text-gray-400\">{user.email}</p>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"flex items-center space-x-4\">\r\n            <div className=\"text-right\">\r\n              <div className=\"flex items-center space-x-2 text-yellow-600 dark:text-yellow-400\">\r\n                <span className=\"text-lg\">💰</span>\r\n                <span className=\"font-bold\">{gamificationStats.gold}</span>\r\n              </div>\r\n              <div className=\"flex items-center space-x-2 text-purple-600 dark:text-purple-400\">\r\n                <span className=\"text-lg\">💎</span>\r\n                <span className=\"font-bold\">{gamificationStats.diamonds}</span>\r\n              </div>\r\n            </div>\r\n            \r\n            {isEditing ? (\r\n              <div className=\"space-x-2\">\r\n                <button\r\n                  onClick={handleSaveProfile}\r\n                  className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"\r\n                >\r\n                  Save\r\n                </button>\r\n                <button\r\n                  onClick={() => setIsEditing(false)}\r\n                  className=\"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors\"\r\n                >\r\n                  Cancel\r\n                </button>\r\n              </div>\r\n            ) : (\r\n              <button\r\n                onClick={() => setIsEditing(true)}\r\n                className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"\r\n              >\r\n                Edit Profile\r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* XP Bar */}\r\n        <XPBar\r\n          currentXP={gamificationStats.xp}\r\n          level={gamificationStats.level}\r\n          className=\"mb-4\"\r\n        />\r\n        \r\n        {/* Quick Stats */}\r\n        {dataLoading ? (\r\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mt-6\">\r\n            {[...Array(4)].map((_, i) => (\r\n              <div key={i} className=\"text-center\">\r\n                <div className=\"animate-pulse bg-gray-300 dark:bg-gray-600 h-8 w-16 mx-auto rounded mb-2\"></div>\r\n                <div className=\"animate-pulse bg-gray-300 dark:bg-gray-600 h-4 w-20 mx-auto rounded\"></div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        ) : isInitialized ? (\r\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mt-6\">\r\n            <div className=\"text-center\">\r\n              <div className=\"text-2xl font-bold text-blue-600 dark:text-blue-400\">\r\n                {gamificationStats.totalCards.toLocaleString()}\r\n              </div>\r\n              <div className=\"text-sm text-gray-600 dark:text-gray-400\">Cards Studied</div>\r\n            </div>\r\n            <div className=\"text-center\">\r\n              <div className=\"text-2xl font-bold text-green-600 dark:text-green-400\">\r\n                {Math.floor(gamificationStats.totalStudyTime / 60)}h {gamificationStats.totalStudyTime % 60}m\r\n              </div>\r\n              <div className=\"text-sm text-gray-600 dark:text-gray-400\">Study Time</div>\r\n            </div>\r\n            <div className=\"text-center\">\r\n              <div className=\"text-2xl font-bold text-purple-600 dark:text-purple-400\">\r\n                {gamificationStats.averageAccuracy.toFixed(1)}%\r\n              </div>\r\n              <div className=\"text-sm text-gray-600 dark:text-gray-400\">Accuracy</div>\r\n            </div>\r\n            <div className=\"text-center\">\r\n              <div className=\"text-2xl font-bold text-orange-600 dark:text-orange-400\">\r\n                {gamificationStats.currentStreak}\r\n              </div>\r\n              <div className=\"text-sm text-gray-600 dark:text-gray-400\">Day Streak</div>\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          <div className=\"text-center py-4 text-gray-500 dark:text-gray-400\">\r\n            {dataError || 'Unable to load stats'}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Main Content Grid */}\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\r\n        {/* Left Column */}\r\n        <div className=\"lg:col-span-2 space-y-8\">\r\n          {/* Activity Chart */}\r\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 border border-gray-200 dark:border-gray-700\">\r\n            <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\r\n              Recent Activity\r\n            </h3>\r\n            \r\n            {dataLoading ? (\r\n              <div className=\"animate-pulse space-y-4\">\r\n                {[...Array(5)].map((_, i) => (\r\n                  <div key={i} className=\"flex justify-between items-center\">\r\n                    <div className=\"bg-gray-300 dark:bg-gray-600 h-4 w-20 rounded\"></div>\r\n                    <div className=\"bg-gray-300 dark:bg-gray-600 h-4 w-16 rounded\"></div>\r\n                    <div className=\"bg-gray-300 dark:bg-gray-600 h-4 w-12 rounded\"></div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            ) : userActivity.length > 0 ? (\r\n              <div className=\"space-y-3\">\r\n                {userActivity.slice(0, 10).map((activity, index) => (\r\n                  <div key={index} className=\"flex justify-between items-center py-2 border-b border-gray-100 dark:border-gray-700 last:border-b-0\">\r\n                    <div className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n                      {new Date(activity.date).toLocaleDateString()}\r\n                    </div>\r\n                    <div className=\"flex space-x-4 text-sm\">\r\n                      <span className=\"text-blue-600 dark:text-blue-400\">\r\n                        {activity.cardsStudied} cards\r\n                      </span>\r\n                      <span className=\"text-green-600 dark:text-green-400\">\r\n                        {activity.studyTime}m\r\n                      </span>\r\n                      <span className=\"text-purple-600 dark:text-purple-400\">\r\n                        {activity.accuracy}%\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            ) : (\r\n              <div className=\"text-center py-8\">\r\n                <div className=\"text-4xl mb-4\">📊</div>\r\n                <p className=\"text-gray-600 dark:text-gray-400\">\r\n                  No activity data available yet. Start studying to see your progress!\r\n                </p>\r\n              </div>\r\n            )}\r\n          </div>\r\n          \r\n          {/* Active Challenges */}\r\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 border border-gray-200 dark:border-gray-700\">\r\n            <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\r\n              Active Challenges\r\n            </h3>\r\n            \r\n            {dataLoading ? (\r\n              <div className=\"animate-pulse space-y-4\">\r\n                {[...Array(2)].map((_, i) => (\r\n                  <div key={i} className=\"border border-gray-200 dark:border-gray-600 rounded-lg p-4\">\r\n                    <div className=\"bg-gray-300 dark:bg-gray-600 h-6 w-3/4 rounded mb-2\"></div>\r\n                    <div className=\"bg-gray-300 dark:bg-gray-600 h-4 w-full rounded mb-3\"></div>\r\n                    <div className=\"bg-gray-300 dark:bg-gray-600 h-2 w-full rounded\"></div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            ) : userChallenges.length > 0 ? (\r\n              <div className=\"space-y-4\">\r\n                {userChallenges.map((challenge) => {\r\n                  const progressPercentage = Math.min((challenge.current / challenge.target) * 100, 100)\r\n                  \r\n                  return (\r\n                    <div key={challenge.id} className=\"border border-gray-200 dark:border-gray-600 rounded-lg p-4\">\r\n                      <div className=\"flex justify-between items-start mb-2\">\r\n                        <div>\r\n                          <h4 className=\"font-semibold text-gray-900 dark:text-white\">\r\n                            {challenge.name}\r\n                          </h4>\r\n                          <p className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n                            {challenge.description}\r\n                          </p>\r\n                        </div>\r\n                        <span className={`px-2 py-1 rounded-full text-xs font-medium ${\r\n                          challenge.completedAt \r\n                            ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200'\r\n                            : 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200'\r\n                        }`}>\r\n                          {challenge.completedAt ? 'Completed' : challenge.type}\r\n                        </span>\r\n                      </div>\r\n                      \r\n                      <div className=\"space-y-2\">\r\n                        <div className=\"flex justify-between text-sm\">\r\n                          <span className=\"text-gray-600 dark:text-gray-400\">\r\n                            Progress\r\n                          </span>\r\n                          <span className=\"font-medium text-gray-900 dark:text-white\">\r\n                            {challenge.current} / {challenge.target}\r\n                          </span>\r\n                        </div>\r\n                        <div className=\"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2\">\r\n                          <div \r\n                            className=\"bg-blue-600 h-2 rounded-full transition-all duration-500\"\r\n                            style={{ width: `${progressPercentage}%` }}\r\n                          />\r\n                        </div>\r\n                      </div>\r\n                      \r\n                      <div className=\"flex items-center space-x-4 mt-3 text-sm text-gray-600 dark:text-gray-400\">\r\n                        <span>+{challenge.reward.xp} XP</span>\r\n                        <span>+{challenge.reward.coins} coins</span>\r\n                        {challenge.reward.gems && <span>+{challenge.reward.gems} gems</span>}\r\n                      </div>\r\n                    </div>\r\n                  )\r\n                })}\r\n              </div>\r\n            ) : (\r\n              <div className=\"text-center py-8\">\r\n                <div className=\"text-4xl mb-4\">🎯</div>\r\n                <p className=\"text-gray-600 dark:text-gray-400\">\r\n                  No active challenges. Check the Challenges page to join some!\r\n                </p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Right Column */}\r\n        <div className=\"space-y-8\">\r\n          {/* Streak Counter */}\r\n          <StreakCounter\r\n            currentStreak={gamificationStats.currentStreak}\r\n            longestStreak={gamificationStats.longestStreak}\r\n            lastStudyDate={userStreak?.lastStudyDate || new Date().toISOString()}\r\n          />\r\n          \r\n          {/* Achievements */}\r\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 border border-gray-200 dark:border-gray-700\">\r\n            <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\r\n              Achievements ({userAchievements.length})\r\n            </h3>\r\n            \r\n            {dataLoading ? (\r\n              <div className=\"animate-pulse grid grid-cols-4 gap-3\">\r\n                {[...Array(8)].map((_, i) => (\r\n                  <div key={i} className=\"bg-gray-300 dark:bg-gray-600 h-16 w-16 rounded-lg\"></div>\r\n                ))}\r\n              </div>\r\n            ) : userAchievements.length > 0 ? (\r\n              <div className=\"grid grid-cols-4 gap-3\">\r\n                {userAchievements.map((achievement) => (\r\n                  <div\r\n                    key={achievement.id}\r\n                    className=\"bg-gradient-to-br from-yellow-400 to-orange-500 rounded-lg p-3 text-center text-white shadow-lg\"\r\n                    title={`${achievement.name}: ${achievement.description}`}\r\n                  >\r\n                    <div className=\"text-2xl mb-1\">{achievement.icon}</div>\r\n                    <div className=\"text-xs font-medium truncate\">{achievement.name}</div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            ) : (\r\n              <div className=\"text-center py-8\">\r\n                <div className=\"text-4xl mb-4\">🏆</div>\r\n                <p className=\"text-gray-600 dark:text-gray-400\">\r\n                  No achievements yet. Keep studying to unlock them!\r\n                </p>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Settings */}\r\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 border border-gray-200 dark:border-gray-700\">\r\n            <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\r\n              Study Settings\r\n            </h3>\r\n            \r\n            <div className=\"space-y-4\">\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                  Daily Goal\r\n                </label>\r\n                {isEditing ? (\r\n                  <input\r\n                    type=\"number\"\r\n                    value={editForm.dailyGoal}\r\n                    onChange={(e) => setEditForm({ ...editForm, dailyGoal: parseInt(e.target.value) || 50 })}\r\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\r\n                    min=\"1\"\r\n                    max=\"500\"\r\n                  />\r\n                ) : (\r\n                  <div className=\"text-2xl font-bold text-blue-600 dark:text-blue-400\">\r\n                    {user.preferences.dailyGoal} cards\r\n                  </div>\r\n                )}\r\n              </div>\r\n              \r\n              <div className=\"flex items-center justify-between\">\r\n                <span className=\"text-sm text-gray-700 dark:text-gray-300\">\r\n                  Notifications\r\n                </span>\r\n                <div className={`w-12 h-6 rounded-full transition-colors ${\r\n                  user.preferences.notifications \r\n                    ? 'bg-blue-600' \r\n                    : 'bg-gray-300 dark:bg-gray-600'\r\n                }`}>\r\n                  <div className={`w-5 h-5 bg-white rounded-full shadow-md transform transition-transform ${\r\n                    user.preferences.notifications ? 'translate-x-6' : 'translate-x-0.5'\r\n                  } mt-0.5`} />\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"flex items-center justify-between\">\r\n                <span className=\"text-sm text-gray-700 dark:text-gray-300\">\r\n                  Sound Effects\r\n                </span>\r\n                <div className={`w-12 h-6 rounded-full transition-colors ${\r\n                  user.preferences.soundEffects \r\n                    ? 'bg-blue-600' \r\n                    : 'bg-gray-300 dark:bg-gray-600'\r\n                }`}>\r\n                  <div className={`w-5 h-5 bg-white rounded-full shadow-md transform transition-transform ${\r\n                    user.preferences.soundEffects ? 'translate-x-6' : 'translate-x-0.5'\r\n                  } mt-0.5`} />\r\n                </div>\r\n              </div>\r\n            </div>\r\n            \r\n            {/* Reset Data Section */}\r\n            <div className=\"mt-8 pt-6 border-t border-gray-200 dark:border-gray-700\">\r\n              <h4 className=\"text-md font-semibold text-gray-900 dark:text-white mb-3\">\r\n                Data Management\r\n              </h4>\r\n              <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4\">\r\n                <div className=\"flex items-start space-x-3\">\r\n                  <div className=\"flex-shrink-0\">\r\n                    <span className=\"text-red-500 text-xl\">⚠️</span>\r\n                  </div>\r\n                  <div className=\"flex-1\">\r\n                    <h5 className=\"text-sm font-medium text-red-800 dark:text-red-200 mb-1\">\r\n                      Reset All Statistics\r\n                    </h5>\r\n                    <p className=\"text-sm text-red-700 dark:text-red-300 mb-3\">\r\n                      This will permanently delete all your study progress, achievements, streaks, and performance data. This action cannot be undone.\r\n                    </p>\r\n                    <button\r\n                      onClick={() => setShowResetDialog(true)}\r\n                      disabled={isResetting}\r\n                      className=\"px-4 py-2 bg-red-600 text-white text-sm rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2\"\r\n                    >\r\n                      {isResetting && (\r\n                        <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white\"></div>\r\n                      )}\r\n                      <span>Reset All Data</span>\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Success Message */}\r\n      {resetSuccess && (\r\n        <div className=\"fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 flex items-center space-x-2\">\r\n          <span className=\"text-lg\">✅</span>\r\n          <span>All statistics have been reset successfully!</span>\r\n        </div>\r\n      )}\r\n\r\n      {/* Error Message */}\r\n      {resetError && (\r\n        <div className=\"fixed top-4 right-4 bg-red-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 flex items-center space-x-2\">\r\n          <span className=\"text-lg\">❌</span>\r\n          <span>{resetError}</span>\r\n          <button\r\n            onClick={() => setResetError(null)}\r\n            className=\"ml-2 text-white hover:text-gray-200\"\r\n          >\r\n            ×\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {/* Reset Confirmation Dialog */}\r\n      <ConfirmationDialog\r\n        isOpen={showResetDialog}\r\n        onClose={() => setShowResetDialog(false)}\r\n        onConfirm={handleResetAllData}\r\n        title=\"Reset All Statistics\"\r\n        message=\"Are you absolutely sure you want to reset all your statistics? This will permanently delete all your study progress, achievements, streaks, challenge progress, and performance data. This action cannot be undone and you will lose all your current progress.\"\r\n        confirmText=\"Yes, Reset Everything\"\r\n        cancelText=\"Cancel\"\r\n        isDestructive={true}\r\n        isLoading={isResetting}\r\n      />\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default ProfilePage","import React, { useState, useEffect } from 'react'\r\nimport { useAuthStore } from '../stores/authStore'\r\nimport { userDataService, type AuthenticatedUser, type UserChallenge } from '../services/userDataService'\r\nimport { MonthlyChallenge } from '../components/gamification/MonthlyChallenge'\r\nimport { CommunityLeaderboard } from '../components/gamification/CommunityLeaderboard'\r\n\r\nconst ChallengesPage: React.FC = () => {\r\n  const { user } = useAuthStore()\r\n  \r\n  // Dynamic data state\r\n  const [userChallenges, setUserChallenges] = useState<UserChallenge[]>([])\r\n  const [dataLoading, setDataLoading] = useState(false)\r\n  const [dataError, setDataError] = useState<string | null>(null)\r\n  \r\n  const [filter, setFilter] = useState<'all' | 'active' | 'completed' | 'available'>('all')\r\n  const [sortBy, setSortBy] = useState<'expiresAt' | 'reward' | 'progress'>('expiresAt')\r\n\r\n  // Load dynamic challenge data when user is available\r\n  useEffect(() => {\r\n    const loadChallengeData = async () => {\r\n      if (!user) return\r\n      \r\n      setDataLoading(true)\r\n      setDataError(null)\r\n      \r\n      try {\r\n        const authenticatedUser: AuthenticatedUser = {\r\n          ...user,\r\n          token: (user as AuthenticatedUser).token,\r\n          tokenType: (user as AuthenticatedUser).tokenType\r\n        }\r\n        \r\n        const challenges = await userDataService.getUserChallenges(authenticatedUser)\r\n        setUserChallenges(challenges)\r\n      } catch (error) {\r\n        console.error('Failed to load challenge data:', error)\r\n        setDataError('Failed to load challenge data')\r\n      } finally {\r\n        setDataLoading(false)\r\n      }\r\n    }\r\n    \r\n    loadChallengeData()\r\n  }, [user])\r\n\r\n  const getFilteredChallenges = () => {\r\n    let filtered = userChallenges\r\n\r\n    // Apply filter\r\n    switch (filter) {\r\n      case 'active':\r\n        filtered = userChallenges.filter(challenge => !challenge.completedAt && new Date(challenge.expiresAt) > new Date())\r\n        break\r\n      case 'completed':\r\n        filtered = userChallenges.filter(challenge => challenge.completedAt)\r\n        break\r\n      case 'available':\r\n        filtered = userChallenges.filter(challenge => !challenge.completedAt)\r\n        break\r\n      default:\r\n        // 'all' - no filtering\r\n        break\r\n    }\r\n\r\n    // Apply sorting\r\n    return filtered.sort((a, b) => {\r\n      switch (sortBy) {\r\n        case 'expiresAt':\r\n          return new Date(a.expiresAt).getTime() - new Date(b.expiresAt).getTime()\r\n        case 'reward': {\r\n          const aRewardValue = a.reward.xp + a.reward.coins + (a.reward.gems || 0) * 10\r\n          const bRewardValue = b.reward.xp + b.reward.coins + (b.reward.gems || 0) * 10\r\n          return bRewardValue - aRewardValue\r\n        }\r\n        case 'progress': {\r\n          const aProgress = (a.current / a.target) * 100\r\n          const bProgress = (b.current / b.target) * 100\r\n          return bProgress - aProgress\r\n        }\r\n        default:\r\n          return 0\r\n      }\r\n    })\r\n  }\r\n\r\n  const getFilterCount = (filterType: typeof filter) => {\r\n    switch (filterType) {\r\n      case 'active':\r\n        return userChallenges.filter(challenge => !challenge.completedAt && new Date(challenge.expiresAt) > new Date()).length\r\n      case 'completed':\r\n        return userChallenges.filter(challenge => challenge.completedAt).length\r\n      case 'available':\r\n        return userChallenges.filter(challenge => !challenge.completedAt).length\r\n      default:\r\n        return userChallenges.length\r\n    }\r\n  }\r\n\r\n  const getProgressPercentage = (challenge: UserChallenge) => {\r\n    return Math.min((challenge.current / challenge.target) * 100, 100)\r\n  }\r\n\r\n  const isExpired = (challenge: UserChallenge) => {\r\n    return new Date(challenge.expiresAt) < new Date()\r\n  }\r\n\r\n  const getTimeRemaining = (challenge: UserChallenge) => {\r\n    const now = new Date()\r\n    const expires = new Date(challenge.expiresAt)\r\n    const diff = expires.getTime() - now.getTime()\r\n    \r\n    if (diff <= 0) return 'Expired'\r\n    \r\n    const days = Math.floor(diff / (1000 * 60 * 60 * 24))\r\n    const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60))\r\n    \r\n    if (days > 0) return `${days}d ${hours}h`\r\n    return `${hours}h`\r\n  }\r\n\r\n  const filteredChallenges = getFilteredChallenges()\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900 py-8\">\r\n      <div className=\"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8\">\r\n        {/* Header */}\r\n        <div className=\"mb-8\">\r\n          <h1 className=\"text-3xl font-bold text-gray-900 dark:text-white mb-2\">\r\n            🏆 Challenges\r\n          </h1>\r\n          <p className=\"text-gray-600 dark:text-gray-400\">\r\n            Complete challenges to earn XP, achievements, and compete with other learners\r\n          </p>\r\n        </div>\r\n\r\n        {/* Stats Overview */}\r\n        {dataLoading ? (\r\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8\">\r\n            {[...Array(4)].map((_, i) => (\r\n              <div key={i} className=\"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700\">\r\n                <div className=\"animate-pulse bg-gray-300 dark:bg-gray-600 h-8 w-12 rounded mb-2\"></div>\r\n                <div className=\"animate-pulse bg-gray-300 dark:bg-gray-600 h-4 w-16 rounded\"></div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        ) : (\r\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8\">\r\n            <div className=\"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700\">\r\n              <div className=\"text-2xl font-bold text-blue-600 dark:text-blue-400\">\r\n                {userChallenges.length}\r\n              </div>\r\n              <div className=\"text-sm text-gray-600 dark:text-gray-400\">Total</div>\r\n            </div>\r\n            \r\n            <div className=\"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700\">\r\n              <div className=\"text-2xl font-bold text-green-600 dark:text-green-400\">\r\n                {userChallenges.filter(c => c.completedAt).length}\r\n              </div>\r\n              <div className=\"text-sm text-gray-600 dark:text-gray-400\">Completed</div>\r\n            </div>\r\n            \r\n            <div className=\"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700\">\r\n              <div className=\"text-2xl font-bold text-orange-600 dark:text-orange-400\">\r\n                {userChallenges.filter(c => !c.completedAt && new Date(c.expiresAt) > new Date()).length}\r\n              </div>\r\n              <div className=\"text-sm text-gray-600 dark:text-gray-400\">Active</div>\r\n            </div>\r\n            \r\n            <div className=\"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700\">\r\n              <div className=\"text-2xl font-bold text-purple-600 dark:text-purple-400\">\r\n                {userChallenges.filter(c => new Date(c.expiresAt) < new Date()).length}\r\n              </div>\r\n              <div className=\"text-sm text-gray-600 dark:text-gray-400\">Expired</div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Filters and Sorting */}\r\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg p-4 mb-6 border border-gray-200 dark:border-gray-700\">\r\n          <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0\">\r\n            {/* Filter Tabs */}\r\n            <div className=\"flex space-x-1 bg-gray-100 dark:bg-gray-700 rounded-lg p-1\">\r\n              {(['all', 'active', 'completed', 'available'] as const).map((filterType) => (\r\n                <button\r\n                  key={filterType}\r\n                  onClick={() => setFilter(filterType)}\r\n                  className={`px-3 py-2 rounded-md text-sm font-medium transition-colors ${\r\n                    filter === filterType\r\n                      ? 'bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow-sm'\r\n                      : 'text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white'\r\n                  }`}\r\n                >\r\n                  {filterType.charAt(0).toUpperCase() + filterType.slice(1)} ({getFilterCount(filterType)})\r\n                </button>\r\n              ))}\r\n            </div>\r\n\r\n            {/* Sort Dropdown */}\r\n            <div className=\"flex items-center space-x-2\">\r\n              <span className=\"text-sm text-gray-600 dark:text-gray-400\">Sort by:</span>\r\n              <select\r\n                value={sortBy}\r\n                onChange={(e) => setSortBy(e.target.value as typeof sortBy)}\r\n                className=\"bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 text-sm text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n              >\r\n                <option value=\"expiresAt\">Time Remaining</option>\r\n                <option value=\"reward\">Reward Value</option>\r\n                <option value=\"progress\">Progress</option>\r\n              </select>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Challenges Grid */}\r\n        {dataLoading ? (\r\n          <div className=\"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6\">\r\n            {[...Array(6)].map((_, i) => (\r\n              <div key={i} className=\"bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700\">\r\n                <div className=\"animate-pulse space-y-4\">\r\n                  <div className=\"bg-gray-300 dark:bg-gray-600 h-6 w-3/4 rounded\"></div>\r\n                  <div className=\"bg-gray-300 dark:bg-gray-600 h-4 w-full rounded\"></div>\r\n                  <div className=\"bg-gray-300 dark:bg-gray-600 h-2 w-full rounded\"></div>\r\n                  <div className=\"bg-gray-300 dark:bg-gray-600 h-8 w-1/2 rounded\"></div>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        ) : filteredChallenges.length === 0 ? (\r\n          <div className=\"text-center py-12\">\r\n            <div className=\"text-6xl mb-4\">🎯</div>\r\n            <h3 className=\"text-xl font-semibold text-gray-900 dark:text-white mb-2\">\r\n              {dataError ? 'Unable to Load Challenges' : 'No challenges found'}\r\n            </h3>\r\n            <p className=\"text-gray-600 dark:text-gray-400\">\r\n              {dataError || (filter === 'all' \r\n                ? 'No challenges are currently available.'\r\n                : `No ${filter} challenges found. Try a different filter.`\r\n              )}\r\n            </p>\r\n          </div>\r\n        ) : (\r\n          <div className=\"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6\">\r\n            {filteredChallenges.map((challenge) => {\r\n              const progressPercentage = getProgressPercentage(challenge)\r\n              const expired = isExpired(challenge)\r\n              \r\n              return (\r\n                <div\r\n                  key={challenge.id}\r\n                  className={`bg-white dark:bg-gray-800 rounded-lg p-6 border transition-all duration-200 hover:shadow-lg ${\r\n                    challenge.completedAt\r\n                      ? 'border-green-200 dark:border-green-800 bg-green-50 dark:bg-green-900/20'\r\n                      : expired\r\n                      ? 'border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-900/20'\r\n                      : 'border-gray-200 dark:border-gray-700 hover:border-blue-300 dark:hover:border-blue-600'\r\n                  }`}\r\n                >\r\n                  {/* Header */}\r\n                  <div className=\"flex items-start justify-between mb-4\">\r\n                    <div className=\"flex-1\">\r\n                      <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-1\">\r\n                        {challenge.name}\r\n                      </h3>\r\n                      <p className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n                        {challenge.description}\r\n                      </p>\r\n                    </div>\r\n                    <span className={`px-2 py-1 rounded-full text-xs font-medium ml-2 ${\r\n                      challenge.completedAt\r\n                        ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200'\r\n                        : expired\r\n                        ? 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200'\r\n                        : challenge.type === 'daily'\r\n                        ? 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200'\r\n                        : challenge.type === 'weekly'\r\n                        ? 'bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200'\r\n                        : 'bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200'\r\n                    }`}>\r\n                      {challenge.completedAt ? 'Completed' : expired ? 'Expired' : challenge.type}\r\n                    </span>\r\n                  </div>\r\n\r\n                  {/* Progress */}\r\n                  <div className=\"mb-4\">\r\n                    <div className=\"flex justify-between text-sm mb-2\">\r\n                      <span className=\"text-gray-600 dark:text-gray-400\">Progress</span>\r\n                      <span className=\"font-medium text-gray-900 dark:text-white\">\r\n                        {challenge.current} / {challenge.target}\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2\">\r\n                      <div \r\n                        className={`h-2 rounded-full transition-all duration-500 ${\r\n                          challenge.completedAt\r\n                            ? 'bg-green-600'\r\n                            : expired\r\n                            ? 'bg-red-600'\r\n                            : 'bg-blue-600'\r\n                        }`}\r\n                        style={{ width: `${progressPercentage}%` }}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Rewards */}\r\n                  <div className=\"mb-4\">\r\n                    <div className=\"text-sm text-gray-600 dark:text-gray-400 mb-2\">Rewards</div>\r\n                    <div className=\"flex items-center space-x-4 text-sm\">\r\n                      <span className=\"text-blue-600 dark:text-blue-400\">\r\n                        +{challenge.reward.xp} XP\r\n                      </span>\r\n                      <span className=\"text-yellow-600 dark:text-yellow-400\">\r\n                        +{challenge.reward.coins} coins\r\n                      </span>\r\n                      {challenge.reward.gems && (\r\n                        <span className=\"text-purple-600 dark:text-purple-400\">\r\n                          +{challenge.reward.gems} gems\r\n                        </span>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Time Remaining */}\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div className=\"text-sm\">\r\n                      <span className=\"text-gray-600 dark:text-gray-400\">\r\n                        {expired ? 'Expired' : 'Time remaining: '}\r\n                      </span>\r\n                      <span className={`font-medium ${\r\n                        expired \r\n                          ? 'text-red-600 dark:text-red-400'\r\n                          : 'text-gray-900 dark:text-white'\r\n                      }`}>\r\n                        {expired ? '' : getTimeRemaining(challenge)}\r\n                      </span>\r\n                    </div>\r\n                    \r\n                    {challenge.completedAt && (\r\n                      <div className=\"text-green-600 dark:text-green-400 text-2xl\">\r\n                        ✅\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              )\r\n            })}\r\n          </div>\r\n        )}\r\n\r\n        {/* Monthly Challenge Section */}\r\n        <div className=\"mt-12\">\r\n          <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-6\">\r\n            🌟 Monthly Challenge\r\n          </h2>\r\n          <MonthlyChallenge challenge={{\r\n            id: \"monthly-2025-01\",\r\n            title: \"January Learning Marathon\",\r\n            description: \"Master new knowledge throughout January with progressive challenges\",\r\n            type: \"monthly\" as const,\r\n            requirements: [],\r\n            rewards: [],\r\n            startDate: \"2025-01-01T00:00:00Z\",\r\n            endDate: \"2025-01-31T23:59:59Z\",\r\n            isActive: true,\r\n            participantCount: 47892,\r\n            difficulty: \"intermediate\" as const,\r\n            storyArc: {\r\n              id: \"winter-learning-saga\",\r\n              title: \"Winter Learning Saga\",\r\n              description: \"Embark on a month-long journey of discovery\",\r\n              theme: \"winter\",\r\n              chapters: [],\r\n              totalWeeks: 4,\r\n              currentWeek: 2\r\n            }\r\n          }} />\r\n        </div>\r\n\r\n        {/* Community Leaderboard Section */}\r\n        <div className=\"mt-12\">\r\n          <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-6\">\r\n            🏆 Community Leaderboard\r\n          </h2>\r\n          <CommunityLeaderboard\r\n            challengeId=\"monthly-2025-01\"\r\n            challengeName=\"January Learning Marathon\"\r\n          />\r\n        </div>\r\n\r\n        {/* Help Section */}\r\n        <div className=\"mt-12 bg-blue-50 dark:bg-blue-900/20 rounded-lg p-6 border border-blue-200 dark:border-blue-800\">\r\n          <h3 className=\"text-lg font-semibold text-blue-900 dark:text-blue-100 mb-3\">\r\n            💡 How Challenges Work\r\n          </h3>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-blue-800 dark:text-blue-200\">\r\n            <div>\r\n              <h4 className=\"font-medium mb-2\">🎯 Challenge Types</h4>\r\n              <ul className=\"space-y-1\">\r\n                <li>• <strong>Daily:</strong> Reset every 24 hours</li>\r\n                <li>• <strong>Weekly:</strong> Reset every Monday</li>\r\n                <li>• <strong>Monthly:</strong> Reset on the 1st</li>\r\n                <li>• <strong>Special:</strong> Limited-time events</li>\r\n              </ul>\r\n            </div>\r\n            <div>\r\n              <h4 className=\"font-medium mb-2\">🏆 Rewards</h4>\r\n              <ul className=\"space-y-1\">\r\n                <li>• <strong>XP:</strong> Experience points for leveling up</li>\r\n                <li>• <strong>Coins:</strong> In-app currency</li>\r\n                <li>• <strong>Gems:</strong> Premium currency</li>\r\n                <li>• <strong>Achievements:</strong> Unlock special badges</li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default ChallengesPage","import { useState, useEffect } from 'react'\r\nimport { useAuthStore } from '../stores/authStore'\r\nimport { userDataService, type AuthenticatedUser, type LeaderboardData, type LeaderboardEntry } from '../services/userDataService'\r\n\r\ntype LeaderboardType = 'global' | 'friends' | 'weekly' | 'monthly'\r\n\r\nconst LeaderboardPage = () => {\r\n  const { user } = useAuthStore()\r\n  \r\n  // Dynamic data state\r\n  const [leaderboardData, setLeaderboardData] = useState<LeaderboardData | null>(null)\r\n  const [dataLoading, setDataLoading] = useState(false)\r\n  const [dataError, setDataError] = useState<string | null>(null)\r\n  \r\n  const [selectedType, setSelectedType] = useState<LeaderboardType>('global')\r\n  \r\n  // Load dynamic leaderboard data when user is available\r\n  useEffect(() => {\r\n    const loadLeaderboardData = async () => {\r\n      if (!user) return\r\n      \r\n      setDataLoading(true)\r\n      setDataError(null)\r\n      \r\n      try {\r\n        const authenticatedUser: AuthenticatedUser = {\r\n          ...user,\r\n          token: (user as AuthenticatedUser).token,\r\n          tokenType: (user as AuthenticatedUser).tokenType\r\n        }\r\n        \r\n        const data = await userDataService.getLeaderboardData(authenticatedUser)\r\n        setLeaderboardData(data)\r\n      } catch (error) {\r\n        console.error('Failed to load leaderboard data:', error)\r\n        setDataError('Failed to load leaderboard data')\r\n      } finally {\r\n        setDataLoading(false)\r\n      }\r\n    }\r\n    \r\n    loadLeaderboardData()\r\n  }, [user])\r\n  \r\n  const leaderboardTypes: { value: LeaderboardType; label: string; icon: string; description: string }[] = [\r\n    { value: 'global', label: 'Global Rankings', icon: '🌍', description: 'Compete with all users worldwide' },\r\n    { value: 'friends', label: 'Friends', icon: '👥', description: 'Compare with your friends' },\r\n    { value: 'weekly', label: 'This Week', icon: '📅', description: 'Weekly performance rankings' },\r\n    { value: 'monthly', label: 'This Month', icon: '📊', description: 'Monthly achievement rankings' }\r\n  ]\r\n  \r\n  const getCurrentLeaderboard = (): LeaderboardEntry[] => {\r\n    if (!leaderboardData) return []\r\n    return leaderboardData[selectedType] || []\r\n  }\r\n  \r\n  const currentLeaderboard = getCurrentLeaderboard()\r\n  \r\n  const getRankIcon = (rank: number) => {\r\n    switch (rank) {\r\n      case 1: return '🥇'\r\n      case 2: return '🥈'\r\n      case 3: return '🥉'\r\n      default: return `#${rank}`\r\n    }\r\n  }\r\n  \r\n  const getRankColor = (rank: number) => {\r\n    switch (rank) {\r\n      case 1: return 'text-yellow-600 dark:text-yellow-400'\r\n      case 2: return 'text-gray-600 dark:text-gray-400'\r\n      case 3: return 'text-orange-600 dark:text-orange-400'\r\n      default: return 'text-gray-700 dark:text-gray-300'\r\n    }\r\n  }\r\n  \r\n  const getChangeIcon = (change: number) => {\r\n    if (change > 0) return '📈'\r\n    if (change < 0) return '📉'\r\n    return '➖'\r\n  }\r\n  \r\n  const getChangeColor = (change: number) => {\r\n    if (change > 0) return 'text-green-600 dark:text-green-400'\r\n    if (change < 0) return 'text-red-600 dark:text-red-400'\r\n    return 'text-gray-500 dark:text-gray-400'\r\n  }\r\n  \r\n  const formatScore = (score: number) => {\r\n    return score.toLocaleString() + ' XP'\r\n  }\r\n  \r\n  const currentUserEntry = currentLeaderboard.find(entry => entry.userId === user?.id)\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto p-6 space-y-8\">\r\n      {/* Header */}\r\n      <div className=\"text-center mb-8\">\r\n        <h1 className=\"text-4xl font-bold text-gray-900 dark:text-white mb-2\">\r\n          🏆 Leaderboard\r\n        </h1>\r\n        <p className=\"text-gray-600 dark:text-gray-400\">\r\n          Compete with other learners and climb the ranks!\r\n        </p>\r\n      </div>\r\n\r\n      {/* Filters */}\r\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 border border-gray-200 dark:border-gray-700\">\r\n        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\r\n          Leaderboard Category\r\n        </h3>\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n          {leaderboardTypes.map((type) => (\r\n            <button\r\n              key={type.value}\r\n              onClick={() => setSelectedType(type.value)}\r\n              className={`p-4 rounded-lg border-2 transition-all duration-200 text-left ${\r\n                selectedType === type.value\r\n                  ? 'border-blue-500 bg-blue-50 dark:bg-blue-900/20'\r\n                  : 'border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500'\r\n              }`}\r\n            >\r\n              <div className=\"flex items-center space-x-2 mb-2\">\r\n                <span className=\"text-2xl\">{type.icon}</span>\r\n                <span className=\"font-medium text-gray-900 dark:text-white\">\r\n                  {type.label}\r\n                </span>\r\n              </div>\r\n              <p className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n                {type.description}\r\n              </p>\r\n            </button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Current User Position */}\r\n      {currentUserEntry && (\r\n        <div className=\"bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg shadow-lg p-6 text-white\">\r\n          <h3 className=\"text-lg font-semibold mb-4\">Your Position</h3>\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center space-x-4\">\r\n              <div className=\"w-12 h-12 bg-white/20 rounded-full flex items-center justify-center text-2xl font-bold\">\r\n                {currentUserEntry.username.charAt(0).toUpperCase()}\r\n              </div>\r\n              <div>\r\n                <div className=\"font-bold text-lg\">{currentUserEntry.username}</div>\r\n                <div className=\"text-blue-100\">\r\n                  {formatScore(currentUserEntry.score)}\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"text-right\">\r\n              <div className=\"text-3xl font-bold\">\r\n                {getRankIcon(currentUserEntry.rank)}\r\n              </div>\r\n              <div className=\"text-sm text-blue-100 flex items-center space-x-1\">\r\n                <span>{getChangeIcon(currentUserEntry.change)}</span>\r\n                <span>\r\n                  {currentUserEntry.change === 0 \r\n                    ? 'No change' \r\n                    : `${Math.abs(currentUserEntry.change)} ${currentUserEntry.change > 0 ? 'up' : 'down'}`\r\n                  }\r\n                </span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Leaderboard */}\r\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden\">\r\n        <div className=\"p-6 border-b border-gray-200 dark:border-gray-700\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\r\n              {leaderboardTypes.find(t => t.value === selectedType)?.label}\r\n            </h3>\r\n            {!dataLoading && leaderboardData && (\r\n              <div className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                Updated recently\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n        \r\n        {dataLoading ? (\r\n          <div className=\"p-8\">\r\n            <div className=\"space-y-4\">\r\n              {[...Array(10)].map((_, i) => (\r\n                <div key={i} className=\"flex items-center justify-between p-4\">\r\n                  <div className=\"flex items-center space-x-4\">\r\n                    <div className=\"animate-pulse bg-gray-300 dark:bg-gray-600 h-8 w-8 rounded\"></div>\r\n                    <div className=\"animate-pulse bg-gray-300 dark:bg-gray-600 h-10 w-10 rounded-full\"></div>\r\n                    <div className=\"space-y-2\">\r\n                      <div className=\"animate-pulse bg-gray-300 dark:bg-gray-600 h-4 w-24 rounded\"></div>\r\n                      <div className=\"animate-pulse bg-gray-300 dark:bg-gray-600 h-3 w-16 rounded\"></div>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"animate-pulse bg-gray-300 dark:bg-gray-600 h-4 w-8 rounded\"></div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        ) : currentLeaderboard.length > 0 ? (\r\n          <div className=\"divide-y divide-gray-200 dark:divide-gray-700\">\r\n            {currentLeaderboard.map((entry) => (\r\n              <div\r\n                key={entry.userId}\r\n                className={`p-4 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors ${\r\n                  entry.userId === user?.id ? 'bg-blue-50 dark:bg-blue-900/20' : ''\r\n                }`}\r\n              >\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div className=\"flex items-center space-x-4\">\r\n                    {/* Rank */}\r\n                    <div className={`text-2xl font-bold ${getRankColor(entry.rank)} min-w-[3rem] text-center`}>\r\n                      {getRankIcon(entry.rank)}\r\n                    </div>\r\n                    \r\n                    {/* User Info */}\r\n                    <div className=\"flex items-center space-x-3\">\r\n                      <div className=\"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold\">\r\n                        {entry.username.charAt(0).toUpperCase()}\r\n                      </div>\r\n                      <div>\r\n                        <div className=\"font-semibold text-gray-900 dark:text-white\">\r\n                          {entry.username}\r\n                          {entry.userId === user?.id && (\r\n                            <span className=\"ml-2 text-xs bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 px-2 py-1 rounded-full\">\r\n                              You\r\n                            </span>\r\n                          )}\r\n                        </div>\r\n                        <div className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n                          {formatScore(entry.score)}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  {/* Change Indicator */}\r\n                  <div className={`text-sm font-medium ${getChangeColor(entry.change)} flex items-center space-x-1`}>\r\n                    <span className=\"text-lg\">{getChangeIcon(entry.change)}</span>\r\n                    <span>\r\n                      {entry.change === 0 \r\n                        ? '—' \r\n                        : `${Math.abs(entry.change)}`\r\n                      }\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        ) : (\r\n          <div className=\"p-8 text-center\">\r\n            <div className=\"text-4xl mb-4\">📊</div>\r\n            <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-2\">\r\n              {dataError ? 'Unable to Load Data' : 'No Data Available'}\r\n            </h3>\r\n            <p className=\"text-gray-600 dark:text-gray-400\">\r\n              {dataError || 'Leaderboard data for this category is not available yet.'}\r\n            </p>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Info Cards */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 border border-gray-200 dark:border-gray-700\">\r\n          <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\r\n            How Rankings Work\r\n          </h3>\r\n          <div className=\"space-y-3 text-sm text-gray-600 dark:text-gray-400\">\r\n            <div className=\"flex items-start space-x-2\">\r\n              <span className=\"text-blue-500 mt-1\">•</span>\r\n              <span>Rankings update regularly based on your study activity</span>\r\n            </div>\r\n            <div className=\"flex items-start space-x-2\">\r\n              <span className=\"text-blue-500 mt-1\">•</span>\r\n              <span>XP is earned through studying, accuracy bonuses, and streaks</span>\r\n            </div>\r\n            <div className=\"flex items-start space-x-2\">\r\n              <span className=\"text-blue-500 mt-1\">•</span>\r\n              <span>Global rankings include all StudyMaster users</span>\r\n            </div>\r\n            <div className=\"flex items-start space-x-2\">\r\n              <span className=\"text-blue-500 mt-1\">•</span>\r\n              <span>Weekly and monthly rankings reset at the start of each period</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 border border-gray-200 dark:border-gray-700\">\r\n          <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\r\n            Climb the Ranks\r\n          </h3>\r\n          <div className=\"space-y-3 text-sm text-gray-600 dark:text-gray-400\">\r\n            <div className=\"flex items-start space-x-2\">\r\n              <span className=\"text-green-500 mt-1\">•</span>\r\n              <span>Study consistently to maintain and improve your streak</span>\r\n            </div>\r\n            <div className=\"flex items-start space-x-2\">\r\n              <span className=\"text-green-500 mt-1\">•</span>\r\n              <span>Focus on accuracy to maximize your XP gains</span>\r\n            </div>\r\n            <div className=\"flex items-start space-x-2\">\r\n              <span className=\"text-green-500 mt-1\">•</span>\r\n              <span>Complete challenges for bonus XP and achievements</span>\r\n            </div>\r\n            <div className=\"flex items-start space-x-2\">\r\n              <span className=\"text-green-500 mt-1\">•</span>\r\n              <span>Invite friends to compete in the friends leaderboard</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default LeaderboardPage","import RealTimeStatsCard from '../components/dashboard/RealTimeStatsCard'\r\nimport TrendingTopics from '../components/dashboard/TrendingTopics'\r\nimport MarketInsights from '../components/dashboard/MarketInsights'\r\nimport { useRealTimeData } from '../hooks/useRealTimeData'\r\n\r\nconst GlobalStatsPage = () => {\r\n  const {\r\n    globalStats,\r\n    liveMetrics,\r\n    isLoading,\r\n    error,\r\n    lastUpdated,\r\n    refresh,\r\n    formatNumber,\r\n    formatTime,\r\n    getTimeSinceUpdate\r\n  } = useRealTimeData()\r\n\r\n  return (\r\n    <div className=\"space-y-8\">\r\n      {/* Header */}\r\n      <div className=\"text-center\">\r\n        <h1 className=\"text-4xl font-bold text-gradient mb-4\">\r\n          🌍 Global Learning Statistics\r\n        </h1>\r\n        <p className=\"text-xl text-gray-600 dark:text-gray-400 mb-4\">\r\n          Real-time insights from the global learning community\r\n        </p>\r\n        \r\n        {/* Live Status Indicator */}\r\n        <div className=\"flex items-center justify-center gap-4 text-sm text-gray-500 dark:text-gray-400\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\"></div>\r\n            <span>Live data</span>\r\n          </div>\r\n          <div className=\"flex items-center gap-2\">\r\n            <span>Last updated: {lastUpdated ? getTimeSinceUpdate() : 'Loading...'}</span>\r\n            <button\r\n              onClick={refresh}\r\n              className=\"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 transition-colors\"\r\n              disabled={isLoading}\r\n              title=\"Refresh all data\"\r\n            >\r\n              <span className={isLoading ? 'animate-spin' : ''}>🔄</span>\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Error State */}\r\n      {error && (\r\n        <div className=\"card p-6 border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-900/20\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center gap-3\">\r\n              <div className=\"text-2xl\">⚠️</div>\r\n              <div>\r\n                <h3 className=\"font-semibold text-red-800 dark:text-red-200\">\r\n                  Connection Issue\r\n                </h3>\r\n                <p className=\"text-sm text-red-600 dark:text-red-400\">\r\n                  {error}\r\n                </p>\r\n              </div>\r\n            </div>\r\n            <button\r\n              onClick={refresh}\r\n              className=\"btn btn-sm bg-red-600 hover:bg-red-700 text-white\"\r\n            >\r\n              Retry\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Global Overview Cards */}\r\n      {globalStats && liveMetrics && (\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\r\n          <div className=\"card p-6 text-center\">\r\n            <div className=\"text-3xl font-bold text-blue-600 mb-2\">\r\n              {formatNumber(globalStats.totalLearners)}\r\n            </div>\r\n            <div className=\"text-sm text-gray-600 dark:text-gray-400\">Total Learners</div>\r\n            <div className=\"text-xs text-green-600 dark:text-green-400 mt-1\">\r\n              +{Math.floor(Math.random() * 1000)} today\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"card p-6 text-center\">\r\n            <div className=\"text-3xl font-bold text-green-600 mb-2\">\r\n              {formatNumber(globalStats.cardsStudiedToday)}\r\n            </div>\r\n            <div className=\"text-sm text-gray-600 dark:text-gray-400\">Cards Studied Today</div>\r\n            <div className=\"text-xs text-blue-600 dark:text-blue-400 mt-1\">\r\n              {formatTime(globalStats.studyTimeToday)} total time\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"card p-6 text-center\">\r\n            <div className=\"text-3xl font-bold text-orange-600 mb-2\">\r\n              {formatNumber(liveMetrics.onlineUsers)}\r\n            </div>\r\n            <div className=\"text-sm text-gray-600 dark:text-gray-400\">Online Now</div>\r\n            <div className=\"text-xs text-purple-600 dark:text-purple-400 mt-1\">\r\n              {formatNumber(liveMetrics.studyingSessions)} studying\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"card p-6 text-center\">\r\n            <div className=\"text-3xl font-bold text-purple-600 mb-2\">\r\n              {globalStats.languagesBeingLearned}\r\n            </div>\r\n            <div className=\"text-sm text-gray-600 dark:text-gray-400\">Languages</div>\r\n            <div className=\"text-xs text-orange-600 dark:text-orange-400 mt-1\">\r\n              {liveMetrics.averageAccuracy.toFixed(1)}% avg accuracy\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Top Subjects Global Ranking */}\r\n      {globalStats && (\r\n        <div className=\"card p-6\">\r\n          <h2 className=\"text-2xl font-bold mb-4 flex items-center gap-2\">\r\n            🏆 Most Popular Subjects Worldwide\r\n            <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\"></div>\r\n          </h2>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-5 gap-4\">\r\n            {globalStats.topSubjects.map((subject, index) => (\r\n              <div key={subject.name} className=\"text-center p-4 bg-gray-50 dark:bg-gray-700 rounded-lg\">\r\n                <div className=\"text-2xl font-bold text-gray-800 dark:text-gray-200 mb-1\">\r\n                  #{index + 1}\r\n                </div>\r\n                <div className=\"font-semibold text-lg mb-2\">{subject.name}</div>\r\n                <div className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n                  {formatNumber(subject.learners)} learners\r\n                </div>\r\n                <div className=\"w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2 mt-2\">\r\n                  <div \r\n                    className=\"bg-gradient-to-r from-blue-500 to-purple-600 h-2 rounded-full transition-all duration-300\"\r\n                    style={{ width: `${Math.max(20, 100 - index * 15)}%` }}\r\n                  ></div>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Live Activity Dashboard */}\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n        <RealTimeStatsCard\r\n          title=\"Live Activity Monitor\"\r\n          icon=\"📊\"\r\n          className=\"lg:col-span-1\"\r\n          showRefreshButton={true}\r\n        />\r\n        \r\n        {/* Top Performers */}\r\n        {liveMetrics && (\r\n          <div className=\"card p-6 lg:col-span-2\">\r\n            <h2 className=\"text-2xl font-bold mb-4 flex items-center gap-2\">\r\n              🌟 Top Performers Today\r\n              <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\"></div>\r\n            </h2>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              {liveMetrics.topPerformers.map((performer, index) => (\r\n                <div key={performer.username} className=\"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg\">\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <div className={`w-10 h-10 rounded-full flex items-center justify-center text-white font-bold ${\r\n                      index === 0 ? 'bg-gradient-to-r from-yellow-400 to-orange-500' :\r\n                      index === 1 ? 'bg-gradient-to-r from-gray-400 to-gray-600' :\r\n                      index === 2 ? 'bg-gradient-to-r from-orange-400 to-red-500' :\r\n                      'bg-gradient-to-r from-blue-400 to-purple-500'\r\n                    }`}>\r\n                      {index + 1}\r\n                    </div>\r\n                    <div>\r\n                      <div className=\"font-semibold\">{performer.username}</div>\r\n                      <div className=\"text-sm text-gray-600 dark:text-gray-400 flex items-center gap-1\">\r\n                        🌍 {performer.country}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"text-right\">\r\n                    <div className=\"font-bold text-blue-600 dark:text-blue-400\">\r\n                      {formatNumber(performer.score)}\r\n                    </div>\r\n                    <div className=\"text-xs text-gray-500 dark:text-gray-400\">XP</div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Trending Topics Section */}\r\n      <TrendingTopics\r\n        maxItems={8}\r\n        showGrowth={true}\r\n      />\r\n\r\n      {/* Market Insights Section */}\r\n      <MarketInsights\r\n        maxSkills={8}\r\n        maxIndustries={6}\r\n        showCertifications={true}\r\n      />\r\n\r\n      {/* Global Learning Insights */}\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n        <div className=\"card p-6\">\r\n          <h3 className=\"text-xl font-semibold mb-4 flex items-center gap-2\">\r\n            📈 Learning Velocity\r\n          </h3>\r\n          <div className=\"space-y-4\">\r\n            <div className=\"flex justify-between items-center\">\r\n              <span>Cards per minute (global)</span>\r\n              <span className=\"font-bold text-blue-600\">\r\n                {globalStats ? Math.floor(globalStats.cardsStudiedToday / (globalStats.studyTimeToday || 1)).toLocaleString() : '0'}\r\n              </span>\r\n            </div>\r\n            <div className=\"flex justify-between items-center\">\r\n              <span>Peak learning hour</span>\r\n              <span className=\"font-bold text-green-600\">7-9 PM UTC</span>\r\n            </div>\r\n            <div className=\"flex justify-between items-center\">\r\n              <span>Most active timezone</span>\r\n              <span className=\"font-bold text-purple-600\">UTC+8 (Asia)</span>\r\n            </div>\r\n            <div className=\"flex justify-between items-center\">\r\n              <span>Weekend vs Weekday</span>\r\n              <span className=\"font-bold text-orange-600\">+23% weekdays</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"card p-6\">\r\n          <h3 className=\"text-xl font-semibold mb-4 flex items-center gap-2\">\r\n            🎯 Learning Effectiveness\r\n          </h3>\r\n          <div className=\"space-y-4\">\r\n            <div className=\"flex justify-between items-center\">\r\n              <span>Global retention rate</span>\r\n              <span className=\"font-bold text-green-600\">\r\n                {liveMetrics ? liveMetrics.averageAccuracy.toFixed(1) : '0'}%\r\n              </span>\r\n            </div>\r\n            <div className=\"flex justify-between items-center\">\r\n              <span>Optimal session length</span>\r\n              <span className=\"font-bold text-blue-600\">25 minutes</span>\r\n            </div>\r\n            <div className=\"flex justify-between items-center\">\r\n              <span>Spaced repetition usage</span>\r\n              <span className=\"font-bold text-purple-600\">78% of users</span>\r\n            </div>\r\n            <div className=\"flex justify-between items-center\">\r\n              <span>Mobile vs Desktop</span>\r\n              <span className=\"font-bold text-orange-600\">65% mobile</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Global Learning Community */}\r\n      <div className=\"card p-6 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 border border-blue-200 dark:border-blue-800\">\r\n        <div className=\"flex items-center justify-between mb-4\">\r\n          <h2 className=\"text-2xl font-bold text-blue-800 dark:text-blue-200 flex items-center gap-2\">\r\n            🌍 Global Learning Community\r\n            <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\"></div>\r\n          </h2>\r\n        </div>\r\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 text-center\">\r\n          <div>\r\n            <div className=\"text-2xl font-bold text-blue-600 dark:text-blue-400\">\r\n              {globalStats ? formatNumber(globalStats.totalLearners) : '2.8M+'}\r\n            </div>\r\n            <div className=\"text-sm text-blue-700 dark:text-blue-300\">Global Learners</div>\r\n          </div>\r\n          <div>\r\n            <div className=\"text-2xl font-bold text-green-600 dark:text-green-400\">\r\n              {globalStats ? formatNumber(globalStats.cardsStudiedToday) : '15M+'}\r\n            </div>\r\n            <div className=\"text-sm text-green-700 dark:text-green-300\">Cards Studied Today</div>\r\n          </div>\r\n          <div>\r\n            <div className=\"text-2xl font-bold text-purple-600 dark:text-purple-400\">\r\n              {liveMetrics ? formatNumber(liveMetrics.studyingSessions) : '23K+'}\r\n            </div>\r\n            <div className=\"text-sm text-purple-700 dark:text-purple-300\">Active Sessions</div>\r\n          </div>\r\n          <div>\r\n            <div className=\"text-2xl font-bold text-orange-600 dark:text-orange-400\">\r\n              {globalStats ? globalStats.languagesBeingLearned : '127'}\r\n            </div>\r\n            <div className=\"text-sm text-orange-700 dark:text-orange-300\">Languages</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Skills in Demand */}\r\n      <div className=\"card p-6\">\r\n        <div className=\"flex items-center justify-between mb-4\">\r\n          <h2 className=\"text-2xl font-bold mb-0\">💼 Skills in Demand</h2>\r\n        </div>\r\n        <div className=\"grid grid-cols-1 md:grid-cols-6 gap-4\">\r\n          <div className=\"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg text-center\">\r\n            <div className=\"text-lg font-bold text-red-600 dark:text-red-400\">🚀 AI/ML</div>\r\n            <div className=\"text-sm text-gray-600 dark:text-gray-400\">+156% growth</div>\r\n          </div>\r\n          <div className=\"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg text-center\">\r\n            <div className=\"text-lg font-bold text-blue-600 dark:text-blue-400\">☁️ Cloud</div>\r\n            <div className=\"text-sm text-gray-600 dark:text-gray-400\">+134% growth</div>\r\n          </div>\r\n          <div className=\"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg text-center\">\r\n            <div className=\"text-lg font-bold text-green-600 dark:text-green-400\">🔒 Security</div>\r\n            <div className=\"text-sm text-gray-600 dark:text-gray-400\">+129% growth</div>\r\n          </div>\r\n          <div className=\"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg text-center\">\r\n            <div className=\"text-lg font-bold text-purple-600 dark:text-purple-400\">📊 Data Science</div>\r\n            <div className=\"text-sm text-gray-600 dark:text-gray-400\">+118% growth</div>\r\n          </div>\r\n          <div className=\"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg text-center\">\r\n            <div className=\"text-lg font-bold text-indigo-600 dark:text-indigo-400\">🌐 DevOps</div>\r\n            <div className=\"text-sm text-gray-600 dark:text-gray-400\">+112% growth</div>\r\n          </div>\r\n          <div className=\"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg text-center\">\r\n            <div className=\"text-lg font-bold text-pink-600 dark:text-pink-400\">🎨 UX/UI</div>\r\n            <div className=\"text-sm text-gray-600 dark:text-gray-400\">+98% growth</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Data Sources Footer */}\r\n      <div className=\"card p-6 bg-gradient-to-r from-gray-50 to-blue-50 dark:from-gray-800 dark:to-blue-900/20 border border-gray-200 dark:border-gray-700\">\r\n        <h3 className=\"text-lg font-semibold mb-3 text-gray-800 dark:text-gray-200 flex items-center gap-2\">\r\n          📡 Data Sources & Methodology\r\n        </h3>\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-sm text-gray-600 dark:text-gray-400\">\r\n          <div>\r\n            <div className=\"font-semibold text-gray-800 dark:text-gray-200 mb-1\">Learning Platforms</div>\r\n            <div>• Educational APIs</div>\r\n            <div>• Learning Management Systems</div>\r\n            <div>• Online Course Providers</div>\r\n          </div>\r\n          <div>\r\n            <div className=\"font-semibold text-gray-800 dark:text-gray-200 mb-1\">Market Data</div>\r\n            <div>• Job Market APIs</div>\r\n            <div>• Skills Demand Analytics</div>\r\n            <div>• Industry Reports</div>\r\n          </div>\r\n          <div>\r\n            <div className=\"font-semibold text-gray-800 dark:text-gray-200 mb-1\">Real-time Metrics</div>\r\n            <div>• User Activity Streams</div>\r\n            <div>• Performance Analytics</div>\r\n            <div>• Engagement Tracking</div>\r\n          </div>\r\n          <div>\r\n            <div className=\"font-semibold text-gray-800 dark:text-gray-200 mb-1\">Update Frequency</div>\r\n            <div>• Live metrics: 10s</div>\r\n            <div>• Global stats: 30s</div>\r\n            <div>• Market data: 5m</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default GlobalStatsPage","import React, { useState, useEffect, useMemo } from 'react';\r\nimport { \r\n  LineChart, Line, BarChart, Bar, ScatterChart, Scatter, \r\n  XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer,\r\n  PieChart, Pie, Cell, Area, AreaChart, RadarChart, PolarGrid, \r\n  PolarAngleAxis, PolarRadiusAxis, Radar\r\n} from 'recharts';\r\n\r\ninterface AnalyticsDashboardProps {\r\n  userId: string;\r\n  timeRange: '7d' | '30d' | '90d' | '1y';\r\n}\r\n\r\ninterface DSRMetrics {\r\n  date: string;\r\n  averageDifficulty: number;\r\n  averageStability: number;\r\n  averageRetrievability: number;\r\n  cardsReviewed: number;\r\n}\r\n\r\ninterface SessionAnalytics {\r\n  date: string;\r\n  momentum: number;\r\n  fatigue: number;\r\n  flowTime: number;\r\n  cognitiveLoad: number;\r\n  satisfaction: number;\r\n  cardsPerSession: number;\r\n  accuracy: number;\r\n}\r\n\r\ninterface LearningPattern {\r\n  timeOfDay: string;\r\n  performance: number;\r\n  confidence: number;\r\n  responseTime: number;\r\n  sessions: number;\r\n}\r\n\r\ninterface EnvironmentalInsights {\r\n  condition: string;\r\n  averagePerformance: number;\r\n  sessionCount: number;\r\n  preferenceScore: number;\r\n}\r\n\r\ninterface PersonalizationData {\r\n  optimalDifficulty: number;\r\n  optimalSessionLength: number;\r\n  bestPerformanceTimes: string[];\r\n  cognitiveLoadProfile: {\r\n    baseCapacity: number;\r\n    fatigueRate: number;\r\n    recoveryRate: number;\r\n  };\r\n  fsrsParameters: number[];\r\n}\r\n\r\nexport const AnalyticsDashboard: React.FC<AnalyticsDashboardProps> = ({ userId, timeRange }) => {\r\n  const [dsrData, setDsrData] = useState<DSRMetrics[]>([]);\r\n  const [sessionData, setSessionData] = useState<SessionAnalytics[]>([]);\r\n  const [learningPatterns, setLearningPatterns] = useState<LearningPattern[]>([]);\r\n  const [environmentalData, setEnvironmentalData] = useState<EnvironmentalInsights[]>([]);\r\n  const [personalizationData, setPersonalizationData] = useState<PersonalizationData | null>(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [selectedMetric, setSelectedMetric] = useState<'momentum' | 'difficulty' | 'cognitive'>('momentum');\r\n\r\n  // Load analytics data\r\n  useEffect(() => {\r\n    loadAnalyticsData();\r\n  }, [userId, timeRange]);\r\n\r\n  const loadAnalyticsData = async () => {\r\n    setIsLoading(true);\r\n    try {\r\n      // In a real implementation, these would be API calls\r\n      // For now, we'll generate sample data\r\n      setDsrData(generateSampleDSRData());\r\n      setSessionData(generateSampleSessionData());\r\n      setLearningPatterns(generateSampleLearningPatterns());\r\n      setEnvironmentalData(generateSampleEnvironmentalData());\r\n      setPersonalizationData(generateSamplePersonalizationData());\r\n    } catch (error) {\r\n      console.error('Failed to load analytics data:', error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  // Computed metrics\r\n  const insights = useMemo(() => {\r\n    if (!sessionData.length) return null;\r\n\r\n    const avgMomentum = sessionData.reduce((sum, s) => sum + s.momentum, 0) / sessionData.length;\r\n    const avgAccuracy = sessionData.reduce((sum, s) => sum + s.accuracy, 0) / sessionData.length;\r\n    const totalCardsReviewed = sessionData.reduce((sum, s) => sum + s.cardsPerSession, 0);\r\n    const avgFlowTime = sessionData.reduce((sum, s) => sum + s.flowTime, 0) / sessionData.length;\r\n    \r\n    return {\r\n      avgMomentum,\r\n      avgAccuracy,\r\n      totalCardsReviewed,\r\n      avgFlowTime,\r\n      improvementTrend: sessionData.length > 1 ? \r\n        (sessionData[sessionData.length - 1].momentum - sessionData[0].momentum) > 0 ? 'improving' : 'declining' : 'stable'\r\n    };\r\n  }, [sessionData]);\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto mb-4\"></div>\r\n          <p className=\"text-gray-600\">Loading advanced analytics...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50\">\r\n      {/* Header */}\r\n      <div className=\"bg-white shadow-sm border-b\">\r\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6\">\r\n          <div className=\"flex justify-between items-center\">\r\n            <div>\r\n              <h1 className=\"text-3xl font-bold text-gray-900\">UAMS v3.0 Analytics</h1>\r\n              <p className=\"mt-1 text-sm text-gray-600\">Advanced Learning Intelligence Dashboard</p>\r\n            </div>\r\n            <div className=\"flex space-x-4\">\r\n              <select \r\n                value={timeRange} \r\n                onChange={(e) => {/* Handle time range change */}}\r\n                className=\"px-4 py-2 border border-gray-300 rounded-md bg-white\"\r\n              >\r\n                <option value=\"7d\">Last 7 days</option>\r\n                <option value=\"30d\">Last 30 days</option>\r\n                <option value=\"90d\">Last 90 days</option>\r\n                <option value=\"1y\">Last year</option>\r\n              </select>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\r\n        {/* Key Insights Cards */}\r\n        {insights && (\r\n          <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8\">\r\n            <InsightCard\r\n              title=\"Average Momentum\"\r\n              value={`${(insights.avgMomentum * 100).toFixed(1)}%`}\r\n              trend={insights.improvementTrend}\r\n              color=\"blue\"\r\n            />\r\n            <InsightCard\r\n              title=\"Accuracy Rate\"\r\n              value={`${(insights.avgAccuracy * 100).toFixed(1)}%`}\r\n              trend=\"stable\"\r\n              color=\"green\"\r\n            />\r\n            <InsightCard\r\n              title=\"Cards Reviewed\"\r\n              value={insights.totalCardsReviewed.toString()}\r\n              trend=\"stable\"\r\n              color=\"purple\"\r\n            />\r\n            <InsightCard\r\n              title=\"Avg Flow Time\"\r\n              value={`${insights.avgFlowTime.toFixed(0)}min`}\r\n              trend=\"stable\"\r\n              color=\"orange\"\r\n            />\r\n          </div>\r\n        )}\r\n\r\n        {/* DSR Metrics Section */}\r\n        <section className=\"mb-12\">\r\n          <h2 className=\"text-2xl font-bold text-gray-900 mb-6\">Memory Metrics (DSR)</h2>\r\n          <div className=\"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-8\">\r\n            <DSRTrendsChart data={dsrData} />\r\n            <StabilityDistribution data={dsrData} />\r\n            <RetrievabilityPrediction data={dsrData} />\r\n          </div>\r\n        </section>\r\n\r\n        {/* Session Performance Section */}\r\n        <section className=\"mb-12\">\r\n          <h2 className=\"text-2xl font-bold text-gray-900 mb-6\">Session Performance</h2>\r\n          <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8\">\r\n            <MomentumTrendsChart data={sessionData} />\r\n            <FlowStateAnalysis data={sessionData} />\r\n          </div>\r\n          <div className=\"grid grid-cols-1 xl:grid-cols-2 gap-8\">\r\n            <CognitiveLoadPatterns data={sessionData} />\r\n            <SessionQualityMatrix data={sessionData} />\r\n          </div>\r\n        </section>\r\n\r\n        {/* Personal Learning Patterns */}\r\n        <section className=\"mb-12\">\r\n          <h2 className=\"text-2xl font-bold text-gray-900 mb-6\">Personal Learning Patterns</h2>\r\n          <div className=\"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-8\">\r\n            <OptimalStudyTimes data={learningPatterns} />\r\n            <EnvironmentalPreferences data={environmentalData} />\r\n            <PersonalizedInsights data={personalizationData} />\r\n          </div>\r\n        </section>\r\n\r\n        {/* Advanced Insights */}\r\n        <section className=\"mb-12\">\r\n          <h2 className=\"text-2xl font-bold text-gray-900 mb-6\">AI-Powered Insights</h2>\r\n          <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\r\n            <LearningRecommendations insights={insights} patterns={learningPatterns} />\r\n            <ParameterOptimizationStatus data={personalizationData} />\r\n          </div>\r\n        </section>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Sub-components\r\n\r\nconst InsightCard: React.FC<{\r\n  title: string;\r\n  value: string;\r\n  trend: 'improving' | 'declining' | 'stable';\r\n  color: 'blue' | 'green' | 'purple' | 'orange';\r\n}> = ({ title, value, trend, color }) => {\r\n  const colorClasses = {\r\n    blue: 'bg-blue-50 text-blue-600 border-blue-200',\r\n    green: 'bg-green-50 text-green-600 border-green-200',\r\n    purple: 'bg-purple-50 text-purple-600 border-purple-200',\r\n    orange: 'bg-orange-50 text-orange-600 border-orange-200'\r\n  };\r\n\r\n  const trendIcons = {\r\n    improving: '📈',\r\n    declining: '📉',\r\n    stable: '➡️'\r\n  };\r\n\r\n  return (\r\n    <div className={`${colorClasses[color]} p-6 rounded-lg border`}>\r\n      <div className=\"flex items-center justify-between\">\r\n        <h3 className=\"text-sm font-medium\">{title}</h3>\r\n        <span className=\"text-lg\">{trendIcons[trend]}</span>\r\n      </div>\r\n      <div className=\"mt-2\">\r\n        <div className=\"text-2xl font-bold\">{value}</div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst DSRTrendsChart: React.FC<{ data: DSRMetrics[] }> = ({ data }) => {\r\n  return (\r\n    <div className=\"bg-white p-6 rounded-lg shadow\">\r\n      <h3 className=\"text-lg font-semibold mb-4\">DSR Trends Over Time</h3>\r\n      <ResponsiveContainer width=\"100%\" height={300}>\r\n        <LineChart data={data}>\r\n          <CartesianGrid strokeDasharray=\"3 3\" />\r\n          <XAxis dataKey=\"date\" />\r\n          <YAxis domain={[0, 10]} />\r\n          <Tooltip />\r\n          <Legend />\r\n          <Line \r\n            type=\"monotone\" \r\n            dataKey=\"averageDifficulty\" \r\n            stroke=\"#8884d8\" \r\n            name=\"Difficulty\" \r\n            strokeWidth={2}\r\n          />\r\n          <Line \r\n            type=\"monotone\" \r\n            dataKey=\"averageStability\" \r\n            stroke=\"#82ca9d\" \r\n            name=\"Stability\" \r\n            strokeWidth={2}\r\n          />\r\n          <Line \r\n            type=\"monotone\" \r\n            dataKey=\"averageRetrievability\" \r\n            stroke=\"#ffc658\" \r\n            name=\"Retrievability\" \r\n            strokeWidth={2}\r\n          />\r\n        </LineChart>\r\n      </ResponsiveContainer>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst StabilityDistribution: React.FC<{ data: DSRMetrics[] }> = ({ data }) => {\r\n  // Process data to show stability distribution\r\n  const distributionData = [\r\n    { range: '0-1 days', count: 12, fill: '#ff6b6b' },\r\n    { range: '1-7 days', count: 28, fill: '#4ecdc4' },\r\n    { range: '7-30 days', count: 45, fill: '#45b7d1' },\r\n    { range: '30+ days', count: 23, fill: '#96ceb4' }\r\n  ];\r\n\r\n  return (\r\n    <div className=\"bg-white p-6 rounded-lg shadow\">\r\n      <h3 className=\"text-lg font-semibold mb-4\">Memory Stability Distribution</h3>\r\n      <ResponsiveContainer width=\"100%\" height={300}>\r\n        <PieChart>\r\n          <Pie\r\n            data={distributionData}\r\n            cx=\"50%\"\r\n            cy=\"50%\"\r\n            outerRadius={80}\r\n            dataKey=\"count\"\r\n            label={({ range, percent }) => `${range}: ${(percent * 100).toFixed(0)}%`}\r\n          >\r\n            {distributionData.map((entry, index) => (\r\n              <Cell key={`cell-${index}`} fill={entry.fill} />\r\n            ))}\r\n          </Pie>\r\n          <Tooltip />\r\n        </PieChart>\r\n      </ResponsiveContainer>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst RetrievabilityPrediction: React.FC<{ data: DSRMetrics[] }> = ({ data }) => {\r\n  return (\r\n    <div className=\"bg-white p-6 rounded-lg shadow\">\r\n      <h3 className=\"text-lg font-semibold mb-4\">Retrievability Forecast</h3>\r\n      <ResponsiveContainer width=\"100%\" height={300}>\r\n        <AreaChart data={data}>\r\n          <CartesianGrid strokeDasharray=\"3 3\" />\r\n          <XAxis dataKey=\"date\" />\r\n          <YAxis domain={[0, 1]} />\r\n          <Tooltip formatter={(value) => `${(Number(value) * 100).toFixed(1)}%`} />\r\n          <Area \r\n            type=\"monotone\" \r\n            dataKey=\"averageRetrievability\" \r\n            stroke=\"#8884d8\" \r\n            fill=\"#8884d8\" \r\n            fillOpacity={0.3}\r\n          />\r\n        </AreaChart>\r\n      </ResponsiveContainer>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst MomentumTrendsChart: React.FC<{ data: SessionAnalytics[] }> = ({ data }) => {\r\n  return (\r\n    <div className=\"bg-white p-6 rounded-lg shadow\">\r\n      <h3 className=\"text-lg font-semibold mb-4\">Momentum & Flow Trends</h3>\r\n      <ResponsiveContainer width=\"100%\" height={350}>\r\n        <LineChart data={data}>\r\n          <CartesianGrid strokeDasharray=\"3 3\" />\r\n          <XAxis dataKey=\"date\" />\r\n          <YAxis domain={[0, 1]} />\r\n          <Tooltip formatter={(value) => `${(Number(value) * 100).toFixed(1)}%`} />\r\n          <Legend />\r\n          <Line \r\n            type=\"monotone\" \r\n            dataKey=\"momentum\" \r\n            stroke=\"#8884d8\" \r\n            name=\"Session Momentum\" \r\n            strokeWidth={2}\r\n          />\r\n          <Line \r\n            type=\"monotone\" \r\n            dataKey=\"satisfaction\" \r\n            stroke=\"#82ca9d\" \r\n            name=\"Satisfaction\" \r\n            strokeWidth={2}\r\n          />\r\n        </LineChart>\r\n      </ResponsiveContainer>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst FlowStateAnalysis: React.FC<{ data: SessionAnalytics[] }> = ({ data }) => {\r\n  return (\r\n    <div className=\"bg-white p-6 rounded-lg shadow\">\r\n      <h3 className=\"text-lg font-semibold mb-4\">Flow State Analysis</h3>\r\n      <ResponsiveContainer width=\"100%\" height={350}>\r\n        <ScatterChart data={data}>\r\n          <CartesianGrid strokeDasharray=\"3 3\" />\r\n          <XAxis dataKey=\"cognitiveLoad\" name=\"Cognitive Load\" />\r\n          <YAxis dataKey=\"momentum\" name=\"Momentum\" />\r\n          <Tooltip cursor={{ strokeDasharray: '3 3' }} />\r\n          <Scatter \r\n            dataKey=\"flowTime\" \r\n            fill=\"#8884d8\"\r\n            name=\"Flow Time (size indicates duration)\"\r\n          />\r\n        </ScatterChart>\r\n      </ResponsiveContainer>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst CognitiveLoadPatterns: React.FC<{ data: SessionAnalytics[] }> = ({ data }) => {\r\n  return (\r\n    <div className=\"bg-white p-6 rounded-lg shadow\">\r\n      <h3 className=\"text-lg font-semibold mb-4\">Cognitive Load vs Fatigue</h3>\r\n      <ResponsiveContainer width=\"100%\" height={300}>\r\n        <BarChart data={data}>\r\n          <CartesianGrid strokeDasharray=\"3 3\" />\r\n          <XAxis dataKey=\"date\" />\r\n          <YAxis domain={[0, 1]} />\r\n          <Tooltip formatter={(value) => `${(Number(value) * 100).toFixed(1)}%`} />\r\n          <Bar dataKey=\"cognitiveLoad\" fill=\"#8884d8\" name=\"Cognitive Load\" />\r\n          <Bar dataKey=\"fatigue\" fill=\"#82ca9d\" name=\"Fatigue\" />\r\n        </BarChart>\r\n      </ResponsiveContainer>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst SessionQualityMatrix: React.FC<{ data: SessionAnalytics[] }> = ({ data }) => {\r\n  const radarData = [\r\n    { subject: 'Momentum', value: 0.8, fullMark: 1 },\r\n    { subject: 'Flow Time', value: 0.7, fullMark: 1 },\r\n    { subject: 'Accuracy', value: 0.9, fullMark: 1 },\r\n    { subject: 'Satisfaction', value: 0.85, fullMark: 1 },\r\n    { subject: 'Efficiency', value: 0.75, fullMark: 1 }\r\n  ];\r\n\r\n  return (\r\n    <div className=\"bg-white p-6 rounded-lg shadow\">\r\n      <h3 className=\"text-lg font-semibold mb-4\">Session Quality Matrix</h3>\r\n      <ResponsiveContainer width=\"100%\" height={300}>\r\n        <RadarChart data={radarData}>\r\n          <PolarGrid />\r\n          <PolarAngleAxis dataKey=\"subject\" />\r\n          <PolarRadiusAxis domain={[0, 1]} />\r\n          <Radar\r\n            name=\"Performance\"\r\n            dataKey=\"value\"\r\n            stroke=\"#8884d8\"\r\n            fill=\"#8884d8\"\r\n            fillOpacity={0.3}\r\n          />\r\n        </RadarChart>\r\n      </ResponsiveContainer>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst OptimalStudyTimes: React.FC<{ data: LearningPattern[] }> = ({ data }) => {\r\n  return (\r\n    <div className=\"bg-white p-6 rounded-lg shadow\">\r\n      <h3 className=\"text-lg font-semibold mb-4\">Optimal Study Times</h3>\r\n      <ResponsiveContainer width=\"100%\" height={300}>\r\n        <BarChart data={data}>\r\n          <CartesianGrid strokeDasharray=\"3 3\" />\r\n          <XAxis dataKey=\"timeOfDay\" />\r\n          <YAxis />\r\n          <Tooltip />\r\n          <Bar dataKey=\"performance\" fill=\"#8884d8\" name=\"Performance Score\" />\r\n        </BarChart>\r\n      </ResponsiveContainer>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst EnvironmentalPreferences: React.FC<{ data: EnvironmentalInsights[] }> = ({ data }) => {\r\n  return (\r\n    <div className=\"bg-white p-6 rounded-lg shadow\">\r\n      <h3 className=\"text-lg font-semibold mb-4\">Environmental Performance</h3>\r\n      <div className=\"space-y-4\">\r\n        {data.map((item, index) => (\r\n          <div key={index} className=\"flex items-center justify-between\">\r\n            <span className=\"text-sm font-medium\">{item.condition}</span>\r\n            <div className=\"flex items-center space-x-2\">\r\n              <div className=\"w-24 bg-gray-200 rounded-full h-2\">\r\n                <div \r\n                  className=\"bg-blue-500 h-2 rounded-full\"\r\n                  style={{ width: `${item.averagePerformance * 100}%` }}\r\n                />\r\n              </div>\r\n              <span className=\"text-sm text-gray-600\">\r\n                {(item.averagePerformance * 100).toFixed(0)}%\r\n              </span>\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst PersonalizedInsights: React.FC<{ data: PersonalizationData | null }> = ({ data }) => {\r\n  if (!data) return null;\r\n\r\n  return (\r\n    <div className=\"bg-white p-6 rounded-lg shadow\">\r\n      <h3 className=\"text-lg font-semibold mb-4\">AI Personalization Profile</h3>\r\n      <div className=\"space-y-3\">\r\n        <div className=\"flex justify-between\">\r\n          <span className=\"text-sm text-gray-600\">Optimal Difficulty</span>\r\n          <span className=\"font-medium\">{data.optimalDifficulty.toFixed(1)}/10</span>\r\n        </div>\r\n        <div className=\"flex justify-between\">\r\n          <span className=\"text-sm text-gray-600\">Optimal Session Length</span>\r\n          <span className=\"font-medium\">{data.optimalSessionLength}min</span>\r\n        </div>\r\n        <div className=\"flex justify-between\">\r\n          <span className=\"text-sm text-gray-600\">Cognitive Capacity</span>\r\n          <span className=\"font-medium\">{(data.cognitiveLoadProfile.baseCapacity * 100).toFixed(0)}%</span>\r\n        </div>\r\n        <div className=\"mt-4\">\r\n          <span className=\"text-sm text-gray-600 block mb-2\">Best Study Times</span>\r\n          <div className=\"flex flex-wrap gap-1\">\r\n            {data.bestPerformanceTimes.map((time, idx) => (\r\n              <span key={idx} className=\"px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs\">\r\n                {time}\r\n              </span>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst LearningRecommendations: React.FC<{ \r\n  insights: any; \r\n  patterns: LearningPattern[] \r\n}> = ({ insights, patterns }) => {\r\n  const recommendations = [\r\n    \"Your momentum peaks around 2-4 PM. Schedule challenging reviews during this window.\",\r\n    \"Consider shorter sessions (20-25 min) to maintain optimal cognitive load.\",\r\n    \"Desktop sessions show 15% better performance than mobile - use for difficult cards.\",\r\n    \"Quiet environments improve your accuracy by 12%. Find a distraction-free space.\",\r\n    \"Your FSRS parameters are 85% optimized. Continue current study pattern for best results.\"\r\n  ];\r\n\r\n  return (\r\n    <div className=\"bg-white p-6 rounded-lg shadow\">\r\n      <h3 className=\"text-lg font-semibold mb-4\">AI Recommendations</h3>\r\n      <div className=\"space-y-3\">\r\n        {recommendations.map((rec, index) => (\r\n          <div key={index} className=\"flex items-start space-x-3\">\r\n            <span className=\"flex-shrink-0 w-6 h-6 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-sm font-medium\">\r\n              {index + 1}\r\n            </span>\r\n            <p className=\"text-sm text-gray-700\">{rec}</p>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst ParameterOptimizationStatus: React.FC<{ data: PersonalizationData | null }> = ({ data }) => {\r\n  if (!data) return null;\r\n\r\n  return (\r\n    <div className=\"bg-white p-6 rounded-lg shadow\">\r\n      <h3 className=\"text-lg font-semibold mb-4\">FSRS Parameter Optimization</h3>\r\n      <div className=\"space-y-4\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <span className=\"text-sm text-gray-600\">Optimization Progress</span>\r\n          <span className=\"font-medium text-green-600\">87% Complete</span>\r\n        </div>\r\n        <div className=\"w-full bg-gray-200 rounded-full h-2\">\r\n          <div className=\"bg-green-500 h-2 rounded-full\" style={{ width: '87%' }}></div>\r\n        </div>\r\n        <div className=\"text-xs text-gray-500 space-y-1\">\r\n          <div>• Parameters updated based on 1,247 reviews</div>\r\n          <div>• Accuracy improved by 12% since last optimization</div>\r\n          <div>• Next optimization: 150 more reviews needed</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Sample data generators (replace with actual API calls)\r\nconst generateSampleDSRData = (): DSRMetrics[] => {\r\n  return Array.from({ length: 30 }, (_, i) => ({\r\n    date: new Date(Date.now() - (29 - i) * 24 * 60 * 60 * 1000).toLocaleDateString(),\r\n    averageDifficulty: 4.5 + Math.sin(i / 5) * 1.5,\r\n    averageStability: 8 + Math.cos(i / 7) * 3,\r\n    averageRetrievability: 0.7 + Math.sin(i / 3) * 0.2,\r\n    cardsReviewed: 15 + Math.floor(Math.random() * 20)\r\n  }));\r\n};\r\n\r\nconst generateSampleSessionData = (): SessionAnalytics[] => {\r\n  return Array.from({ length: 30 }, (_, i) => ({\r\n    date: new Date(Date.now() - (29 - i) * 24 * 60 * 60 * 1000).toLocaleDateString(),\r\n    momentum: 0.6 + Math.sin(i / 4) * 0.3,\r\n    fatigue: 0.3 + Math.random() * 0.4,\r\n    flowTime: 15 + Math.random() * 20,\r\n    cognitiveLoad: 0.5 + Math.random() * 0.3,\r\n    satisfaction: 0.7 + Math.sin(i / 6) * 0.2,\r\n    cardsPerSession: 20 + Math.floor(Math.random() * 15),\r\n    accuracy: 0.75 + Math.random() * 0.2\r\n  }));\r\n};\r\n\r\nconst generateSampleLearningPatterns = (): LearningPattern[] => {\r\n  const hours = Array.from({ length: 24 }, (_, i) => i);\r\n  return hours.map(hour => ({\r\n    timeOfDay: `${hour}:00`,\r\n    performance: 0.3 + (Math.sin((hour - 6) * Math.PI / 12) + 1) * 0.35,\r\n    confidence: 0.5 + Math.random() * 0.3,\r\n    responseTime: 3000 + Math.random() * 4000,\r\n    sessions: Math.floor(Math.random() * 10)\r\n  }));\r\n};\r\n\r\nconst generateSampleEnvironmentalData = (): EnvironmentalInsights[] => {\r\n  return [\r\n    { condition: 'Desktop + Quiet', averagePerformance: 0.89, sessionCount: 45, preferenceScore: 0.9 },\r\n    { condition: 'Desktop + Moderate Noise', averagePerformance: 0.82, sessionCount: 32, preferenceScore: 0.7 },\r\n    { condition: 'Mobile + Quiet', averagePerformance: 0.76, sessionCount: 28, preferenceScore: 0.6 },\r\n    { condition: 'Mobile + Noisy', averagePerformance: 0.68, sessionCount: 15, preferenceScore: 0.4 },\r\n    { condition: 'Tablet + Optimal Light', averagePerformance: 0.84, sessionCount: 20, preferenceScore: 0.8 }\r\n  ];\r\n};\r\n\r\nconst generateSamplePersonalizationData = (): PersonalizationData => {\r\n  return {\r\n    optimalDifficulty: 6.2,\r\n    optimalSessionLength: 25,\r\n    bestPerformanceTimes: ['9:00-11:00', '14:00-16:00'],\r\n    cognitiveLoadProfile: {\r\n      baseCapacity: 0.85,\r\n      fatigueRate: 0.02,\r\n      recoveryRate: 0.05\r\n    },\r\n    fsrsParameters: Array.from({ length: 21 }, () => Math.random() * 5)\r\n  };\r\n};\r\n\r\nexport default AnalyticsDashboard;","import React, { useState, useEffect, useCallback, useRef } from 'react';\r\nimport { UnifiedQueueManager } from '../services/unifiedQueueManager';\r\nimport { EnvironmentalContextService } from '../services/environmental/environmentalContextService';\r\nimport { \r\n  UnifiedSessionState, \r\n  CardSelectionResult, \r\n  EnhancedResponseLog, \r\n  FlowStateMetrics,\r\n  CognitiveLoadAnalysis\r\n} from '../../../shared/types/enhanced-types';\r\n\r\ninterface EnhancedReviewPageProps {\r\n  deckId: string;\r\n  userId: string;\r\n}\r\n\r\ninterface SessionMetrics {\r\n  cardsReviewed: number;\r\n  accuracy: number;\r\n  averageResponseTime: number;\r\n  sessionDuration: number;\r\n}\r\n\r\nconst RATING_DESCRIPTIONS = {\r\n  'again': { label: 'Again', color: 'bg-red-500', description: 'I need to review this again' },\r\n  'hard': { label: 'Hard', color: 'bg-orange-500', description: 'It was difficult but I got it' },\r\n  'good': { label: 'Good', color: 'bg-green-500', description: 'Good, normal effort' },\r\n  'easy': { label: 'Easy', color: 'bg-blue-500', description: 'Easy, no effort required' }\r\n};\r\n\r\nexport const EnhancedReviewPage: React.FC<EnhancedReviewPageProps> = ({ deckId, userId }) => {\r\n  // Core state\r\n  const [sessionState, setSessionState] = useState<UnifiedSessionState | null>(null);\r\n  const [currentCard, setCurrentCard] = useState<CardSelectionResult | null>(null);\r\n  const [responseStartTime, setResponseStartTime] = useState<number>(0);\r\n  const [sessionMetrics, setSessionMetrics] = useState<SessionMetrics>({\r\n    cardsReviewed: 0,\r\n    accuracy: 0,\r\n    averageResponseTime: 0,\r\n    sessionDuration: 0\r\n  });\r\n  \r\n  // UI state\r\n  const [showExplanation, setShowExplanation] = useState(false);\r\n  const [showAnswer, setShowAnswer] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [showMetricsPanel, setShowMetricsPanel] = useState(true);\r\n  const [showCognitiveLoadDetail, setShowCognitiveLoadDetail] = useState(false);\r\n  \r\n  // Advanced state\r\n  const [cognitiveLoadAnalysis, setCognitiveLoadAnalysis] = useState<CognitiveLoadAnalysis | null>(null);\r\n  const [environmentalAdaptations, setEnvironmentalAdaptations] = useState<any>(null);\r\n  \r\n  // Services\r\n  const queueManagerRef = useRef(new UnifiedQueueManager());\r\n  const environmentalServiceRef = useRef(new EnvironmentalContextService());\r\n  const intervalRef = useRef<NodeJS.Timeout>();\r\n  \r\n  const queueManager = queueManagerRef.current;\r\n  const environmentalService = environmentalServiceRef.current;\r\n\r\n  /**\r\n   * Initialize session\r\n   */\r\n  useEffect(() => {\r\n    const initializeSession = async () => {\r\n      try {\r\n        setIsLoading(true);\r\n        console.log('Initializing UAMS v3.0 session...');\r\n        \r\n        const newSession = await queueManager.initializeSession(userId, deckId);\r\n        setSessionState(newSession);\r\n        \r\n        const firstCard = await queueManager.getNextCard(newSession);\r\n        setCurrentCard(firstCard);\r\n        setResponseStartTime(Date.now());\r\n        \r\n        // Start environmental monitoring\r\n        await startEnvironmentalMonitoring();\r\n        \r\n        console.log('Session initialized successfully');\r\n      } catch (err) {\r\n        console.error('Failed to initialize session:', err);\r\n        setError(err instanceof Error ? err.message : 'Failed to initialize session');\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n\r\n    initializeSession();\r\n\r\n    // Cleanup\r\n    return () => {\r\n      if (intervalRef.current) {\r\n        clearInterval(intervalRef.current);\r\n      }\r\n    };\r\n  }, [userId, deckId]);\r\n\r\n  /**\r\n   * Start environmental context monitoring\r\n   */\r\n  const startEnvironmentalMonitoring = async () => {\r\n    try {\r\n      const context = await environmentalService.getCurrentContext();\r\n      const adaptations = environmentalService.getEnvironmentalAdaptations(context);\r\n      setEnvironmentalAdaptations(adaptations);\r\n      \r\n      // Set up periodic context monitoring\r\n      intervalRef.current = setInterval(async () => {\r\n        await environmentalService.trackContextChanges();\r\n      }, 30000); // Check every 30 seconds\r\n      \r\n      // Listen for context changes\r\n      environmentalService.onContextChange = (current, previous) => {\r\n        console.log('Environmental context changed:', { current, previous });\r\n        const newAdaptations = environmentalService.getEnvironmentalAdaptations(current);\r\n        setEnvironmentalAdaptations(newAdaptations);\r\n      };\r\n    } catch (error) {\r\n      console.warn('Environmental monitoring setup failed:', error);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Handle card response\r\n   */\r\n  const handleCardResponse = useCallback(async (rating: 'again' | 'hard' | 'good' | 'easy') => {\r\n    if (!sessionState || !currentCard) return;\r\n    \r\n    try {\r\n      const responseTime = Date.now() - responseStartTime;\r\n      const environmentalContext = await environmentalService.getCurrentContext();\r\n      \r\n      const enhancedResponse: EnhancedResponseLog = {\r\n        timestamp: new Date().toISOString(),\r\n        rating,\r\n        responseTime,\r\n        contextualFactors: {\r\n          sessionTime: Date.now() - new Date(sessionState.sessionStartTime).getTime(),\r\n          timeOfDay: new Date().toISOString(),\r\n          sessionFatigueIndex: sessionState.sessionFatigueIndex,\r\n          cognitiveLoadAtTime: sessionState.cognitiveLoadCapacity,\r\n          environmentalFactors: environmentalContext\r\n        },\r\n        momentumImpact: calculateMomentumImpact(rating, sessionState),\r\n        confidenceChange: calculateConfidenceChange(rating, currentCard.card),\r\n        previousCardSimilarity: 0.0, // Would be calculated based on content\r\n        clusteringContext: 'general'\r\n      };\r\n      \r\n      console.log('Processing response:', { rating, responseTime, cardId: currentCard.card.id });\r\n      \r\n      // Process response and update session\r\n      const updatedSession = await queueManager.processCardResponse(\r\n        sessionState,\r\n        currentCard.card.id,\r\n        enhancedResponse\r\n      );\r\n      \r\n      setSessionState(updatedSession);\r\n      \r\n      // Update session metrics\r\n      updateSessionMetrics(rating, responseTime);\r\n      \r\n      // Get next card\r\n      const nextCard = await queueManager.getNextCard(updatedSession);\r\n      setCurrentCard(nextCard);\r\n      setResponseStartTime(Date.now());\r\n      setShowAnswer(false);\r\n      \r\n    } catch (err) {\r\n      console.error('Error processing response:', err);\r\n      setError('Failed to process your response. Please try again.');\r\n    }\r\n  }, [sessionState, currentCard, responseStartTime]);\r\n\r\n  /**\r\n   * Update session metrics\r\n   */\r\n  const updateSessionMetrics = (rating: string, responseTime: number) => {\r\n    setSessionMetrics(prev => {\r\n      const isCorrect = rating !== 'again';\r\n      const newCardsReviewed = prev.cardsReviewed + 1;\r\n      const newCorrectAnswers = isCorrect ? (prev.accuracy * prev.cardsReviewed + 1) : (prev.accuracy * prev.cardsReviewed);\r\n      const newAccuracy = newCorrectAnswers / newCardsReviewed;\r\n      const newAverageResponseTime = ((prev.averageResponseTime * prev.cardsReviewed) + responseTime) / newCardsReviewed;\r\n      \r\n      return {\r\n        cardsReviewed: newCardsReviewed,\r\n        accuracy: newAccuracy,\r\n        averageResponseTime: newAverageResponseTime,\r\n        sessionDuration: sessionState ? Date.now() - new Date(sessionState.sessionStartTime).getTime() : 0\r\n      };\r\n    });\r\n  };\r\n\r\n  /**\r\n   * Show answer\r\n   */\r\n  const handleShowAnswer = () => {\r\n    setShowAnswer(true);\r\n  };\r\n\r\n  /**\r\n   * Handle keyboard shortcuts\r\n   */\r\n  useEffect(() => {\r\n    const handleKeyPress = (e: KeyboardEvent) => {\r\n      if (!showAnswer) {\r\n        if (e.code === 'Space' || e.code === 'Enter') {\r\n          e.preventDefault();\r\n          handleShowAnswer();\r\n        }\r\n        return;\r\n      }\r\n      \r\n      // Response shortcuts (when answer is shown)\r\n      switch (e.key) {\r\n        case '1':\r\n          e.preventDefault();\r\n          handleCardResponse('again');\r\n          break;\r\n        case '2':\r\n          e.preventDefault();\r\n          handleCardResponse('hard');\r\n          break;\r\n        case '3':\r\n          e.preventDefault();\r\n          handleCardResponse('good');\r\n          break;\r\n        case '4':\r\n          e.preventDefault();\r\n          handleCardResponse('easy');\r\n          break;\r\n      }\r\n    };\r\n\r\n    window.addEventListener('keydown', handleKeyPress);\r\n    return () => window.removeEventListener('keydown', handleKeyPress);\r\n  }, [showAnswer, handleCardResponse]);\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto mb-4\"></div>\r\n          <p className=\"text-gray-600\">Initializing UAMS v3.0 session...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gradient-to-br from-red-50 to-red-100 flex items-center justify-center\">\r\n        <div className=\"text-center p-8 bg-white rounded-lg shadow-lg max-w-md\">\r\n          <div className=\"text-red-500 text-5xl mb-4\">⚠️</div>\r\n          <h2 className=\"text-xl font-semibold text-red-700 mb-2\">Session Error</h2>\r\n          <p className=\"text-red-600 mb-4\">{error}</p>\r\n          <button \r\n            onClick={() => window.location.reload()}\r\n            className=\"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700\"\r\n          >\r\n            Retry\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100\">\r\n      {/* Header with Session Metrics */}\r\n      {showMetricsPanel && (\r\n        <SessionMetricsHeader \r\n          sessionState={sessionState} \r\n          sessionMetrics={sessionMetrics}\r\n          environmentalAdaptations={environmentalAdaptations}\r\n          onToggleCognitiveDetail={() => setShowCognitiveLoadDetail(!showCognitiveLoadDetail)}\r\n        />\r\n      )}\r\n      \r\n      {/* Cognitive Load Detail Panel */}\r\n      {showCognitiveLoadDetail && cognitiveLoadAnalysis && (\r\n        <CognitiveLoadDetailPanel analysis={cognitiveLoadAnalysis} />\r\n      )}\r\n      \r\n      <div className=\"container mx-auto px-4 py-8 max-w-4xl\">\r\n        {/* Main Card Display */}\r\n        <div className=\"bg-white rounded-xl shadow-lg p-8 mb-6\">\r\n          {currentCard && (\r\n            <CardDisplay \r\n              card={currentCard.card} \r\n              showAnswer={showAnswer}\r\n              onShowAnswer={handleShowAnswer}\r\n            />\r\n          )}\r\n        </div>\r\n        \r\n        {/* Response Buttons */}\r\n        {showAnswer && currentCard && (\r\n          <ResponseButtons \r\n            onResponse={handleCardResponse}\r\n            disabled={!showAnswer}\r\n          />\r\n        )}\r\n        \r\n        {/* Explanation Panel */}\r\n        {showExplanation && currentCard && (\r\n          <ExplanationPanel \r\n            explanation={currentCard.explanation}\r\n            reasoning={currentCard.reasoning}\r\n            confidence={currentCard.confidence}\r\n            sessionState={sessionState}\r\n          />\r\n        )}\r\n        \r\n        {/* Flow State Indicator */}\r\n        <FlowStateIndicator sessionState={sessionState} />\r\n        \r\n        {/* Session Controls */}\r\n        <SessionControls \r\n          sessionState={sessionState}\r\n          showMetricsPanel={showMetricsPanel}\r\n          showExplanation={showExplanation}\r\n          onToggleMetrics={() => setShowMetricsPanel(!showMetricsPanel)}\r\n          onToggleExplanation={() => setShowExplanation(!showExplanation)}\r\n          onEndSession={() => {/* Implement session end */}}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Sub-components\r\n\r\nconst SessionMetricsHeader: React.FC<{\r\n  sessionState: UnifiedSessionState | null;\r\n  sessionMetrics: SessionMetrics;\r\n  environmentalAdaptations: any;\r\n  onToggleCognitiveDetail: () => void;\r\n}> = ({ sessionState, sessionMetrics, environmentalAdaptations, onToggleCognitiveDetail }) => {\r\n  if (!sessionState) return null;\r\n  \r\n  const formatDuration = (ms: number) => {\r\n    const minutes = Math.floor(ms / 60000);\r\n    const seconds = Math.floor((ms % 60000) / 1000);\r\n    return `${minutes}:${seconds.toString().padStart(2, '0')}`;\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-white border-b border-gray-200 px-6 py-4\">\r\n      <div className=\"max-w-6xl mx-auto\">\r\n        <div className=\"grid grid-cols-1 md:grid-cols-5 gap-4 text-sm\">\r\n          {/* Momentum */}\r\n          <div className=\"flex items-center space-x-2\">\r\n            <div className=\"w-3 h-3 bg-blue-500 rounded-full\"></div>\r\n            <span className=\"font-medium\">Momentum</span>\r\n            <div className=\"flex-1 bg-gray-200 rounded-full h-2\">\r\n              <div \r\n                className=\"bg-blue-500 h-2 rounded-full transition-all duration-300\"\r\n                style={{ width: `${sessionState.sessionMomentumScore * 100}%` }}\r\n              />\r\n            </div>\r\n            <span className=\"text-xs font-mono\">\r\n              {(sessionState.sessionMomentumScore * 100).toFixed(0)}%\r\n            </span>\r\n          </div>\r\n          \r\n          {/* Energy */}\r\n          <div className=\"flex items-center space-x-2\">\r\n            <div className=\"w-3 h-3 bg-green-500 rounded-full\"></div>\r\n            <span className=\"font-medium\">Energy</span>\r\n            <div className=\"flex-1 bg-gray-200 rounded-full h-2\">\r\n              <div \r\n                className=\"bg-green-500 h-2 rounded-full transition-all duration-300\"\r\n                style={{ width: `${(1 - sessionState.sessionFatigueIndex) * 100}%` }}\r\n              />\r\n            </div>\r\n            <span className=\"text-xs font-mono\">\r\n              {((1 - sessionState.sessionFatigueIndex) * 100).toFixed(0)}%\r\n            </span>\r\n          </div>\r\n          \r\n          {/* Cognitive Load */}\r\n          <button \r\n            onClick={onToggleCognitiveDetail}\r\n            className=\"flex items-center space-x-2 hover:bg-gray-50 rounded px-2 py-1\"\r\n          >\r\n            <div className=\"w-3 h-3 bg-purple-500 rounded-full\"></div>\r\n            <span className=\"font-medium\">Cognitive</span>\r\n            <div className=\"flex-1 bg-gray-200 rounded-full h-2\">\r\n              <div \r\n                className=\"bg-purple-500 h-2 rounded-full transition-all duration-300\"\r\n                style={{ width: `${sessionState.cognitiveLoadCapacity * 100}%` }}\r\n              />\r\n            </div>\r\n            <span className=\"text-xs font-mono\">\r\n              {(sessionState.cognitiveLoadCapacity * 100).toFixed(0)}%\r\n            </span>\r\n          </button>\r\n          \r\n          {/* Session Stats */}\r\n          <div className=\"flex items-center space-x-4 text-xs\">\r\n            <span><strong>{sessionMetrics.cardsReviewed}</strong> cards</span>\r\n            <span><strong>{(sessionMetrics.accuracy * 100).toFixed(0)}%</strong> accuracy</span>\r\n          </div>\r\n          \r\n          {/* Duration */}\r\n          <div className=\"flex items-center space-x-2 text-xs\">\r\n            <span className=\"font-medium\">Duration:</span>\r\n            <span className=\"font-mono\">{formatDuration(sessionMetrics.sessionDuration)}</span>\r\n          </div>\r\n        </div>\r\n        \r\n        {/* Flow State Indicator */}\r\n        <div className=\"mt-3 flex items-center justify-between\">\r\n          <FlowStateIndicator sessionState={sessionState} />\r\n          \r\n          {environmentalAdaptations && (\r\n            <EnvironmentalIndicator adaptations={environmentalAdaptations} />\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst CardDisplay: React.FC<{\r\n  card: any;\r\n  showAnswer: boolean;\r\n  onShowAnswer: () => void;\r\n}> = ({ card, showAnswer, onShowAnswer }) => {\r\n  return (\r\n    <div className=\"text-center\">\r\n      {/* Front Content */}\r\n      <div className=\"mb-8\">\r\n        <div className=\"prose prose-lg mx-auto\">\r\n          <div dangerouslySetInnerHTML={{ __html: card.frontContent }} />\r\n        </div>\r\n      </div>\r\n      \r\n      {/* Show Answer Button or Back Content */}\r\n      {!showAnswer ? (\r\n        <button\r\n          onClick={onShowAnswer}\r\n          className=\"px-8 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors text-lg font-medium\"\r\n        >\r\n          Show Answer\r\n        </button>\r\n      ) : (\r\n        <div className=\"border-t pt-8\">\r\n          <div className=\"prose prose-lg mx-auto\">\r\n            <div dangerouslySetInnerHTML={{ __html: card.backContent }} />\r\n          </div>\r\n        </div>\r\n      )}\r\n      \r\n      <div className=\"mt-4 text-sm text-gray-500 space-x-4\">\r\n        <span>Difficulty: {card.difficulty?.toFixed(1) || 'N/A'}</span>\r\n        <span>•</span>\r\n        <span>Success Rate: {((card.retrievability || 0.5) * 100).toFixed(0)}%</span>\r\n        <span>•</span>\r\n        <span>Confidence: {card.confidenceLevel || 'Unknown'}</span>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst ResponseButtons: React.FC<{\r\n  onResponse: (rating: 'again' | 'hard' | 'good' | 'easy') => void;\r\n  disabled: boolean;\r\n}> = ({ onResponse, disabled }) => {\r\n  return (\r\n    <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6\">\r\n      {Object.entries(RATING_DESCRIPTIONS).map(([rating, config]) => (\r\n        <button\r\n          key={rating}\r\n          onClick={() => onResponse(rating as any)}\r\n          disabled={disabled}\r\n          className={`\r\n            p-4 rounded-lg text-white font-medium transition-all duration-200\r\n            ${config.color} hover:scale-105 hover:shadow-lg\r\n            disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100\r\n          `}\r\n        >\r\n          <div className=\"text-lg mb-1\">{config.label}</div>\r\n          <div className=\"text-xs opacity-90\">{config.description}</div>\r\n          <div className=\"text-xs mt-2 opacity-75\">\r\n            Press {Object.keys(RATING_DESCRIPTIONS).indexOf(rating) + 1}\r\n          </div>\r\n        </button>\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst FlowStateIndicator: React.FC<{ sessionState: UnifiedSessionState | null }> = ({ sessionState }) => {\r\n  if (!sessionState) return null;\r\n  \r\n  const { challengeSkillBalance, engagementLevel, momentumMaintenance } = sessionState.flowStateMetrics;\r\n  \r\n  const getFlowZone = (balance: number): { zone: string; color: string } => {\r\n    if (balance < 0.3) return { zone: 'Bored', color: 'text-yellow-600' };\r\n    if (balance > 0.7) return { zone: 'Anxious', color: 'text-red-600' };\r\n    return { zone: 'Flow Zone', color: 'text-green-600' };\r\n  };\r\n  \r\n  const flowZone = getFlowZone(challengeSkillBalance);\r\n  \r\n  return (\r\n    <div className=\"flex items-center space-x-4 text-sm\">\r\n      <div className={`font-medium ${flowZone.color}`}>\r\n        {flowZone.zone}\r\n      </div>\r\n      <div className=\"text-gray-600\">\r\n        Engagement: {(engagementLevel * 100).toFixed(0)}%\r\n      </div>\r\n      {momentumMaintenance && (\r\n        <div className=\"text-green-600\">✓ Optimal Learning</div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst EnvironmentalIndicator: React.FC<{ adaptations: any }> = ({ adaptations }) => {\r\n  if (!adaptations) return null;\r\n  \r\n  return (\r\n    <div className=\"flex items-center space-x-2 text-xs text-gray-600\">\r\n      {adaptations.difficultyAdjustment !== 0 && (\r\n        <span className={`px-2 py-1 rounded ${\r\n          adaptations.difficultyAdjustment > 0 ? 'bg-orange-100 text-orange-700' : 'bg-blue-100 text-blue-700'\r\n        }`}>\r\n          Difficulty {adaptations.difficultyAdjustment > 0 ? '+' : ''}{adaptations.difficultyAdjustment.toFixed(1)}\r\n        </span>\r\n      )}\r\n      {adaptations.visualOptimizations.colorScheme !== 'auto' && (\r\n        <span className=\"px-2 py-1 bg-gray-100 text-gray-700 rounded\">\r\n          {adaptations.visualOptimizations.colorScheme} mode\r\n        </span>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst ExplanationPanel: React.FC<{\r\n  explanation: string;\r\n  reasoning: string;\r\n  confidence: number;\r\n  sessionState: UnifiedSessionState | null;\r\n}> = ({ explanation, reasoning, confidence, sessionState }) => {\r\n  return (\r\n    <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-6 mb-6\">\r\n      <h4 className=\"text-lg font-semibold text-blue-900 mb-3\">Why this card?</h4>\r\n      <p className=\"text-blue-800 mb-4\">{explanation}</p>\r\n      \r\n      <div className=\"flex items-center justify-between text-sm\">\r\n        <div className=\"flex space-x-4\">\r\n          <span className=\"px-3 py-1 bg-blue-200 text-blue-800 rounded-full\">\r\n            {reasoning.replace('_', ' ')}\r\n          </span>\r\n          <span className=\"text-blue-700\">\r\n            Confidence: {(confidence * 100).toFixed(0)}%\r\n          </span>\r\n        </div>\r\n        \r\n        {sessionState && (\r\n          <div className=\"text-blue-600 text-xs\">\r\n            Queue: {sessionState.lookaheadBuffer.length} cards ahead\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst CognitiveLoadDetailPanel: React.FC<{ analysis: CognitiveLoadAnalysis }> = ({ analysis }) => {\r\n  return (\r\n    <div className=\"bg-purple-50 border-b border-purple-200 px-6 py-4\">\r\n      <div className=\"max-w-6xl mx-auto\">\r\n        <h3 className=\"text-lg font-semibold text-purple-900 mb-3\">Cognitive Load Analysis</h3>\r\n        \r\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 text-sm\">\r\n          <div>\r\n            <h4 className=\"font-medium text-purple-800 mb-2\">Current Status</h4>\r\n            <div className=\"space-y-1 text-purple-700\">\r\n              <div>Load: {(analysis.currentLoad * 100).toFixed(0)}%</div>\r\n              <div>Capacity: {(analysis.capacity * 100).toFixed(0)}%</div>\r\n              <div>Utilization: {(analysis.utilizationRate * 100).toFixed(0)}%</div>\r\n            </div>\r\n          </div>\r\n          \r\n          <div>\r\n            <h4 className=\"font-medium text-purple-800 mb-2\">Predictions</h4>\r\n            <div className=\"space-y-1 text-purple-700\">\r\n              <div>Attention Remaining: {analysis.attentionRemainingMinutes.toFixed(0)}min</div>\r\n              <div>Sustainability: {(analysis.sustainabilityScore * 100).toFixed(0)}%</div>\r\n              <div className={`font-medium ${\r\n                analysis.alertLevel === 'red' ? 'text-red-600' :\r\n                analysis.alertLevel === 'orange' ? 'text-orange-600' :\r\n                analysis.alertLevel === 'yellow' ? 'text-yellow-600' : 'text-green-600'\r\n              }`}>\r\n                Status: {analysis.alertLevel.toUpperCase()}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          \r\n          <div>\r\n            <h4 className=\"font-medium text-purple-800 mb-2\">Recommendations</h4>\r\n            <div className=\"text-xs text-purple-600 space-y-1\">\r\n              {analysis.recommendations.slice(0, 3).map((rec, idx) => (\r\n                <div key={idx}>• {rec}</div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst SessionControls: React.FC<{\r\n  sessionState: UnifiedSessionState | null;\r\n  showMetricsPanel: boolean;\r\n  showExplanation: boolean;\r\n  onToggleMetrics: () => void;\r\n  onToggleExplanation: () => void;\r\n  onEndSession: () => void;\r\n}> = ({ sessionState, showMetricsPanel, showExplanation, onToggleMetrics, onToggleExplanation, onEndSession }) => {\r\n  return (\r\n    <div className=\"fixed bottom-6 right-6 flex flex-col space-y-2\">\r\n      <button\r\n        onClick={onToggleMetrics}\r\n        className=\"px-4 py-2 bg-white rounded-full shadow-lg hover:shadow-xl transition-shadow text-sm font-medium\"\r\n      >\r\n        {showMetricsPanel ? 'Hide' : 'Show'} Metrics\r\n      </button>\r\n      \r\n      <button\r\n        onClick={onToggleExplanation}\r\n        className=\"px-4 py-2 bg-white rounded-full shadow-lg hover:shadow-xl transition-shadow text-sm font-medium\"\r\n      >\r\n        {showExplanation ? 'Hide' : 'Show'} AI Reasoning\r\n      </button>\r\n      \r\n      <button\r\n        onClick={onEndSession}\r\n        className=\"px-4 py-2 bg-red-500 text-white rounded-full shadow-lg hover:shadow-xl transition-shadow text-sm font-medium\"\r\n      >\r\n        End Session\r\n      </button>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Helper functions\r\nconst calculateMomentumImpact = (rating: string, sessionState: UnifiedSessionState): number => {\r\n  const baseImpact = { 'again': -0.2, 'hard': -0.05, 'good': 0.1, 'easy': 0.15 };\r\n  return baseImpact[rating as keyof typeof baseImpact] || 0;\r\n};\r\n\r\nconst calculateConfidenceChange = (rating: string, card: any): number => {\r\n  const baseChange = { 'again': -0.1, 'hard': -0.02, 'good': 0.05, 'easy': 0.08 };\r\n  return baseChange[rating as keyof typeof baseChange] || 0;\r\n};\r\n\r\nconst getCurrentUserId = (): string => {\r\n  // This would get the current user ID from your auth system\r\n  return 'user-123';\r\n};\r\n\r\nconst getCurrentDeckId = (): string => {\r\n  // This would get the current deck ID from your routing/state\r\n  return 'deck-456';\r\n};\r\n\r\nexport default EnhancedReviewPage;","import { useNavigate } from 'react-router-dom';\n\nfunction ResetPasswordPage() {\n  const navigate = useNavigate();\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 py-12 px-4 sm:px-6 lg:px-8\">\n      <div className=\"max-w-md w-full space-y-8\">\n        <div>\n          <h2 className=\"mt-6 text-center text-3xl font-extrabold text-gray-900 dark:text-white\">\n            Password Reset\n          </h2>\n          <p className=\"mt-2 text-center text-sm text-gray-600 dark:text-gray-400\">\n            Password reset functionality will be implemented with PocketBase integration.\n          </p>\n        </div>\n        \n        <div className=\"rounded-md shadow-sm space-y-4\">\n          <button\n            onClick={() => navigate('/')}\n            className=\"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n          >\n            Back to Home\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default ResetPasswordPage;","import { Routes, Route, Navigate } from 'react-router-dom'\r\nimport { useAuthStore } from './stores/authStore'\r\nimport Layout from './components/layout/Layout'\r\nimport HomePage from './pages/HomePage'\r\nimport StudyPage from './pages/StudyPage'\r\nimport DecksPage from './pages/DecksPage'\r\nimport ProfilePage from './pages/ProfilePage'\r\nimport ChallengesPage from './pages/ChallengesPage'\r\nimport LeaderboardPage from './pages/LeaderboardPage'\r\nimport GlobalStatsPage from './pages/GlobalStatsPage'\r\nimport AnalyticsDashboard from './pages/AnalyticsDashboard'\r\nimport EnhancedReviewPage from './pages/EnhancedReviewPage'\r\nimport TestResetPage from './pages/TestResetPage'\r\nimport ResetPasswordPage from './pages/ResetPasswordPage'\r\nimport MapTestPage from './pages/MapTestPage'\r\nimport DebugLogTestPage from './pages/DebugLogTestPage'\r\n\r\n// Development/testing pages - can be removed in production\r\nconst isDev = import.meta.env.DEV\r\n\r\nfunction App() {\r\n  const { isAuthenticated } = useAuthStore()\r\n\r\n  return (\r\n    <Routes>\r\n      <Route path=\"/\" element={<Layout />}>\r\n        <Route index element={<HomePage />} />\r\n        <Route \r\n          path=\"/study/:deckId\" \r\n          element={isAuthenticated ? <StudyPage /> : <Navigate to=\"/\" replace />} \r\n        />\r\n        <Route \r\n          path=\"/enhanced-review/:deckId\" \r\n          element={isAuthenticated ? <EnhancedReviewPage /> : <Navigate to=\"/\" replace />} \r\n        />\r\n        <Route \r\n          path=\"/decks\" \r\n          element={isAuthenticated ? <DecksPage /> : <Navigate to=\"/\" replace />} \r\n        />\r\n        <Route \r\n          path=\"/profile\" \r\n          element={isAuthenticated ? <ProfilePage /> : <Navigate to=\"/\" replace />} \r\n        />\r\n        <Route \r\n          path=\"/challenges\" \r\n          element={isAuthenticated ? <ChallengesPage /> : <Navigate to=\"/\" replace />} \r\n        />\r\n        <Route \r\n          path=\"/leaderboard\" \r\n          element={<LeaderboardPage />} \r\n        />\r\n        <Route \r\n          path=\"/stats\" \r\n          element={<GlobalStatsPage />} \r\n        />\r\n        <Route \r\n          path=\"/analytics\" \r\n          element={isAuthenticated ? <AnalyticsDashboard /> : <Navigate to=\"/\" replace />} \r\n        />\r\n        <Route \r\n          path=\"/reset-password\" \r\n          element={<ResetPasswordPage />} \r\n        />\r\n        \r\n        {/* Development/Testing Routes */}\r\n        {isDev && (\r\n          <>\r\n            <Route path=\"/test/reset\" element={<TestResetPage />} />\r\n            <Route path=\"/test/map\" element={<MapTestPage />} />\r\n            <Route path=\"/test/debug\" element={<DebugLogTestPage />} />\r\n          </>\r\n        )}\r\n        \r\n        {/* Catch all route */}\r\n        <Route path=\"*\" element={<Navigate to=\"/\" replace />} />\r\n      </Route>\r\n    </Routes>\r\n  )\r\n}\r\n\r\nexport default App","import React from 'react'\r\nimport ReactDOM from 'react-dom/client'\r\nimport { QueryClient, QueryClientProvider } from '@tanstack/react-query'\r\nimport { BrowserRouter } from 'react-router-dom'\r\nimport App from './App.tsx'\r\nimport './index.css'\r\n\r\n// PWA functionality is handled by Vite PWA plugin\r\n\r\n// Create a client for React Query\r\nconst queryClient = new QueryClient({\r\n  defaultOptions: {\r\n    queries: {\r\n      staleTime: 1000 * 60 * 5, // 5 minutes\r\n      cacheTime: 1000 * 60 * 30, // 30 minutes\r\n      retry: 2,\r\n      refetchOnWindowFocus: false,\r\n    },\r\n  },\r\n})\r\n\r\nReactDOM.createRoot(document.getElementById('root')!).render(\r\n  <React.StrictMode>\r\n    <QueryClientProvider client={queryClient}>\r\n      <BrowserRouter>\r\n        <App />\r\n      </BrowserRouter>\r\n    </QueryClientProvider>\r\n  </React.StrictMode>,\r\n)"],"names":["Navbar","onMenuClick","theme","toggleTheme","useThemeStore","user","logout","useAuthStore","jsx","className","children","jsxs","onClick","fill","viewBox","stroke","strokeLinecap","strokeLinejoin","strokeWidth","d","username","level","title","Sidebar","isOpen","onClose","userStats","useGamificationStore","formatNumber","num","toFixed","toString","xpForCurrentLevel","xpForNextLevel","progressPercentage","xp","name","href","icon","map","item","NavLink","to","isActive","currentStreak","style","width","Math","min","max","AuthModal","mode","onModeChange","email","setEmail","useState","setUsername","password","setPassword","login","register","isLoading","error","clearError","isAuthenticated","resetEmailSent","setResetEmailSent","useEffect","handleModeChange","newMode","onSubmit","async","e","preventDefault","alert","type","placeholder","value","onChange","target","required","disabled","signIn","Fragment","Layout","sidebarOpen","setSidebarOpen","authModalOpen","setAuthModalOpen","authMode","setAuthMode","handleSignIn","handleCreateAccount","Outlet","HomePage","navigate","useNavigate","decks","getCards","useDeckStore","userAchievements","achievements","dueDecks","deck","dueCountRaw","id","filter","card","reviewCount","Date","nextReview","length","dueCount","recentAchievements","ua","achievement","find","a","achievementId","earnedAt","Boolean","sort","b","getTime","slice","gold","description","Link","SMALL_REGIONS_BY_MAP","europe","world","africa","us","SvgMapCard","options","showAnswer","onAnswer","isStudyMode","svgContent","setSvgContent","userAnswer","setUserAnswer","showResult","setShowResult","zoom","setZoom","panX","setPanX","panY","setPanY","isDragging","setIsDragging","dragStart","setDragStart","x","y","initialZoomCalculated","setInitialZoomCalculated","mapContainerRef","useRef","loadSvgContent","useCallback","response","fetch","svgPath","svgText","text","countryId","countryName","calculateInitialZoom","svgElement","countryElement","containerRect","current","getBoundingClientRect","getAttribute","svgWidth","svgHeight","height","split","Number","containerWidth","containerHeight","baseZoomX","baseZoomY","baseZoom","enhancedBaseZoom","bbox","getBBox","minPixelSize","minSvgWidth","minSvgHeight","zoomForWidth","zoomForHeight","countryZoom","finalZoom","minZoom","handleZoomIn","prev","handleZoomOut","handleResetView","handleMouseDown","clientX","clientY","handleMouseMove","handleMouseUp","handleWheel","delta","deltaY","handleTouchStart","touches","touch","handleTouchMove","handleTouchEnd","getMapType","pop","replace","processedSvgContent","React","useMemo","svgDoc","DOMParser","parseFromString","querySelector","setAttribute","maxWidth","maxHeight","mapType","targetCountry","includes","querySelectorAll","forEach","region","XMLSerializer","serializeToString","timer","setTimeout","mapContainer","toLowerCase","toUpperCase","optimalZoom","clearTimeout","handleSubmitAnswer","isCorrect","trim","ZoomIn","size","ZoomOut","RotateCcw","round","ref","cursor","onMouseDown","onMouseMove","onMouseUp","onMouseLeave","onWheel","onTouchStart","onTouchMove","onTouchEnd","transform","transformOrigin","dangerouslySetInnerHTML","__html","onKeyPress","key","autoFocus","CardRenderer","onAnswerSubmit","cardType","correct","backContent","frontContent","useStudyKeyboardShortcuts","onFlipCard","onAnswerAgain","onAnswerHard","onAnswerGood","onAnswerEasy","onExitStudy","enabled","debugMode","shortcuts","stopPropagation","shortcutsRef","enabledRef","handleKeyDown","event","tagName","isContentEditable","ctrlKey","metaKey","altKey","shiftKey","matchingShortcut","shortcut","keyMatches","ctrlMatches","altMatches","shiftMatches","action","document","addEventListener","removeEventListener","useKeyboardShortcuts","KeyboardShortcutsHelp","compact","formatKey","parts","push","join","enabledShortcuts","s","index","StudyShortcutsHelp","CardStateIndicator","showDescription","stateColor","state","ivl","getCardStateColor","getCardStateDescription","now","left","due","getNextReviewDate","daysOverdue","currentDate","currentDay","floor","getDaysOverdue","getStateIcon","getStateLabel","getAdditionalInfo","learningStep","backgroundColor","color","border","factor","reps","lapses","toLocaleDateString","testStatsLogic","testStats","total","incorrect","pattern","i","cardNum","expectedIncorrect","expectedCorrect","correctMatch","incorrectMatch","window","StudyPage","deckId","useParams","getDeck","updateCard","cards","startStudySession","updateStudySession","clearStudySession","currentStudySession","getStudySession","awardStudyXP","setShowAnswer","sessionComplete","setSessionComplete","xpEarned","setXpEarned","sessionInitialized","setSessionInitialized","showShortcutsHelp","setShowShortcutsHelp","currentCardIndex","setCurrentCardIndex","stats","setStats","studyCards","sessionStats","allCards","dueCards","MAX_CARDS_PER_SESSION","cardsToStudy","currentCard","useCurrentCard","handleAnswer","goBackToDecks","difficulty","newStats","flushSync","isLastCard","nextCardIndex","totalCardsStudied","correctAnswers","baseXP","bonusXP","milestoneBonus","newInterval","intervalDays","newEaseFactor","easeFactor","newReviewCount","toISOString","processCardUpdate","catch","resetSession","clearSessionAndGoBack","earliestDeck","earliestDate","deckCards","deckEarliestDate","reduce","earliest","cardDate","createdAt","totalAnswered","accuracy","CardManager","addCard","deleteCard","showAddCard","setShowAddCard","editingCard","setEditingCard","setFrontContent","setBackContent","createNewCard","rows","startEdit","cardId","confirm","handleDeleteCard","ProgressBar","progress","label","showPercentage","clampedProgress","europeCountries","worldCountries","africaCountries","northAmericaCountries","finlandRegions","franceRegions","ukRegions","norwayRegions","swedenRegions","usStates","vietnamProvinces","availableMaps","mapId","mapName","emoji","regions","countries","generateMapDeck","createDeck","mapConfig","getMapConfig","Error","userId","cardCount","isPublic","settings","newCardsPerDay","maxReviewsPerDay","easyBonus","intervalModifier","maximumInterval","minimumInterval","category","DecksPage","importProgress","importStatus","deleteDeck","loadExampleDecks","importAnkiDeck","importFromText","resetImportProgress","showCreateModal","setShowCreateModal","showImportModal","setShowImportModal","searchTerm","setSearchTerm","selectedCategory","setSelectedCategory","managingDeckId","setManagingDeckId","showMapModal","setShowMapModal","selectedMapType","setSelectedMapType","newDeckTitle","setNewDeckTitle","newDeckDescription","setNewDeckDescription","newDeckCategory","setNewDeckCategory","importText","setImportText","importSeparator","setImportSeparator","hasLoadedExampleDecks","filteredDecks","matchesSearch","matchesCategory","categories","Array","from","Set","role","charAt","newCards","reviewCards","new","review","getDeckStats","handleDeleteDeck","handleStudyDeck","accept","file","files","endsWith","m","createDeckWrapper","deckData","deckInput","result","ConfirmationDialog","onConfirm","message","confirmText","cancelText","isDestructive","ProfilePage","updateUser","initializeAuth","setUserStats","userActivity","setUserActivity","setUserAchievements","userChallenges","setUserChallenges","dataLoading","setDataLoading","dataError","setDataError","isEditing","setIsEditing","showResetDialog","setShowResetDialog","isResetting","setIsResetting","resetSuccess","setResetSuccess","resetError","setResetError","resetAllStudyData","resetAllUserData","gamificationStats","isInitialized","userStreak","initializeUserData","loadUserData","isDemo","tokenType","authenticatedUser","token","activity","challenges","Promise","all","userDataService","getUserStats","getUserActivity","getUserAchievements","getUserChallenges","apiError","editForm","setEditForm","dailyGoal","preferences","diamonds","XPBar","currentXP","_","totalCards","toLocaleString","totalStudyTime","averageAccuracy","date","cardsStudied","studyTime","challenge","completedAt","reward","coins","gems","StreakCounter","longestStreak","lastStudyDate","parseInt","notifications","soundEffects","ChallengesPage","setFilter","sortBy","setSortBy","loadChallengeData","getFilterCount","filterType","expiresAt","getTimeRemaining","diff","days","hours","filteredChallenges","filtered","aRewardValue","aProgress","getFilteredChallenges","c","getProgressPercentage","expired","isExpired","MonthlyChallenge","requirements","rewards","startDate","endDate","participantCount","storyArc","chapters","totalWeeks","currentWeek","CommunityLeaderboard","challengeId","challengeName","LeaderboardPage","leaderboardData","setLeaderboardData","selectedType","setSelectedType","data","getLeaderboardData","loadLeaderboardData","leaderboardTypes","currentLeaderboard","getRankIcon","rank","getRankColor","getChangeIcon","change","formatScore","score","currentUserEntry","entry","abs","t","GlobalStatsPage","globalStats","liveMetrics","lastUpdated","refresh","formatTime","getTimeSinceUpdate","useRealTimeData","totalLearners","random","cardsStudiedToday","studyTimeToday","onlineUsers","studyingSessions","languagesBeingLearned","topSubjects","subject","learners","RealTimeStatsCard","showRefreshButton","topPerformers","performer","country","TrendingTopics","maxItems","showGrowth","MarketInsights","maxSkills","maxIndustries","showCertifications","AnalyticsDashboard","timeRange","dsrData","setDsrData","sessionData","setSessionData","learningPatterns","setLearningPatterns","environmentalData","setEnvironmentalData","personalizationData","setPersonalizationData","setIsLoading","selectedMetric","setSelectedMetric","loadAnalyticsData","generateSampleDSRData","generateSampleSessionData","generateSampleLearningPatterns","generateSampleEnvironmentalData","generateSamplePersonalizationData","insights","avgMomentum","sum","momentum","avgAccuracy","totalCardsReviewed","cardsPerSession","avgFlowTime","flowTime","improvementTrend","InsightCard","trend","DSRTrendsChart","StabilityDistribution","RetrievabilityPrediction","MomentumTrendsChart","FlowStateAnalysis","CognitiveLoadPatterns","SessionQualityMatrix","OptimalStudyTimes","EnvironmentalPreferences","PersonalizedInsights","LearningRecommendations","patterns","ParameterOptimizationStatus","blue","green","purple","orange","improving","declining","stable","ResponsiveContainer","LineChart","CartesianGrid","strokeDasharray","XAxis","dataKey","YAxis","domain","Tooltip","Legend","Line","distributionData","range","count","PieChart","Pie","cx","cy","outerRadius","percent","Cell","AreaChart","formatter","Area","fillOpacity","ScatterChart","Scatter","BarChart","Bar","RadarChart","fullMark","PolarGrid","PolarAngleAxis","PolarRadiusAxis","Radar","condition","averagePerformance","optimalDifficulty","optimalSessionLength","cognitiveLoadProfile","baseCapacity","bestPerformanceTimes","time","idx","rec","averageDifficulty","sin","averageStability","cos","averageRetrievability","cardsReviewed","fatigue","cognitiveLoad","satisfaction","hour","timeOfDay","performance","PI","confidence","responseTime","sessions","sessionCount","preferenceScore","fatigueRate","recoveryRate","fsrsParameters","RATING_DESCRIPTIONS","again","hard","good","easy","EnhancedReviewPage","sessionState","setSessionState","setCurrentCard","responseStartTime","setResponseStartTime","sessionMetrics","setSessionMetrics","averageResponseTime","sessionDuration","showExplanation","setShowExplanation","setError","showMetricsPanel","setShowMetricsPanel","showCognitiveLoadDetail","setShowCognitiveLoadDetail","cognitiveLoadAnalysis","setCognitiveLoadAnalysis","environmentalAdaptations","setEnvironmentalAdaptations","queueManagerRef","UnifiedQueueManager","environmentalServiceRef","EnvironmentalContextService","intervalRef","queueManager","environmentalService","newSession","initializeSession","firstCard","getNextCard","startEnvironmentalMonitoring","err","clearInterval","context","getCurrentContext","adaptations","getEnvironmentalAdaptations","setInterval","trackContextChanges","onContextChange","previous","newAdaptations","handleCardResponse","rating","environmentalContext","enhancedResponse","timestamp","contextualFactors","sessionTime","sessionStartTime","sessionFatigueIndex","cognitiveLoadAtTime","cognitiveLoadCapacity","environmentalFactors","momentumImpact","calculateMomentumImpact","confidenceChange","calculateConfidenceChange","previousCardSimilarity","clusteringContext","updatedSession","processCardResponse","updateSessionMetrics","nextCard","newCardsReviewed","handleShowAnswer","handleKeyPress","code","location","reload","SessionMetricsHeader","onToggleCognitiveDetail","CognitiveLoadDetailPanel","analysis","CardDisplay","onShowAnswer","ResponseButtons","onResponse","ExplanationPanel","explanation","reasoning","FlowStateIndicator","SessionControls","onToggleMetrics","onToggleExplanation","onEndSession","sessionMomentumScore","ms","padStart","EnvironmentalIndicator","retrievability","confidenceLevel","Object","entries","config","keys","indexOf","challengeSkillBalance","engagementLevel","momentumMaintenance","flowStateMetrics","flowZone","balance","zone","difficultyAdjustment","visualOptimizations","colorScheme","lookaheadBuffer","currentLoad","capacity","utilizationRate","attentionRemainingMinutes","sustainabilityScore","alertLevel","recommendations","ResetPasswordPage","App","Routes","Route","path","element","Navigate","queryClient","QueryClient","defaultOptions","queries","staleTime","cacheTime","retry","refetchOnWindowFocus","ReactDOM","createRoot","getElementById","render","StrictMode","QueryClientProvider","client","BrowserRouter"],"mappings":"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"}